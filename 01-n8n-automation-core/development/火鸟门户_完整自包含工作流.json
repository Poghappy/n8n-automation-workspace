{
  "name": "ç«é¸Ÿé—¨æˆ·è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµ",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "minutes",
              "minutesInterval": 30
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "å®šæ—¶è§¦å‘å™¨",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.1,
      "position": [240, 300]
    },
    {
      "parameters": {
        "url": "https://www.theneuron.ai/feed",
        "options": {
          "allowUnauthorizedCerts": true
        }
      },
      "id": "rss-neuron",
      "name": "é‡‡é›†Neuron AI",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [460, 200]
    },
    {
      "parameters": {
        "url": "https://www.futurepedia.io/rss",
        "options": {
          "allowUnauthorizedCerts": true
        }
      },
      "id": "rss-futurepedia",
      "name": "é‡‡é›†Futurepedia",
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1,
      "position": [460, 400]
    },
    {
      "parameters": {
        "functionCode": "// å†…å®¹å¤„ç†å’Œå»é‡æ£€æµ‹\nconst items = $input.all();\nconst processedItems = [];\nconst seenTitles = new Set();\n\nfor (const item of items) {\n  const data = item.json;\n  \n  // åŸºç¡€æ•°æ®æ¸…ç†\n  const title = (data.title || '').trim();\n  const content = (data.contentSnippet || data.content || data.description || '').trim();\n  const url = data.link || data.guid || '';\n  \n  // è·³è¿‡ç©ºå†…å®¹\n  if (!title || title.length < 10 || !content || content.length < 50) {\n    continue;\n  }\n  \n  // ç®€å•å»é‡ - åŸºäºæ ‡é¢˜\n  const titleKey = title.toLowerCase().replace(/[^a-z0-9]/g, '');\n  if (seenTitles.has(titleKey)) {\n    continue;\n  }\n  seenTitles.add(titleKey);\n  \n  // å†…å®¹åˆ†ç±»\n  let category = 'AIèµ„è®¯';\n  const titleLower = title.toLowerCase();\n  if (titleLower.includes('chatgpt') || titleLower.includes('openai')) {\n    category = 'ChatGPT';\n  } else if (titleLower.includes('tool') || titleLower.includes('app')) {\n    category = 'AIå·¥å…·';\n  } else if (titleLower.includes('news') || titleLower.includes('update')) {\n    category = 'AIæ–°é—»';\n  }\n  \n  // å†…å®¹ä¼˜åŒ–\n  let optimizedTitle = title;\n  if (optimizedTitle.length > 60) {\n    optimizedTitle = optimizedTitle.substring(0, 57) + '...';\n  }\n  \n  let optimizedContent = content;\n  // ç§»é™¤HTMLæ ‡ç­¾\n  optimizedContent = optimizedContent.replace(/<[^>]*>/g, '');\n  // é™åˆ¶é•¿åº¦\n  if (optimizedContent.length > 2000) {\n    optimizedContent = optimizedContent.substring(0, 1997) + '...';\n  }\n  \n  // ç”Ÿæˆå…³é”®è¯\n  const keywords = [];\n  const keywordPatterns = [\n    /AI|äººå·¥æ™ºèƒ½/gi,\n    /ChatGPT|GPT/gi,\n    /æœºå™¨å­¦ä¹ |Machine Learning/gi,\n    /æ·±åº¦å­¦ä¹ |Deep Learning/gi,\n    /è‡ªç„¶è¯­è¨€å¤„ç†|NLP/gi,\n    /å·¥å…·|Tool/gi\n  ];\n  \n  for (const pattern of keywordPatterns) {\n    const matches = (title + ' ' + content).match(pattern);\n    if (matches) {\n      keywords.push(...matches.slice(0, 2));\n    }\n  }\n  \n  processedItems.push({\n    json: {\n      title: optimizedTitle,\n      content: optimizedContent,\n      category: category,\n      author: 'AIé‡‡é›†',\n      source: data.creator || 'RSSé‡‡é›†',\n      source_url: url,\n      keywords: keywords.slice(0, 5).join(', '),\n      publishedAt: data.pubDate || data.isoDate || new Date().toISOString(),\n      processed_at: new Date().toISOString(),\n      quality_score: Math.min(100, Math.max(60, title.length + content.length / 10))\n    }\n  });\n}\n\nconsole.log(`å¤„ç†å®Œæˆ: åŸå§‹${items.length}æ¡ï¼Œå¤„ç†å${processedItems.length}æ¡`);\nreturn processedItems;"
      },
      "id": "content-processor",
      "name": "å†…å®¹å¤„ç†å™¨",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [680, 300]
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{$json.quality_score}}",
              "operation": "largerEqual",
              "value2": 70
            }
          ]
        }
      },
      "id": "quality-filter",
      "name": "è´¨é‡è¿‡æ»¤",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [900, 300]
    },
    {
      "parameters": {
        "url": "https://hawaiihub.net/include/ajax.php",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36"
            },
            {
              "name": "Referer",
              "value": "https://hawaiihub.net/"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "service",
              "value": "article"
            },
            {
              "name": "action",
              "value": "put"
            },
            {
              "name": "title",
              "value": "={{$json.title}}"
            },
            {
              "name": "typeid",
              "value": "1"
            },
            {
              "name": "body",
              "value": "={{$json.content}}"
            },
            {
              "name": "keywords",
              "value": "={{$json.keywords}}"
            },
            {
              "name": "author",
              "value": "={{$json.author}}"
            }
          ]
        },
        "options": {
          "timeout": 30000,
          "retry": {
            "enabled": true,
            "maxTries": 3
          }
        }
      },
      "id": "firebird-publish",
      "name": "å‘å¸ƒåˆ°ç«é¸Ÿé—¨æˆ·",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1120, 200],
      "credentials": {
        "httpHeaderAuth": {
          "id": "huoniao_session",
          "name": "ç«é¸Ÿé—¨æˆ·ä¼šè¯"
        }
      }
    },
    {
      "parameters": {
        "functionCode": "// å‘å¸ƒç»“æœå¤„ç†å’Œæ—¥å¿—è®°å½•\nconst items = $input.all();\nconst results = [];\nlet successCount = 0;\nlet failCount = 0;\n\nfor (const item of items) {\n  const response = item.json;\n  const originalData = $('content-processor').item.json;\n  \n  let status = 'unknown';\n  let message = '';\n  \n  try {\n    // è§£æç«é¸ŸAPIå“åº”\n    if (typeof response === 'string') {\n      // å¦‚æœè¿”å›HTMLï¼Œè¯´æ˜å¯èƒ½æ˜¯ç™»å½•é¡µé¢\n      if (response.includes('<html') || response.includes('login')) {\n        status = 'auth_failed';\n        message = 'è®¤è¯å¤±è´¥ï¼Œå¯èƒ½éœ€è¦é‡æ–°ç™»å½•';\n        failCount++;\n      } else {\n        // å°è¯•è§£æJSONå“åº”\n        try {\n          const jsonResponse = JSON.parse(response);\n          if (jsonResponse.state === 100) {\n            status = 'success';\n            message = `æ–‡ç« å‘å¸ƒæˆåŠŸï¼ŒID: ${jsonResponse.info}`;\n            successCount++;\n          } else {\n            status = 'failed';\n            message = jsonResponse.info || 'å‘å¸ƒå¤±è´¥';\n            failCount++;\n          }\n        } catch (e) {\n          status = 'success';\n          message = 'å‘å¸ƒå¯èƒ½æˆåŠŸï¼ˆå“åº”æ ¼å¼å¼‚å¸¸ï¼‰';\n          successCount++;\n        }\n      }\n    } else if (response.state) {\n      if (response.state === 100) {\n        status = 'success';\n        message = `æ–‡ç« å‘å¸ƒæˆåŠŸï¼ŒID: ${response.info}`;\n        successCount++;\n      } else {\n        status = 'failed';\n        message = response.info || 'å‘å¸ƒå¤±è´¥';\n        failCount++;\n      }\n    } else {\n      status = 'success';\n      message = 'å‘å¸ƒå®Œæˆ';\n      successCount++;\n    }\n  } catch (error) {\n    status = 'error';\n    message = error.message;\n    failCount++;\n  }\n  \n  results.push({\n    json: {\n      title: originalData.title,\n      status: status,\n      message: message,\n      published_at: new Date().toISOString(),\n      category: originalData.category,\n      quality_score: originalData.quality_score\n    }\n  });\n}\n\n// æ·»åŠ æ±‡æ€»ä¿¡æ¯\nresults.push({\n  json: {\n    summary: true,\n    total_processed: items.length,\n    success_count: successCount,\n    fail_count: failCount,\n    success_rate: items.length > 0 ? Math.round((successCount / items.length) * 100) : 0,\n    execution_time: new Date().toISOString()\n  }\n});\n\nconsole.log(`å‘å¸ƒå®Œæˆ: æˆåŠŸ${successCount}æ¡ï¼Œå¤±è´¥${failCount}æ¡`);\nreturn results;"
      },
      "id": "result-processor",
      "name": "ç»“æœå¤„ç†å™¨",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1340, 200]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.summary}}",
              "value2": true
            }
          ]
        }
      },
      "id": "summary-filter",
      "name": "æ±‡æ€»è¿‡æ»¤",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1560, 200]
    },
    {
      "parameters": {
        "functionCode": "// æ‰§è¡Œæ—¥å¿—è®°å½•\nconst summary = $input.first().json;\nconst timestamp = new Date().toISOString();\n\n// æ„å»ºæ—¥å¿—æ¶ˆæ¯\nconst logMessage = `\nğŸ¤– ç«é¸Ÿé—¨æˆ·è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµæ‰§è¡ŒæŠ¥å‘Š\nâ° æ‰§è¡Œæ—¶é—´: ${timestamp}\nğŸ“Š å¤„ç†ç»“æœ: æ€»è®¡${summary.total_processed}æ¡ï¼ŒæˆåŠŸ${summary.success_count}æ¡ï¼Œå¤±è´¥${summary.fail_count}æ¡\nğŸ“ˆ æˆåŠŸç‡: ${summary.success_rate}%\n${summary.success_rate < 80 ? 'âš ï¸ æˆåŠŸç‡åä½ï¼Œå»ºè®®æ£€æŸ¥é…ç½®' : 'âœ… æ‰§è¡Œæ­£å¸¸'}\n`;\n\nconsole.log(logMessage);\n\n// å¦‚æœæœ‰Webhook URLï¼Œå¯ä»¥å‘é€é€šçŸ¥\nconst webhookUrl = $vars.WEBHOOK_ALERT_URL || process.env.WEBHOOK_ALERT_URL;\nif (webhookUrl && summary.success_rate < 50) {\n  // æˆåŠŸç‡è¿‡ä½æ—¶å‘é€å‘Šè­¦\n  return {\n    json: {\n      webhook_url: webhookUrl,\n      alert: true,\n      message: `ç«é¸Ÿé—¨æˆ·æ–°é—»å·¥ä½œæµæˆåŠŸç‡è¿‡ä½: ${summary.success_rate}%`,\n      details: summary\n    }\n  };\n}\n\nreturn {\n  json: {\n    log_message: logMessage,\n    summary: summary,\n    status: 'completed'\n  }\n};"
      },
      "id": "logger",
      "name": "æ—¥å¿—è®°å½•å™¨",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1780, 200]
    }
  ],
  "connections": {
    "schedule-trigger": {
      "main": [
        [
          {
            "node": "rss-neuron",
            "type": "main",
            "index": 0
          },
          {
            "node": "rss-futurepedia",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rss-neuron": {
      "main": [
        [
          {
            "node": "content-processor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rss-futurepedia": {
      "main": [
        [
          {
            "node": "content-processor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "content-processor": {
      "main": [
        [
          {
            "node": "quality-filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "quality-filter": {
      "main": [
        [
          {
            "node": "firebird-publish",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "firebird-publish": {
      "main": [
        [
          {
            "node": "result-processor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "result-processor": {
      "main": [
        [
          {
            "node": "summary-filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "summary-filter": {
      "main": [
        [
          {
            "node": "logger",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-01-23T14:00:00.000Z",
  "versionId": "1"
}