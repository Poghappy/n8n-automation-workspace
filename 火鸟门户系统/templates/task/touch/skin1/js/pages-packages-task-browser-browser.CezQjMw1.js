import{a,P as e,i as t,j as o,h as l,b as s,d as i,e as n,r,n as p,k as d,o as c,l as h,w as u,m,q as g,A as f,t as k,v as b,y as w,F as x,x as y,B as D,G as _,C as v,D as B}from"./index-cF6skFzP.js";import{r as C,_ as F}from"./uni-app.es.J1otcSEF.js";import{p as j}from"./task.9CwFAmAC.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";let S=m();var T;const V=$({data:()=>({wh:S.globalData.navTop+S.globalData.appFullWh,masterDomain:S.globalData.masterDomain,biasTop_88:S.globalData.biasTop_88,appBack:S.globalData.appBack,imgsrc:S.globalData.imgPath+"/task/",themedata:{},historydata:[],page:1,pageSize:20,loadingb:!0,privateb:!1,imgVersion:null,pages:"",platForm:S.globalData.platForm,appFullWh:S.globalData.appFullWh,appBoolean:S.globalData.appBoolean,channelDomain:S.globalData.channelDomain,appFullScreen:S.globalData.appFullScreen}),onLoad(a){T=this,-1==S.globalData.wxprivate?S.watchG("wxprivate",(function(e){T.wxprivate=e,e?T.privateb=!0:T.onload(a)})):S.globalData.wxprivate?T.privateb=!0:T.onload(a)},onReady(){},onShow(){},onHide(){},onUnload(){},onPullDownRefresh(){S.reloadFn()},onReachBottom(){this.histroyFn(++this.page,this.pageSize)},onShareAppMessage(a){return{title:this.themedata.title,imageUrl:this.themedata.sharePic,path:"/pages/packages/task/my/my"}},onShareTimeline(){return{title:this.themedata.title,imageUrl:this.themedata.sharePic,path:"/pages/packages/task/my/my"}},methods:{onload(i){T.imgVersion=S.globalData.imgVersion,a({title:"加载中",mask:!0,success:()=>{e({key:"warnColor",success:a=>{e({key:"warnColor",success:a=>{T.themedata=a.data.themeDate,T.setBgColor(this.themedata.themeBackgroundColor),a.data.outtime<Date.parse(new Date)&&t({key:"warnColor",success:()=>{T.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((a=>{null!=a.data.info.themeBackgroundColor?(T.themedata=a.data.info,o({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),T.setBgColor(this.themedata.themeBackgroundColor),l()):(l(),s({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),l()},fail:a=>{T.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((a=>{null!=a.data.info.themeBackgroundColor?(T.themedata=a.data.info,o({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),T.setBgColor(this.themedata.themeBackgroundColor),l()):(l(),s({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),this.histroyFn(this.page,this.pageSize),T.pages=S.pageFn(j)},backFn(){if(T.appBoolean)return window.setupWebViewJavascriptBridge((function(a){a.callHandler("goBack",{},(function(a){}))})),!1;{let a=i();a&&a.length>1?n({delta:1}):"web"==T.platForm?location.href=`${T.masterDomain}${window.pathname}${T.pages.index}`:r({url:"/pages/packages/task/index/index"})}},linkTo(a){if(a)if("web"==T.platForm){if(window.appBoolean)return window.setupWebViewJavascriptBridge((function(e){e.callHandler("redirectNative",{name:"",code:"",link:a},(function(){}))})),!1;a.indexOf("http")>-1?location.href=a:p({url:a})}else{if(a.includes("tomini")){let e=a.split("?")[1].split("&");for(let t=0;t<e.length;t++)if(e[t].includes("tomini")){a=e[t].replace("tomini=",""),e.splice(t,1);break}a+=`?${e.join("&")}`}p({url:a.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(a):a})}},setBgColor(a){"web"!=T.platForm&&uni.setBackgroundColor({backgroundColor:a,fail:a=>{console.log(a)}})},histroyFn(a,e){var t=S.encodeUrl("service=member&action=footprintsGet&module=task");T.$ajax.post({url:"include/ajax.php?"+t,data:{page:a,pageSize:e}}).then((a=>{0!=a.data.info.list.length?(T.historydata=this.historydata.concat(a.data.info.list),console.log(this.historydata)):T.loadingb=!1}))}}},[["render",function(a,e,t,o,l,s){const i=g,n=v,r=B,p=C(d("private_tip"),F);return c(),h(i,{style:{height:"100%"}},{default:u((()=>[l.appBack?(c(),f(x,{key:0},[k(i,{style:b("height:"+l.wh+"px;background-color: "+l.themedata.themeBackgroundColor+";position: sticky;top: 0rpx;z-index: 99;padding-bottom: 88rpx;"),catchtouchmove:""},null,8,["style"]),k(i,{class:"rec-title",style:b("background-color: "+l.themedata.themeBackgroundColor+";top: "+(l.wh+l.biasTop_88)+"px;")},{default:u((()=>[k(n,{src:l.imgsrc+"bl-arrow.png?v="+l.imgVersion,onClick:s.backFn,mode:"aspectFill"},null,8,["src","onClick"]),k(i,null,{default:u((()=>[w("任务浏览记录")])),_:1})])),_:1},8,["style"])],64)):y("",!0),k(i,{class:"warning",style:b(l.appBack?`top: calc(${l.wh}px + 88rpx);`:"top:0rpx;")},{default:u((()=>[w("该页面只显示最近15天的记录")])),_:1},8,["style"]),k(i,{class:"record"},{default:u((()=>[(c(!0),f(x,null,D(l.historydata,((a,e)=>(c(),h(i,{onClick:e=>s.linkTo(`${l.appBoolean?l.channelDomain:""}${l.pages.details}?id=${a.id}&number=${a.number}&${l.appFullScreen}`),class:"tabdetails",key:e},{default:u((()=>[k(i,{class:"td-headimg"},{default:u((()=>[k(n,{src:a.photo,mode:"aspectFill"},null,8,["src"])])),_:2},1024),k(i,{class:"td-right"},{default:u((()=>[k(i,{class:"title"},{default:u((()=>[k(i,{class:"left"},{default:u((()=>[w(_(a.title),1)])),_:2},1024),k(i,{style:{"max-width":"122rpx",overflow:"hidden","white-space":"nowrap"}},{default:u((()=>[k(n,{src:l.imgsrc+"reward.png?v="+l.imgVersion,mode:"aspectFill"},null,8,["src"]),k(r,null,{default:u((()=>[w(_(a.price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),k(i,{class:"label"},{default:u((()=>[k(i,null,{default:u((()=>[w(_(a.typename),1)])),_:2},1024),k(i,null,{default:u((()=>[w(_(a.project),1)])),_:2},1024)])),_:2},1024),k(i,{class:"more"},{default:u((()=>[k(i,null,{default:u((()=>[w(_(a.statistics.used)+"人已赚",1)])),_:2},1024),k(i,null,{default:u((()=>[w("剩余"+_(a.quota-a.statistics.used)+"人",1)])),_:2},1024),k(i,{class:"browser"},{default:u((()=>[w("浏览："+_(a.browsetimefloor),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),k(i,{class:"loading"},{default:u((()=>[w(_(l.loadingb?"加载中":"没有更多喽"),1)])),_:1}),k(p,{privateShow:l.privateb},null,8,["privateShow"])])),_:1})}],["__scopeId","data-v-1d3e0bf5"]]);export{V as default};
