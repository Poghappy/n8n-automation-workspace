import{a as e,P as t,i as a,j as l,h as s,b as n,n as o,d as r,e as i,r as u,k as d,o as c,l as m,w as p,m as h,q as f,A as g,t as k,v,y as b,F as y,x as _,G as w,H as C,B as F,C as x,D,I as B,a4 as A,a5 as P}from"./index-cF6skFzP.js";import{r as T,_ as $}from"./uni-app.es.J1otcSEF.js";import{p as j}from"./task.9CwFAmAC.js";import{_ as I}from"./_plugin-vue_export-helper.BCo6x5W8.js";let S=h();var V;const R=I({data:()=>({wh:S.globalData.navTop+S.globalData.appFullWh,masterDomain:S.globalData.masterDomain,biasTop_88:S.globalData.biasTop_88,appBack:S.globalData.appBack,imgurl:S.globalData.imgPath+"/task/",themedata:{},userdata:{},popb:!1,privateb:!1,popconb:!1,firstb:!0,warningb:!1,delb:!1,timedata:[{id:1,title:"1分钟",value:1},{id:2,title:"5分钟",value:5},{id:3,title:"10分钟",value:10},{id:4,title:"20分钟",value:20},{id:5,title:"30分钟",value:30},{id:6,title:"60分钟",value:60},{id:7,title:"90分钟",value:90},{id:8,title:"120分钟",value:120},{id:9,title:"240分钟",value:240}],seltime:[],selIndex:0,selArr:[0,0,0,0,0],selPre:[0,0,0,0,0],seltimeout:[0],selpreout:[0],times:"",id:"",info:"",imgVersion:"",value:"",month:"",day:"",hours:"",minutes:"",title:"",pages:"",platForm:S.globalData.platForm,appBoolean:S.globalData.appBoolean,channelDomain:S.globalData.channelDomain,appFullScreen:S.globalData.appFullScreen}),onLoad(e){V=this,-1==S.globalData.wxprivate?S.watchG("wxprivate",(function(t){V.wxprivate=t,t?V.privateb=!0:V.onLoadClone3389(e)})):S.globalData.wxprivate?V.privateb=!0:V.onLoadClone3389(e)},onReady(){},onShow(){this.firstb||S.reloadFn(),V.firstb=!1},onHide(){},onUnload(){},onPullDownRefresh(){},onReachBottom(){},onShareAppMessage(e){return{title:this.themedata.title,imageUrl:this.themedata.sharePic,path:"/pages/packages/task/my/my"}},onShareTimeline(){return{title:this.themedata.title,imageUrl:this.themedata.sharePic,path:"/pages/packages/task/my/my"}},methods:{onLoadClone3389(o){e({title:"加载中",mask:!0,success:()=>{t({key:"warnColor",success:e=>{t({key:"warnColor",success:e=>{V.themedata=e.data.themeDate,V.setBgColor(this.themedata.themeBackgroundColor),e.data.outtime<Date.parse(new Date)&&a({key:"warnColor",success:()=>{V.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((e=>{null!=e.data.info.themeBackgroundColor?(V.themedata=e.data.info,l({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),V.setBgColor(this.themedata.themeBackgroundColor),s()):(s(),n({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),s()},fail:e=>{V.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((e=>{null!=e.data.info.themeBackgroundColor?(V.themedata=e.data.info,l({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),V.setBgColor(this.themedata.themeBackgroundColor),s()):(s(),n({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),V.$ajax.post({url:"include/ajax.php?"+S.encodeUrl("service=task&action=memberInfo")}).then((e=>{V.userdata=e.data.info})),V.seltime=this.seldateFn(1440),V.id=o?o.id:this.id,V.pages=S.pageFn(j)},linkTo(e){if(e)if("web"==V.platForm){if(window.appBoolean)return window.setupWebViewJavascriptBridge((function(t){t.callHandler("redirectNative",{name:"",code:"",link:e},(function(){}))})),!1;e.indexOf("http")>-1?location.href=e:o({url:e})}else{if(e.includes("tomini")){let t=e.split("?")[1].split("&");for(let a=0;a<t.length;a++)if(t[a].includes("tomini")){e=t[a].replace("tomini=",""),t.splice(a,1);break}e+=`?${t.join("&")}`}o({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e})}},backFn(){if(V.appBoolean)return window.setupWebViewJavascriptBridge((function(e){e.callHandler("goBack",{},(function(e){}))})),!1;{let e=r();e&&e.length>1?i({delta:1}):"web"==V.platForm?location.href=`${V.masterDomain}${window.pathname}${V.pages.index}`:u({url:"/pages/packages/task/index/index"})}},setBgColor(e){"web"!=V.platForm&&uni.setBackgroundColor({backgroundColor:e,fail:e=>{console.log(e)}})},warningFn(){V.warningb=!this.warningb,setTimeout((()=>{V.warningb=!this.warningb}),2e3)},timeFn(e){switch(e.currentTarget.dataset.state){case"0":V.popconb=!1,V.selPre=this.selArr,V.selpreout=this.seltimeout,setTimeout((()=>{V.popb=!1}),500);break;case"1":V.popb=!0,V.selIndex=1,setTimeout((()=>{V.popconb=!0}),0);break;case"2":V.popb=!0,V.selIndex=2,setTimeout((()=>{V.popconb=!0}),0);break;case"3":V.popconb=!1,V.selArr=this.selPre,V.seltimeout=this.selpreout,setTimeout((()=>{V.popb=!1}),500)}},dateFn(e,t,a,l,s,n){if(0==e.length)return[{value:t,month:[{value:a,day:[{value:l,hours:[{value:s,minutes:[n]}]}]}]}];{let o=!1,r=!1,i=!1,u=!1,d=0,c=0,m=0,p=0;for(let a=0;a<e.length;a++)if(e[a].value==t){o=!0,d=a;break}if(!o){let o={value:t,month:[{value:a,day:[{value:l,hours:[{value:s,minutes:[n]}]}]}]};return e.push(o),e}e:for(let t=d;t<e.length;t++)for(let l=0;l<e[t].month.length;l++)if(e[t].month[l].value==a){r=!0,c=l;break e}if(!r){let t={value:a,day:[{value:l,hours:[{value:s,minutes:[n]}]}]};return e[d].month.push(t),e}e:for(let t=d;t<e.length;t++)for(let a=c;a<e[t].month.length;a++)for(let s=0;s<e[t].month[a].day.length;s++)if(e[t].month[a].day[s].value==l){i=!0,m=s;break e}if(!i){let t={value:l,hours:[{value:s,minutes:[n]}]};return e[d].month[c].day.push(t),e}e:for(let t=d;t<e.length;t++)for(let a=c;a<e[t].month.length;a++)for(let l=m;l<e[t].month[a].day.length;l++)for(let n=0;n<e[t].month[a].day[l].hours.length;n++)if(e[t].month[a].day[l].hours[n].value==s){u=!0,p=n;break e}if(!u){let t={value:s,minutes:[n]};return e[d].month[c].day[m].hours.push(t),e}return e[d].month[c].day[m].hours[p].minutes.push(n),e}},seldateFn(e){let t=[];if(e>0)for(let a=1;a<=e;a++){let e=parseInt((+new Date+6e4*a)/1e3);const l=S.dateFormatter(e),s=l.year,n=l.month,o=l.day,r=l.hour,i=l.minute;l.second,t=this.dateFn(t,s,n,o,r,i)}else if(e<0)for(let a=0;e<a;a--){let e=parseInt((+new Date+6e4*a)/1e3);const l=S.dateFormatter(e),s=l.year,n=l.month,o=l.day,r=l.hour,i=l.minute;t=this.dateFn(t,s,n,o,r,i)}return t},selectFn(e){0==e.currentTarget.dataset.state?V.selPre=e.detail.value:V.selpreout=e.detail.value},timesFn(e){V.times=/^[1-9]+[0-9]*$/.test(e.detail.value)||!e.detail.value?e.detail.value:this.times},warnFn(){},confirmFn(){let t=this.selArr,a={},l=this.seltime[t[0]].value,n=this.seltime[t[0]].month[t[1]].value,o=this.seltime[t[0]].month[t[1]].day[t[2]].value,r=this.seltime[t[0]].month[t[1]].day[t[2]].hours[t[3]].value,i=this.seltime[t[0]].month[t[1]].day[t[2]].hours[t[3]].minutes[t[4]];a.id=Number(this.id),a.type=1,a.start=l+"-"+n+"-"+o+" "+r+":"+i+":00",a.count=Number(this.times),a.interval=this.timedata[this.seltimeout[0]].value,a.count&&!this.warningb?a.count<2?(V.info="刷新次数至少是两次",this.warningFn()):(e({title:"加载中",mask:!0}),V.$ajax.post({url:"include/ajax.php?"+S.encodeUrl("service=task&action=refresh"),data:a}).then((e=>{s(),100==e.data.state?(V.info=e.data.info,this.warningFn(),setTimeout((()=>{this.backFn()}),2200)):V.delb=!0}))):this.warningb||(V.info="刷新次数不能为空",this.warningFn())},promptFn(e){if(0!=e.currentTarget.dataset.state)return!0;V.delb=!1}}},[["render",function(e,t,a,l,s,n){const o=f,r=x,i=D,u=B,h=A,j=P,I=T(d("private_tip"),$);return c(),m(o,{style:{height:"100%"}},{default:p((()=>[s.appBack?(c(),g(y,{key:0},[k(o,{style:v("height:"+s.wh+"px;background-color: "+s.themedata.themeBackgroundColor+";position: sticky;top: 0rpx;z-index: 99;padding-bottom: 88rpx;"),catchtouchmove:""},null,8,["style"]),k(o,{class:"rec-title",style:v("background-color: "+s.themedata.themeBackgroundColor+";top: "+(s.wh+s.biasTop_88)+"px;")},{default:p((()=>[k(r,{src:s.imgurl+"bl-arrow.png?v="+s.imgVersion,onClick:n.backFn,mode:"aspectFill"},null,8,["src","onClick"]),k(o,null,{default:p((()=>[b("自动刷新设置")])),_:1})])),_:1},8,["style"])],64)):_("",!0),k(o,{class:"warning"},{default:p((()=>[b("刷新后任务位置提升到首页任务区顶部，可获得超高流量曝光!")])),_:1}),k(o,{class:"refresh"},{default:p((()=>[k(o,{class:"r-plate",style:v("background: url("+s.imgurl+"moneyCard.png?v="+s.imgVersion+") no-repeat;background-size: cover;background-color: "+s.themedata.themeBackgroundColor+";")},{default:p((()=>[k(o,{class:"left"},{default:p((()=>[k(o,{class:"number"},{default:p((()=>[b(w(s.userdata.refresh_coupon),1)])),_:1}),k(o,null,{default:p((()=>[b("我的刷新道具数量（个）")])),_:1})])),_:1}),k(o,{class:"right",onClick:t[0]||(t[0]=e=>n.linkTo(`${s.appBoolean?s.channelDomain:""}${s.pages.purRefresh}?${s.appFullScreen}`))},{default:p((()=>[b("购买刷新")])),_:1})])),_:1},8,["style"]),k(o,{class:"r-time",onClick:n.timeFn,"data-state":"1"},{default:p((()=>[k(o,{class:"left"},{default:p((()=>[b("开始时间")])),_:1}),s.seltime[s.selArr[0]]?(c(),m(o,{key:0,class:"right"},{default:p((()=>[k(i,null,{default:p((()=>[b(w(s.seltime[s.selArr[0]].value)+"."+w(s.seltime[s.selArr[0]].month[s.selArr[1]].value)+"."+w(s.seltime[s.selArr[0]].month[s.selArr[1]].day[s.selArr[2]].value)+" "+w(s.seltime[s.selArr[0]].month[s.selArr[1]].day[s.selArr[2]].hours[s.selArr[3]].value)+":"+w(s.seltime[s.selArr[0]].month[s.selArr[1]].day[s.selArr[2]].hours[s.selArr[3]].minutes[s.selArr[4]]),1)])),_:1}),k(r,{src:s.imgurl+"r-arrow.png?v="+s.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1})):_("",!0)])),_:1},8,["onClick"]),k(o,{class:"r-time",onClick:n.timeFn,"data-state":"2"},{default:p((()=>[k(o,{class:"left"},{default:p((()=>[b("时间间隔")])),_:1}),k(o,{class:"right"},{default:p((()=>[k(i,null,{default:p((()=>[b(w(s.timedata[s.seltimeout[0]].title),1)])),_:1}),k(r,{src:s.imgurl+"r-arrow.png?v="+s.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1})])),_:1},8,["onClick"]),k(o,{class:"r-number"},{default:p((()=>[k(o,null,{default:p((()=>[b("设置刷新次数")])),_:1}),k(u,{type:"number",placeholder:"请输入2以上的数字（含2次）",value:s.times,onInput:n.timesFn},null,8,["value","onInput"])])),_:1})])),_:1}),k(o,{class:"explain"},{default:p((()=>[k(o,{class:"e-title"},{default:p((()=>[b("自动刷新设置说明：")])),_:1}),k(o,{class:"e-text"},{default:p((()=>[k(o,null,{default:p((()=>[b("1、设置自动刷新后，一次性扣除相应的刷新数量，刷新次数用完则停止自动刷新。")])),_:1}),k(o,null,{default:p((()=>[b("2、开始时间必须在24小时以内")])),_:1})])),_:1})])),_:1}),k(o,{class:"popup",style:v("display: "+(s.popb?"block":"none")+";"),onClick:n.timeFn,"data-state":"0"},{default:p((()=>[k(o,{class:"p-content",style:v("transform: translateY("+(s.popconb?"0%":"100%")+");"),onClick:C(n.warnFn,["stop","prevent"])},{default:p((()=>[k(o,{class:"pc-title"},{default:p((()=>[k(o,{class:"pct-cancel",onClick:C(n.timeFn,["stop","prevent"]),"data-state":"0"},{default:p((()=>[b("取消")])),_:1},8,["onClick"]),k(o,null,{default:p((()=>[b("时间选择")])),_:1}),k(o,{class:"pct-confirm",onClick:C(n.timeFn,["stop","prevent"]),"data-state":"3"},{default:p((()=>[b("确定")])),_:1},8,["onClick"])])),_:1}),1==s.selIndex?(c(),m(j,{key:0,value:s.selPre,onChange:n.selectFn,"data-state":"0"},{default:p((()=>[k(h,null,{default:p((()=>[(c(!0),g(y,null,F(s.seltime,((e,t)=>(c(),m(o,{key:t},{default:p((()=>[b(w(e.value+"年"),1)])),_:2},1024)))),128))])),_:1}),k(h,null,{default:p((()=>[(c(!0),g(y,null,F(s.seltime[s.selPre[0]].month,((e,t)=>(c(),m(o,{key:t},{default:p((()=>[b(w(e.value+"月"),1)])),_:2},1024)))),128))])),_:1}),k(h,null,{default:p((()=>[(c(!0),g(y,null,F(s.seltime[s.selPre[0]].month[s.selPre[1]].day,((e,t)=>(c(),m(o,{key:t},{default:p((()=>[b(w(e.value+"日"),1)])),_:2},1024)))),128))])),_:1}),k(h,null,{default:p((()=>[(c(!0),g(y,null,F(s.seltime[s.selPre[0]].month[s.selPre[1]].day[s.selPre[2]].hours,((e,t)=>(c(),m(o,{key:t},{default:p((()=>[b(w(e.value+"时"),1)])),_:2},1024)))),128))])),_:1}),k(h,null,{default:p((()=>[(c(!0),g(y,null,F(s.seltime[s.selPre[0]].month[s.selPre[1]].day[s.selPre[2]].hours[s.selPre[3]].minutes,((e,t)=>(c(),m(o,{key:t},{default:p((()=>[b(w(e+"分"),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value","onChange"])):_("",!0),2==s.selIndex?(c(),m(j,{key:1,onChange:n.selectFn,"data-state":"1",value:s.selpreout},{default:p((()=>[k(h,null,{default:p((()=>[(c(!0),g(y,null,F(s.timedata,((e,t)=>(c(),m(o,{key:t},{default:p((()=>[b(w(e.title),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["onChange","value"])):_("",!0)])),_:1},8,["style","onClick"])])),_:1},8,["style","onClick"]),k(o,{class:"botbtn"},{default:p((()=>[k(o,{style:v("background-color: "+s.themedata.themeBackgroundColor+";"),onClick:n.confirmFn},{default:p((()=>[b("确定")])),_:1},8,["style","onClick"])])),_:1}),k(o,{class:"pop-warning",style:v(s.warningb?"transform:scale(1);":"transform:scale(0);z-index:-1;")},{default:p((()=>[k(o,{class:"text",style:{transform:"translate(-50%, -50%)"}},{default:p((()=>[b(w(s.info),1)])),_:1})])),_:1},8,["style"]),s.delb?(c(),m(o,{key:1,class:"st-pop",onClick:n.promptFn,"data-state":"0"},{default:p((()=>[k(o,{class:"pop-content","data-state":"1",onClick:C(n.promptFn,["stop","prevent"])},{default:p((()=>[k(o,{class:"text"},{default:p((()=>[b("您的剩余刷新次数不足，请先前往充值")])),_:1}),k(o,{class:"btn"},{default:p((()=>[k(o,{class:"cancel",onClick:C(n.promptFn,["stop","prevent"]),"data-state":"0"},{default:p((()=>[b("重新设置")])),_:1},8,["onClick"]),k(o,{class:"confirm",style:v("background: "+s.themedata.themeBackgroundColor+";"),onClick:t[1]||(t[1]=e=>n.linkTo(`${s.appBoolean?s.channelDomain:""}${s.pages.purRefresh}?${s.appFullScreen}`))},{default:p((()=>[b(" 购买刷新 ")])),_:1},8,["style"])])),_:1})])),_:1},8,["onClick"])])),_:1},8,["onClick"])):_("",!0),k(I,{privateShow:s.privateb},null,8,["privateShow"])])),_:1})}],["__scopeId","data-v-8f3ed614"]]);export{R as default};
