import{B as a,C as t,E as l,o as e,c as i,w as o,n as s,y as n,i as c,a as r,e as d,t as p,f as g,x as u,d as f,r as m,F as b,z as h,A as k,J as y,b as w,H as _}from"./index-VDmuvODd.js";import{_ as C,p as T,r as v,a as x,b as D,c as F}from"./tieba.Bhdfcttv.js";var $,I;const G=n();const S=C({data:()=>({imgVersion:G.globalData.imgVersion,masterDomain:G.globalData.masterDomain,imgError:G.globalData.imgError,imgPath:`${G.globalData.imgPath}/tieba`,userError:G.globalData.userError,webMini:G.globalData.webMini,webdyMini:G.globalData.webdyMini,cityInfo:G.globalData.cityInfo,wh:G.globalData.navTop,appConfig:{},listdata:[],tabList:[{id:0,title:"全部"}],infoData:{},moldConfig:G.globalData.moduleConfig.tieba||{},mold:"tieba",page:1,pageSize:10,activeIndex:-1,pageId:-1,tabDis:a(214),tabPop:!1,orderby:"",loadImage:{},tabDom:[],scrollLeft:0,gapWidth:0,warningb:!1,info:"",loadingb:!1,ajaxb:!1,tabStickyb:!1,selTab:!1,privateb:!1,platForm:G.globalData.platForm,appBoolean:!1,Android:!1,pages:{},biasTop:0,tabTop:0,shareLink:"",firstb:!0}),onLoad(a){$=this,G.watchG("appConfig",(a=>{$.appConfig=a})),G.globalData.imgVersion?$.imgVersion=G.globalData.imgVersion:G.watchG("imgVersion",(function(a){$.imgVersion=a})),-1==G.globalData.wxprivate?G.watchG("wxprivate",(function(t){$.wxprivate=t,t?$.privateb=!0:$.onload(a)})):G.globalData.wxprivate?$.privateb=!0:$.onload(a)},onPageScroll(a){a.scrollTop>=$.tabDis?!$.tabStickyb&&($.tabStickyb=!0):$.tabStickyb&&($.tabStickyb=!1)},onShow(){$.firstb?$.firstb=!1:G.wxShareFn({title:$.moldConfig.channelName,link:$.shareLink,imgUrl:$.moldConfig.sharePic,description:$.moldConfig.description})},methods:{onload(t){switch($.platForm){case"web":$.appBoolean=window.appBoolean,$.cityInfo=window.cityInfo,$.tabTop=a(88),$.shareLink=`${location.href}&fromShare=${G.globalData.userid}`,$.appBoolean&&($.tabTop=0),G.watchG("webMini",(a=>{$.webMini=a,a&&($.tabTop=0)})),$.webdyMini&&($.tabTop=0);break;case"mp-weixin":$.biasTop=G.globalData.biasTop_88,$.tabTop=$.wh+$.biasTop+a(88)}$.pages=G.pageFn(T),"{}"==JSON.stringify($.moldConfig)&&$.configData(),$.pageId=t.id||1,$.tabList[0].id=t.id||1,$.tabData(),$.detailData()},backFn(){G.backFn()},linkTo(a){G.linkTo(a,!1,!1)},warnFn(a=2e3){$.warningb=!0,clearTimeout(I),I=setTimeout((a=>{$.warningb=!1}),a)},async listFn(t,l=!1){$.ajaxb=!0;let e=await $.$ajax.post({url:G.encodeUrl("include/ajax.php?"),data:t});if(100==e.data.state){$.listdata=l?$.listdata.concat(e.data.info.list):[...e.data.info.list];let t=$.listdata.length;for(let l=t-e.data.info.list.length;l<t;l++){let t=$.listdata[l],e=`.foldTip_${l}`;t.play=!1,t.textFold=!1,t.content=t.content.replace(/[\r|\n|\s|&nbsp;]/gi,""),G.getdomFn($,e,(l=>{if(l.length>0){Math.round(l[0].height/a(40))>2&&(t.textFold=!0)}}))}$.loadingb=Boolean(e.data.info.list.length>=$.pageSize)}else $.loadingb=!1;$.ajaxb=!1},async tabData(){let t={service:"tieba",action:"type",type:$.pageId},l=await $.$ajax.post({url:G.encodeUrl("include/ajax.php?"),data:t});100==l.data.state&&($.tabList=[...$.tabList,...l.data.info],G.getdomFn($,".t-list,.t-item",(t=>{let l=t[0].width-a(160),e=t.length,i=(t.length-2)*a(40);for(let a=1;a<e;a++){if(i+=t[a].width,i>l){$.tabPop=!0;break}}$.gapWidth=t[0].width-a(110),$.tabDom=t.slice(1),$.tabFn(0)})))},async detailData(){let a={service:"tieba",action:"typeDetail",id:$.pageId},l=await $.$ajax.post({url:G.encodeUrl("include/ajax.php?"),data:a});if(100==l.data.state){$.infoData=l.data.info;let a=$.infoData.statistics.tiziClickTotal;$.infoData.statistics.tiziClickTotal=a>1e4?Math.floor(a/1e3)/10+"万":a;let e=$.infoData.statistics.tiziTodayTotal;$.infoData.statistics.tiziTodayTotal=e>1e4?Math.floor(e/1e3)/10+"万":e;let i=$.infoData.statistics.tiziTotal;$.infoData.statistics.tiziTotal=i>1e4?Math.floor(i/1e3)/10+"万":i,t({title:$.infoData.typename})}},emitConfig(a,t){$[t]=a},async configData(){let a={service:$.mold,action:"config"},t=await $.$ajax.post({url:G.encodeUrl("include/ajax.php?"),data:a});100==t.data.state&&($.moldConfig=t.data.info,G.globalData.moduleConfig.tieba=t.data.info)},async tabFn(a){if(a==$.activeIndex)return!1;let t=$.tabDom;if(0==t.length)return $.info="切换失败，请稍后再试",!1;let l=$.gapWidth,e=t[a].left-t[0].left,i=t[t.length-1].left+t[t.length-1].width-t[a].left;if(i<=l/2)$.scrollLeft=i+t[a].left;else if(e>l/2){let a=24;$.scrollLeft=e-l/2+a}else $.scrollLeft=0;$.activeIndex=a,$.page=1,$.listdata=[];let o={service:"tieba",action:"tlist",typeid:$.tabList[a].id,orderby:$.orderby,page:1,pageSize:$.pageSize};$.listFn(o)},async secTabFn(a){if(a==$.orderby)return!1;$.orderby=a,$.page=1,$.listdata=[];let t={service:"tieba",action:"tlist",typeid:$.tabList[$.activeIndex].id,orderby:a,page:1,pageSize:$.pageSize};$.listFn(t)},async zanFn(a){let t=G.globalData.userid;if(!t)return G.tologin(`${$.pages.list}?id=${$.pageId}`),!1;if($.ajaxb)return!1;$.ajaxb=!0;let l=$.listdata[a],e={service:"member",action:"getZan",module:"tieba",temp:"detail",title:l.title,id:l.id,uid:t},i=await $.$ajax.post({url:G.encodeUrl("include/ajax.php?"),data:e});100==i.data.state?(l.isdz=!l.isdz,l.isdz?++l.up:--l.up):$.info=i.data.info,$.ajaxb=!1},previewImage(a,t){let l={app:{urls:a,current:a[t]},init:{urls:a,current:t}};G.previewImage(l)}},watch:{info(a,t){""!=a&&($.warnFn(),setTimeout((a=>{$.info=""}),2200))},moldConfig(a,t){"{}"!=JSON.stringify(a)&&a&&G.wxShareFn({title:$.moldConfig.channelName,link:$.shareLink,imgUrl:$.moldConfig.sharePic,description:$.moldConfig.description})}},onPullDownRefresh(){G.reloadFn()},onReachBottom(){if(!$.loadingb)return;let a={service:"tieba",action:"tlist",typeid:$.tabList[$.activeIndex].id,orderby:$.orderby,page:++$.page,pageSize:$.pageSize};$.ajaxb||$.listFn(a,!0)},onShareAppMessage:a=>({title:$.moldConfig.channelName,desc:$.moldConfig.description}),onShareTimeline:()=>({title:$.moldConfig.channelName,imageUrl:$.moldConfig.sharePic})},[["render",function(a,t,n,C,T,$){const I=v(l("webTop"),x),G=h,S=c,z=k,L=y,j=_,P=v(l("popWarn"),D),V=v(l("private_tip"),F);return e(),i(S,{class:"Shell",style:s(`padding-top:${T.tabTop}px`)},{default:o((()=>["web"!=T.platForm||T.webMini||T.appBoolean||T.webdyMini?"mp-weixin"==T.platForm?(e(),i(S,{key:1,class:"navTop center",style:s(`padding-top:calc(${T.wh+T.biasTop}px);`)},{default:o((()=>[r(S,{class:"n-back",onClick:$.backFn},{default:o((()=>[r(G,{src:`${T.masterDomain}/static/images/header_back.png?v=${T.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"]),r(z,null,{default:o((()=>[d(p(T.moldConfig.channelName||"贴吧"),1)])),_:1})])),_:1},8,["style"])):g("",!0):(e(),i(I,{key:0,class:"webTop",title:T.moldConfig.channelName||"贴吧",module:T.mold,index:!1},null,8,["title","module"])),r(S,{class:"topIntroduce",style:s(`background: url('${T.imgPath}/bg2.png') no-repeat;`)},{default:o((()=>[r(G,{src:T.infoData.icon,mode:"aspectFit",class:u(["t-logo",{loadingImg:!T.loadImage[T.infoData.icon]}]),onLoad:t[0]||(t[0]=a=>T.loadImage[T.infoData.icon]=!0)},null,8,["src","class"]),r(S,{class:"t-info"},{default:o((()=>[r(S,{class:"ti-title"},{default:o((()=>[d(p(T.infoData.typename),1)])),_:1}),T.infoData.statistics?(e(),i(S,{key:0,class:"ti-data"},{default:o((()=>[r(z,null,{default:o((()=>[d("今日发帖："+p(T.infoData.statistics.tiziTodayTotal||T.infoData.statistics.tiziTotal),1)])),_:1}),r(z,{class:"browser"},{default:o((()=>[d("浏览量："+p(T.infoData.statistics.tiziClickTotal),1)])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1},8,["style"]),r(S,{class:u(["tab",{isSticky:T.tabStickyb}]),style:s(`top:${T.tabTop}px`)},{default:o((()=>[r(L,{class:"t-list","scroll-x":!0,"show-scrollbar":!1,"scroll-with-animation":!0,"scroll-left":T.scrollLeft},{default:o((()=>[(e(!0),f(b,null,m(T.tabList,((a,t)=>(e(),i(S,{class:u(["t-item",{active:T.activeIndex==t}]),key:t,onClick:l=>a.redirect?$.linkTo(a.redirect):$.tabFn(t)},{default:o((()=>[r(z,null,{default:o((()=>[d(p(a.title),1)])),_:2},1024),r(G,{src:`${T.imgPath}/barOrange.png?v=${T.imgVersion}`},null,8,["src"])])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["scroll-left"]),T.tabPop?(e(),i(S,{key:0,class:"t-more",onClick:t[1]||(t[1]=a=>T.selTab=!0)},{default:o((()=>[r(S,{class:"btn"},{default:o((()=>[r(G,{src:`${T.imgPath}/addBlack.png?v=${T.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1})])),_:1})):g("",!0)])),_:1},8,["class","style"]),r(S,{class:"secTab"},{default:o((()=>[r(S,{class:u(["s-total",{active:!T.orderby}]),onClick:t[2]||(t[2]=a=>$.secTabFn(""))},{default:o((()=>[d("全部内容")])),_:1},8,["class"]),r(S,{class:"s-other"},{default:o((()=>[r(S,{class:u([{active:"click"==T.orderby}]),onClick:t[3]||(t[3]=a=>$.secTabFn("click"))},{default:o((()=>[d("最热")])),_:1},8,["class"]),r(S,{class:u([{active:"pubdate"==T.orderby}]),onClick:t[4]||(t[4]=a=>$.secTabFn("pubdate"))},{default:o((()=>[d("最新")])),_:1},8,["class"])])),_:1})])),_:1}),T.listdata.length>0?(e(),i(S,{key:2,class:"list"},{default:o((()=>[(e(!0),f(b,null,m(T.listdata,((a,l)=>(e(),i(S,{class:"l-item",key:l,onClick:t=>$.linkTo(T.appBoolean?a.url:`${T.pages.detail}?id=${a.id}`)},{default:o((()=>[r(S,{class:"li-user"},{default:o((()=>[r(G,{src:a.photo||T.userError,mode:"aspectFill",class:u(["liu-photo",{loadingImg:!T.loadImage[a.photo]}]),onLoad:t=>T.loadImage[a.photo]=!0,onError:t=>a.photo=T.userError},null,8,["src","class","onLoad","onError"]),r(S,{class:"liu-info"},{default:o((()=>[r(S,{class:"title"},{default:o((()=>[d(p(a.username||"用户"),1)])),_:2},1024),r(S,{class:"text"},{default:o((()=>[d(p(a.pubdate1)+" "+p(a.typename.join("/")),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),r(S,{class:"li-title"},{default:o((()=>[1==a.top?(e(),i(S,{key:0,class:"lit-label"},{default:o((()=>[d("置顶")])),_:1})):g("",!0),r(z,null,{default:o((()=>[d(p(a.title),1)])),_:2},1024)])),_:2},1024),a.content?(e(),i(S,{key:0,class:u(["li-text",{textFold:!a.textFold}])},{default:o((()=>[r(S,{class:"test"},{default:o((()=>[r(z,{class:"unflod",onClick:w((t=>a.textFold=!1),["stop"])},{default:o((()=>[d("全文")])),_:2},1032,["onClick"]),r(z,{class:u(`text foldTip_${l}`)},{default:o((()=>[d(p(a.content),1)])),_:2},1032,["class"])])),_:2},1024)])),_:2},1032,["class"])):g("",!0),a.isvideo?(e(),i(S,{key:1,class:u(["li-video",{loadingImg:a.imgGroup[0]}])},{default:o((()=>[a.play?(e(),i(j,{key:1,src:a.video,autoplay:"",onClick:t[5]||(t[5]=w((()=>{}),["stop"]))},null,8,["src"])):(e(),i(S,{key:0,class:"poster"},{default:o((()=>[r(G,{src:a.imgGroup[0],mode:"aspectFill",class:"cover"},null,8,["src"]),r(G,{src:`${T.imgPath}/pauseGrey.png?v=${T.imgVersion}`,mode:"aspectFit",class:"pause",onClick:w((t=>a.play=!0),["stop"])},null,8,["src","onClick"])])),_:2},1024))])),_:2},1032,["class"])):1==a.imgGroup.length?(e(),i(S,{key:2,class:"li-pic"},{default:o((()=>[r(G,{src:a.imgGroup[0]||T.imgError,mode:"aspectFill",class:u(["cover",{loadingImg:!T.loadImage[a.imgGroup[0]]}]),onError:t=>a.imgGroup[0]=T.imgError,onClick:w((t=>$.previewImage(a.imgGroup,0)),["stop"])},null,8,["src","class","onError","onClick"])])),_:2},1024)):a.imgGroup.length>1?(e(),i(S,{key:3,class:"li-pics"},{default:o((()=>[r(G,{src:a.imgGroup[0],mode:"aspectFill",class:u(["left",{loadingImg:!T.loadImage[a.imgGroup[0]]}]),onClick:w((t=>$.previewImage(a.imgGroup,0)),["stop"])},null,8,["src","class","onClick"]),a.imgGroup.length>=3?(e(),f(b,{key:0},[r(G,{src:a.imgGroup[1],mode:"aspectFill",class:u(["center",{loadingImg:!T.loadImage[a.imgGroup[1]]}]),onClick:w((t=>$.previewImage(a.imgGroup,1)),["stop"])},null,8,["src","class","onClick"]),3!=a.imgGroup.length?(e(),i(S,{key:0,class:"totalTip"},{default:o((()=>[d(p(a.imgGroup.length)+"张",1)])),_:2},1024)):g("",!0)],64)):g("",!0),r(G,{src:a.imgGroup[2]||a.imgGroup[1],mode:"aspectFill",class:u(["right",{loadingImg:!T.loadImage[a.imgGroup[1]]&&!a.imgGroup[2]}]),onClick:w((t=>$.previewImage(a.imgGroup,a.imgGroup[2]?2:1)),["stop"])},null,8,["src","class","onClick"])])),_:2},1024)):g("",!0),r(S,{class:"li-btn"},{default:o((()=>[r(S,null,{default:o((()=>[r(G,{src:`${T.imgPath}/eyeBlack.png?v=${T.imgVersion}`,mode:"aspectFit"},null,8,["src"]),r(z,null,{default:o((()=>[d(p(a.click||0),1)])),_:2},1024)])),_:2},1024),r(S,null,{default:o((()=>[r(G,{src:`${T.imgPath}/chatBlack.png?v=${T.imgVersion}`,mode:"aspectFit"},null,8,["src"]),r(z,null,{default:o((()=>[d(p(a.reply||0),1)])),_:2},1024)])),_:2},1024),r(S,{onClick:w((a=>$.zanFn(l)),["stop"])},{default:o((()=>[r(G,{src:`${T.imgPath}/zan${Number(a.isdz)+1}.png?v=${T.imgVersion}`,mode:"aspectFit"},null,8,["src"]),r(z,null,{default:o((()=>[d(p(a.up||0),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):(e(),i(S,{key:3,class:"blank"},{default:o((()=>[r(G,{src:`${T.imgPath}/noData2.png?v=${T.imgVersion}`,mode:"aspectFit"},null,8,["src"]),r(S,{class:"tip"},{default:o((()=>[d("快做第一个发帖的老铁哦~")])),_:1}),r(S,{class:"btn",onClick:t[6]||(t[6]=a=>$.linkTo(`${T.appConfig.cfg_user_index}/fabu-tieba.html`))},{default:o((()=>[d("我来发帖")])),_:1})])),_:1})),0!=T.listdata.length?(e(),i(S,{key:4,class:"loadingText"},{default:o((()=>[d(p(T.loadingb?"加载中...":"已经到底啦~"),1)])),_:1})):g("",!0),r(S,{class:"tabAll",style:s(`transform:translateY(${T.selTab?"0%":"100%"});padding-top:${T.wh+T.biasTop}px;`)},{default:o((()=>[r(S,{class:"ta-title",style:s("padding-right:"+("mp-weixin"==T.platForm?"180rpx":"0"))},{default:o((()=>[r(z,null,{default:o((()=>[d("所有频道")])),_:1}),r(G,{src:`${T.imgPath}/closeBlack.png?v=${T.imgVersion}`,mode:"aspectFit",onClick:t[7]||(t[7]=a=>T.selTab=!1)},null,8,["src"])])),_:1},8,["style"]),r(S,{class:"ta-item"},{default:o((()=>[(e(!0),f(b,null,m(T.tabList,((a,t)=>(e(),i(S,{class:u([{active:t==T.activeIndex}]),key:t,onClick:l=>{a.redirect?$.linkTo(a.redirect):$.tabFn(t),T.selTab=!1}},{default:o((()=>[d(p(a.title),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1},8,["style"]),r(G,{src:`${T.imgPath}/addCircle.png?v=${T.imgVersion}`,mode:"aspectFit",class:"fabu",onClick:t[8]||(t[8]=a=>$.linkTo(`${T.appConfig.cfg_user_index}/fabu-tieba.html`))},null,8,["src"]),r(P,{info:T.info,warningb:T.warningb},null,8,["info","warningb"]),r(V,{privateShow:T.privateb},null,8,["privateShow"])])),_:1},8,["style"])}],["__scopeId","data-v-0ef2990b"]]);export{S as default};
