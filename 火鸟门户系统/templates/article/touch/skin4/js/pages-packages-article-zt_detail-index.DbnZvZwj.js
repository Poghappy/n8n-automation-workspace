import{E as a,n as l,r as t,G as e,c as i,$ as s,a as n,e as o,f as p,o as r,h as c,w as d,i as u,j as m,m as b,p as g,q as f,k as h,t as _,u as k,F as x,v as w,l as F,A as $,x as v,y as D,S as y}from"./index-BfhdaSGz.js";import{_ as T}from"./mp-html.KQam4B07.js";import{_ as C,r as j,a as S}from"./private_tip.Cj56aYgc.js";import{a as V}from"./article.ByLku1bF.js";import{w as z}from"./webTop.CwDVe_Cu.js";var B;const I=u();const A=C({components:{webTop:z,mpHtml:T},data:()=>({globalData:I.globalData,masterDomain:I.globalData.masterDomain,imgVersion:I.globalData.imgVersion,imgurl:I.globalData.imgPath+"/article/",listdata:[],detail:{},tabdata:[],activeIndex:0,tabDom:[0,0,0],headerH:0,pages:{},ajaxTimes:0,privateb:!1,ajaxb:!1,popb:!1,popconb:!1,publishb:!1,platForm:I.globalData.platForm,appBoolean:!1,wh:I.globalData.navTop||0,biasTop:I.globalData.biasTop_88,stickTop:"0rpx",Android:!1,shareLink:""}),onLoad(a){B=this,-1==I.globalData.wxprivate?I.watchG("wxprivate",(function(l){B.wxprivate=l,l?B.privateb=!0:B.onload(a)})):I.globalData.wxprivate?B.privateb=!0:B.onload(a)},onPageScroll(a){a.scrollTop>0?B.publishb||(B.publishb=!B.publishb):B.publishb&&(B.publishb=!B.publishb)},methods:{onload(a){B.pages=I.pageFn(V);let l={service:"article",action:"zhuantiDetail",id:a.id};B.infoData(l),"web"==B.platForm?(B.shareLink=`${location.href.replace("?","&")}&fromShare=${I.globalData.userid}`.replace("&","?"),B.appBoolean=window.appBoolean,B.Android=window.Android,B.appBoolean?B.Android?B.stickTop="148rpx":B.stickTop="0rpx":B.stickTop="88rpx"):"mp-weixin"==B.platForm&&(B.stickTop=`calc(${B.wh+B.biasTop}px + 88rpx)`)},backFn(){if(B.appBoolean)return window.setupWebViewJavascriptBridge((function(a){a.callHandler("goBack",{},(function(a){}))})),!1;{let e=a();e&&e.length>1?l({delta:1}):"web"==B.platForm?location.href=`${B.masterDomain}${window.pathname}${B.pages.index}`:t({url:"/pages/packages/article/index/index"})}},linkTo(a){if(a){if(B.appBoolean)return location.href=a,!1;"web"==I.globalData.platForm?a.indexOf("http")>-1?location.href=a:e({url:a}):e({url:a.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(a):a})}},listFn(a,l,t=!1){B.ajaxb=!0,B.$ajax.post({url:"include/ajax.php?",data:a}).then((a=>{if(100==a.data.state){let e=a.data.info.list;for(let a=0;a<e.length;a++){let l=new Date(1e3*e[a].pubdate),t=(l.getMonth()+1<10?"0":"")+(l.getMonth()+1),i=(l.getDate()<10?"0":"")+l.getDate();e[a].pubdate=`${t}-${i}`}B.listdata[l]=t?B.listdata[l].concat(a.data.info.list):[...a.data.info.list];let i=a.data.info.pageInfo.totalCount,s=B.tabdata[l].page,n=B.tabdata[l].pageSize;B.tabdata[l].loading=!(s*n>=i)}if(!t&&(--B.ajaxTimes,l==B.tabdata.length-1)){let a=setInterval((l=>{0==B.ajaxTimes&&(clearInterval(a),B.$nextTick((a=>{i().in(this).selectAll(".tabItem,.tab,.b-picture").boundingClientRect((a=>{let l=a.length-2;if(a&&a.length>0)for(let t=0;t<l;t++)B.tabDom[t]=a[t+2].top-a[1].height-a[0].top})).exec()})))}),200)}B.ajaxb=!1}))},tabFn(a){B.activeIndex=a,s({scrollTop:B.tabDom[a],duration:100})},infoData(a){B.$ajax.post({url:I.encodeUrl("include/ajax.php?"),data:a}).then((a=>{if(100==a.data.state){let l=a.data.info;B.ajaxTimes=l.lower.length;for(let a=0;a<l.lower.length;a++){l.lower[a].page=1,l.lower[a].pageSize=5,l.lower[a].loading=!1;let t={service:"article",action:"alist",zhuanti:l.lower[a].id,page:1,pageSize:l.lower[a].pageSize};B.listFn(t,a)}B.detail=l,B.tabdata=l.lower,n({title:l.typename}),I.wxShareFn({title:B.detail.typename,imgUrl:B.detail.banner_small,link:B.shareLink,description:B.detail.description})}}))},loadMoreFn(a){let l=B.tabdata[a],t={service:"article",action:"alist",zhuanti:l.id,page:++l.page,pageSize:l.pageSize};B.listFn(t,a,!0)},popFn(a){0==a?(B.popconb=!1,setTimeout((a=>{B.popb=!1}),220)):(B.popb=!0,setTimeout((a=>{B.popconb=!0}),0))},publishFn(){let a=`${I.globalData.appConfig.cfg_user_index}/fabu-article.html`;B.linkTo(a)}},watch:{globalData:{handler(a,l){B.imgVersion=a.imgVersion},deep:!0},info(a,l){""!=a&&(B.warnFn(),setTimeout((a=>{B.info=""}),2200))}},onPullDownRefresh(){I.reloadFn()},onShareAppMessage(a){return{title:this.detail.typename,imageUrl:this.detail.banner_small}},onShareTimeline(){return{title:this.detail.typename,imageUrl:this.detail.banner_small}}},[["render",function(a,l,t,e,i,s){const n=v,u=m,C=D,V=o("web-top"),z=y,B=j(p("mp-html"),T),I=j(p("private_tip"),S);return r(),c(u,{class:"Shell"},{default:d((()=>["mp-weixin"==i.platForm?(r(),c(u,{key:0,class:"futureTop",style:b(`padding-top:calc(${i.wh+i.biasTop}px);`)},{default:d((()=>[g(u,{class:"wxBack",onClick:s.backFn},{default:d((()=>[g(n,{src:`${i.masterDomain}/static/images/header_back.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"]),g(C,null,{default:d((()=>[f("专题")])),_:1})])),_:1},8,["style"])):"mp-toutiao"==i.platForm||i.appBoolean&&!i.Android?h("",!0):(r(),c(V,{key:1,title:"专题",module:"article",class:"webTop",style:b("padding-top:"+(i.Android?"60rpx":"0rpx"))},null,8,["style"])),g(u,{class:"banner"},{default:d((()=>[g(u,{class:"b-mask"}),g(n,{src:i.detail.banner_small,mode:"aspectFill",class:"b-picture"},null,8,["src"]),g(u,{class:"b-intro"},{default:d((()=>[g(u,{class:"bi-title"},{default:d((()=>[f(_(i.detail.typename),1)])),_:1}),g(u,{class:"bi-text"},{default:d((()=>[g(u,{class:"blank",onClick:l[0]||(l[0]=a=>s.popFn(1))},{default:d((()=>[g(C,null,{default:d((()=>[f("全文")])),_:1})])),_:1}),f(" "+_(i.detail.description),1)])),_:1})])),_:1})])),_:1}),i.tabdata.length>0?(r(),k(x,{key:2},[g(z,{class:"tab","scroll-x":!0,style:b(`top:${i.stickTop}`)},{default:d((()=>[(r(!0),k(x,null,w(i.tabdata,((a,l)=>(r(),c(u,{class:F(["item",{active:l==i.activeIndex}]),key:l,onClick:a=>s.tabFn(l)},{default:d((()=>[g(n,{src:`${i.imgurl}address.png?v=${i.imgVersion}`,mode:"aspectFit",style:b(`transform:scale(${i.activeIndex==l?1:0})`)},null,8,["src","style"]),g(C,null,{default:d((()=>[f(_(a.typename),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1},8,["style"]),g(u,{class:F(["publish",{circle:i.publishb}]),onClick:s.publishFn},{default:d((()=>[g(u,null,{default:d((()=>[g(n,{src:`${i.imgurl}zt_publish.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"]),g(C,null,{default:d((()=>[f("投稿")])),_:1})])),_:1})])),_:1},8,["class","onClick"])],64)):(r(),c(u,{key:3,class:"noData"},{default:d((()=>[g(u,{class:"n-data"},{default:d((()=>[g(n,{src:`${i.imgurl}zt_noData.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"]),g(C,null,{default:d((()=>[f("暂无相关资讯")])),_:1})])),_:1}),g(u,{class:"n-publish",onClick:s.publishFn},{default:d((()=>[g(n,{src:`${i.imgurl}zt_publish.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"]),g(C,null,{default:d((()=>[f("我来投稿")])),_:1})])),_:1},8,["onClick"])])),_:1})),g(u,{class:"list"},{default:d((()=>[(r(!0),k(x,null,w(i.tabdata,((a,l)=>(r(),c(u,{key:l,class:"tabItem"},{default:d((()=>[g(u,{class:"l-title"},{default:d((()=>[f(_(a.typename),1)])),_:2},1024),(r(!0),k(x,null,w(i.listdata[l],((a,l)=>(r(),c(u,{class:"item",key:l,onClick:l=>s.linkTo(i.appBoolean?a.url:`${i.pages.detail}?id=${a.id}`)},{default:d((()=>[g(u,{class:"l-left"},{default:d((()=>[g(u,{class:"ll-title"},{default:d((()=>[f(_(a.title),1)])),_:2},1024),g(u,{class:"ll-tip"},{default:d((()=>[g(u,null,{default:d((()=>[f(_(a.source)+" · "+_(a.pubdate),1)])),_:2},1024),g(u,{class:"browser"},{default:d((()=>[g(n,{src:`${i.imgurl}read.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"]),g(C,null,{default:d((()=>[f(_(a.click),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024),g(u,{class:"l-right"},{default:d((()=>[g(n,{src:a.litpic,mode:"aspectFill"},null,8,["src"])])),_:2},1024)])),_:2},1032,["onClick"])))),128)),i.listdata[l]?h("",!0):(r(),c(u,{key:0,class:"l-noData"},{default:d((()=>[f("暂无相关资讯")])),_:1})),a.loading?(r(),c(u,{key:1,class:"l-unfold",onClick:a=>s.loadMoreFn(l)},{default:d((()=>[g(C,null,{default:d((()=>[f("展开更多")])),_:1}),g(n,{src:`${i.imgurl}d_arr.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:2},1032,["onClick"])):h("",!0)])),_:2},1024)))),128))])),_:1}),i.popb?(r(),c(u,{key:4,class:"pop",onClick:l[3]||(l[3]=a=>s.popFn(0))},{default:d((()=>[g(u,{class:"p-content",style:b(`transform:translateY(${i.popconb?0:"100%"})`),onClick:l[2]||(l[2]=$((()=>{}),["stop"]))},{default:d((()=>[g(n,{src:`${i.imgurl}popbgi.png?v=${i.imgVersion}`,mode:"aspectFit",class:"textBG"},null,8,["src"]),g(u,{class:"pc-close",onClick:l[1]||(l[1]=a=>s.popFn(0))},{default:d((()=>[g(n,{src:`${i.imgurl}detail_back.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1}),g(u,{class:"pc-title"},{default:d((()=>[f(_(i.detail.typename),1)])),_:1}),g(B,{content:i.detail.description.replace(/[\r\n]/g,"<br>"),class:"pc-content"},null,8,["content"])])),_:1},8,["style"])])),_:1})):h("",!0),g(I,{privateShow:i.privateb},null,8,["privateShow"])])),_:1})}],["__scopeId","data-v-1a713e2b"]]);export{A as default};
