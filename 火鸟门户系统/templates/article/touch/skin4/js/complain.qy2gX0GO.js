import{G as a,a0 as e,a1 as o,o as t,h as n,w as s,p as l,m as p,q as i,t as c,k as r,u as d,F as u,v as f,A as y,l as m,W as b,X as g,i as _,T as h,U as C,x as k,j as F,y as w,f as x,I,_ as $}from"./index-BfhdaSGz.js";import{_ as v,r as D}from"./private_tip.Cj56aYgc.js";import{_ as T}from"./popWarn.B1WhhsWw.js";var P,j,S;const A=_();const M=v({name:"pay",props:{payInfo:{type:Object,default:{}},paypopb:{type:Boolean,default:!1},service:{type:String,default:""},action:{type:String,default:""},apply:{type:String,default:""},loginCheck:{type:Boolean,default:!0},extraData:{type:Object,default:{}}},data:()=>({globalData:A.globalData,imgstatic:`${A.globalData.masterDomain}/static/images/miniprograme/payPop/`,imgVersion:A.globalData.imgVersion,payMethods:[{id:0,pay_code:"balance",pay_icon:`${A.globalData.masterDomain}/static/images/miniprograme/payPop/balance.png`,pay_name:"余额"}],userInfo:{},activeIndex:0,formdata:"",timeout:"00:00:00",password:"",popb:!1,popConb:!1,closeb:!1,passwordb:!1,passwordConb:!1,ajaxb:!1,firstb:!0,paySuccessb:!1,platForm:A.globalData.platForm}),mounted(){j=this},methods:{linkTo(e){e&&("web"==A.globalData.platForm?e.indexOf("http")>-1||window.appBoolean?location.href=e:a({url:e}):a({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e}))},async payMethodData(){let a=await j.$ajax.post({url:A.encodeUrl("include/ajax.php?"),data:{action:"payment",service:"siteConfig"}});100==a.data.state?j.userInfo.userid?(j.payMethods=j.payMethods.concat(a.data.info),j.userInfo.money<j.payInfo.order_amount&&(j.activeIndex=1)):j.payMethods=a.data.info:j.$emit("payError",a.data.info)},selectMethod(a,e){if("balance"==a.pay_code){if(j.userInfo.money<j.payInfo.order_amount)return!1}else if("huoniao_bonus"==a.pay_code&&j.userInfo.bonus<j.payInfo.order_amount)return!1;j.formdata=a,j.activeIndex=e},closeFn(a){j.closeb=!1,j.popConb=!1,setTimeout((a=>{j.popb=!1}),300),j.$emit("paypopb",!1),j.$emit("giveUp",a),clearTimeout(P),clearInterval(S),j.ajaxb||j.paySuccessb||j.certificatePayFn(),j.$emit("failpayFn")},countdown(a){let e;10==`${a}`.length&&(e=1e3*a),e=(e-+new Date)/1e3;let o=Math.floor(e%60),t=Math.floor(e%3600/60),n=Math.floor(e/3600);return(o>0||t>0||n>0)&&(n/10<1&&(n="0"+n),t/10<1&&(t="0"+t),o/10<1&&(o="0"+o),P=setTimeout((e=>{j.timeout=j.countdown(a)}),1e3)),n+":"+t+":"+o},payFn(a){"balance"==j.payMethods[a].pay_code?(j.passwordb=!0,setTimeout((a=>{j.passwordConb=!0}),0)):j.checkPasswordFn()},closeCodeFn(){j.passwordConb=!1,setTimeout((a=>{j.passwordb=!1}),300)},inputCodeFn(a){j.password+=a,6==j.password.length&&1==j.userInfo.paypwdCheck&&j.checkPasswordFn()},async setAndPayFn(){let a={service:"member",action:"updateAccount",do:"paypwdAdd",pay1:j.password,pay2:j.password};100==(await j.$ajax.post({url:A.encodeUrl("include/ajax.php?"),data:a})).data.state&&(await A.memberInfo(j.userInfo.userid),j.checkPasswordFn()),j.$emit("payError",res.data.info)},certificatePayFn(){let a=j.payInfo.ordernum.split(",").length>1?1:"";j.$ajax.post({url:A.encodeUrl(`include/ajax.php?service=member&action=tradePayResult&order=${j.payInfo.ordernum}&type=${a}`)}).then((a=>{100==a.data.state&&(j.paySuccessb=!0,j.$emit("paySuccess",a.data.info),clearInterval(S),A.memberInfo(j.userInfo.userid,(function(a){j.userInfo=a}))),j.ajaxb=!1}))},checkPasswordFn(){let o=j.activeIndex,t=j.payMethods[o],n=!1,s={service:j.service,action:j.action,ordernum:j.payInfo.ordernum,paytype:t.pay_code,...j.extraData};if("alipay"==s.paytype||"wxpay"==s.paytype){let o="";for(let a in s)o+=`&${a}=${s[a]}`;if(o=o.slice(1),"web"==j.platForm)window.appBoolean?(n=!0,s.app=1,j.payRequest(s,n)):location.href=`${j.globalData.masterDomain}/include/ajax.php?${o}`;else if("mp-toutiao"==j.platForm){let e=encodeURIComponent(`${j.globalData.masterDomain}/include/ajax.php?${o}`);a({url:`/pages/redirect/index?url=${e}&title=${t.pay_name}`})}else e({title:"支付中",icon:"loading",mask:!0}),j.payRequest(s,n,(function(a){uni.requestPayment({timeStamp:a.data.info.timeStamp,nonceStr:a.data.info.nonceStr,package:a.data.info.package,signType:a.data.info.signType,paySign:decodeURIComponent(a.data.info.paySign),success:a=>{j.certificatePayFn()},fail:a=>{j.$emit("payError","支付失败")}})}))}else"balance"==t.pay_code?(s.useBalance=1,s.balance=j.payInfo.order_amount,s.paypwd=j.password,e({title:"支付中",icon:"loading",mask:!0}),j.payRequest(s,n)):(s.useBalance=0,e({title:"支付中",icon:"loading",mask:!0}),j.payRequest(s,n))},payRequest(a,e,t=function(){}){let n=j.activeIndex,s=j.payMethods[n];j.$ajax.post({url:A.encodeUrl("include/ajax.php?"),data:a}).then((a=>{o(),100==a.data.state?(j.closeCodeFn(),j.closeFn(!1),e?window.setupWebViewJavascriptBridge((function(e){e.callHandler("wxpay"==s.pay_code?"wechatPay":"aliPay",{orderInfo:a.data.info},(function(a){}))})):"sponsor"!=j.apply&&j.$emit("payError","支付成功"),t(a)):j.$emit("payError",a.data.info||a.data),j.password=""}))}},watch:{paypopb(a,o){if(["{}",'""',"null","undefined"].includes(JSON.stringify(j.payInfo)))return e({title:"订单信息丢失",icon:"error",duration:1500}),!1;if(a){let a=function(){j.popb=!0,setTimeout((()=>{j.popConb=!0})),S=setInterval((a=>{j.ajaxb||(j.ajaxb=!0,j.certificatePayFn())}),1e3)},e=A.globalData.userid;if(j.loginCheck&&!e)return A.tologin(),!1;j.firstb?e?(h({title:"用户信息获取中..."}),A.memberInfo(e,(function(e){j.userInfo=e,j.$nextTick((e=>{a()})),C(),j.payMethodData()}))):(j.payMethodData(),j.$nextTick((e=>{a()}))):j.$nextTick((e=>{a()})),j.firstb=!1,j.payInfo.timeout>0&&(j.timeout=j.countdown(j.payInfo.timeout))}}}},[["render",function(a,e,o,_,h,C){const x=k,I=F,$=w;return h.popb?(t(),n(I,{key:0,class:"payComponents"},{default:s((()=>[l(I,{class:"payContent",style:p(`transform: translateY(${h.popConb?0:"100%"});`)},{default:s((()=>[l(x,{src:`${h.imgstatic}close.png?v=${h.imgVersion}`,mode:"aspectFill",class:"pc-close",onClick:e[0]||(e[0]=a=>h.closeb=!0)},null,8,["src"]),l(I,{style:{position:"relative"}},{default:s((()=>[l(I,{class:"payItemTitle"},{default:s((()=>[i(c(o.payInfo.subject)+"需支付",1)])),_:1}),l(I,{class:"moneyTitle"},{default:s((()=>[l(I,{class:"title"},{default:s((()=>[l($,null,{default:s((()=>[i(c(h.globalData.appConfig.currency?h.globalData.appConfig.currency.symbol:"￥"),1)])),_:1}),i(c(o.payInfo.order_amount),1)])),_:1}),o.payInfo.timeout>0?(t(),n(I,{key:0,class:"time"},{default:s((()=>[i("支付剩余时间："+c(h.timeout),1)])),_:1})):r("",!0)])),_:1}),l(I,{class:"payMethod"},{default:s((()=>[(t(!0),d(u,null,f(h.payMethods,((a,e)=>(t(),n(I,{class:"item",key:e,onClick:y((o=>C.selectMethod(a,e)),["stop"])},{default:s((()=>[l(I,{class:"methodName"},{default:s((()=>[l(x,{src:a.pay_icon,mode:"aspectFill"},null,8,["src"]),l(I,null,{default:s((()=>[l($,null,{default:s((()=>[i(c(a.pay_name),1)])),_:2},1024),"balance"==a.pay_code?(t(),n($,{key:0,style:p("opacity:"+(h.userInfo.money>=o.payInfo.order_amount?1:.6))},{default:s((()=>[i(c(h.userInfo.money>=o.payInfo.order_amount?`（可用：${h.globalData.appConfig.currency?h.globalData.appConfig.currency.symbol:"￥"}${h.userInfo.money||0}）`:`（余额不足，可用余额${h.globalData.appConfig.currency?h.globalData.appConfig.currency.symbol:"￥"}${h.userInfo.money||0}）`),1)])),_:1},8,["style"])):r("",!0),"huoniao_bonus"==a.pay_code?(t(),n($,{key:1,style:p("opacity:"+(h.userInfo.bonus>=o.payInfo.order_amount?1:.6))},{default:s((()=>[i(c(h.userInfo.bonus>=o.payInfo.order_amount?`（可用：${h.globalData.appConfig.currency?h.globalData.appConfig.currency.symbol:"￥"}${h.userInfo.bonus||0}）`:`（余额不足，可用余额${h.globalData.appConfig.currency?h.globalData.appConfig.currency.symbol:"￥"}${h.userInfo.bonus||0}）`),1)])),_:1},8,["style"])):r("",!0)])),_:2},1024)])),_:2},1024),"balance"==a.pay_code&&h.userInfo.money<o.payInfo.order_amount||"huoniao_bonus"==a.pay_code&&h.userInfo.bonus<o.payInfo.order_amount?(t(),n(I,{key:0,class:"recharge",onClick:e=>C.linkTo(`${h.globalData.appConfig.cfg_user_index}/${"balance"==a.pay_code?"deposit":"recharge"}.html?paytype=deposit`)},{default:s((()=>[i(" 充值 ")])),_:2},1032,["onClick"])):(t(),n(I,{key:1,class:m("selectDot"+(h.activeIndex==e?" active":""))},null,8,["class"]))])),_:2},1032,["onClick"])))),128))])),_:1}),l(I,{class:"payNow"},{default:s((()=>[l(I,{onClick:e[1]||(e[1]=a=>C.payFn(h.activeIndex))},{default:s((()=>[i("立即付款")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),b(l(I,{class:"closeWarn"},{default:s((()=>[l(I,{class:"cw-content"},{default:s((()=>[l(I,{class:"cwc-title"},{default:s((()=>[i("确定放弃本次付款？")])),_:1}),o.payInfo.timeout>0?(t(),n(I,{key:0,class:"cwc-time"},{default:s((()=>[i(" 您的订单在"+c(h.timeout)+"内未支付将被取消，请尽快完成支付 ",1)])),_:1})):r("",!0),l(I,{class:"cwc-btn"},{default:s((()=>[l(I,{class:"cancel",onClick:e[2]||(e[2]=a=>C.closeFn(!0))},{default:s((()=>[i("放弃")])),_:1}),l(I,{class:"continue",onClick:e[3]||(e[3]=a=>h.closeb=!1)},{default:s((()=>[i("继续支付")])),_:1})])),_:1})])),_:1})])),_:1},512),[[g,h.closeb]]),h.passwordb?(t(),n(I,{key:0,class:"passwordPop"},{default:s((()=>[l(I,{class:"codeAndkey"},{default:s((()=>[l(I,{class:"passwordInput",style:p(`transform: translateY(${h.passwordConb?0:"100%"});${1==h.userInfo.paypwdCheck?"min-height: 880rpx;":"min-height:1040rpx;"}`)},{default:s((()=>[l(x,{src:`${h.imgstatic}arr_back.png?v=${h.imgVersion}`,mode:"aspectFill",class:"cancelPay",onClick:C.closeCodeFn},null,8,["src","onClick"]),l(I,{class:"title"},{default:s((()=>[i("输入支付密码")])),_:1}),l(I,{class:"payInput"},{default:s((()=>[l(I,{class:"text"},{default:s((()=>[i("请"+c(1==h.userInfo.paypwdCheck?"输入":"设置")+"6位数字密码确认支付",1)])),_:1}),l(I,{class:"password"},{default:s((()=>[(t(),d(u,null,f(6,(a=>l(I,{key:a,class:m(a<=h.password.length?"active":"")},{default:s((()=>[l($,null,{default:s((()=>[i("•")])),_:1})])),_:2},1032,["class"]))),64))])),_:1}),1!=h.userInfo.paypwdCheck?(t(),n(I,{key:0,class:"setCode"},{default:s((()=>[l(I,null,{default:s((()=>[i("·避免使用连续或重复数字，类似“123456”“112233”")])),_:1}),l(I,null,{default:s((()=>[i("·避免使用手机号、证件号中的连续数字")])),_:1})])),_:1})):r("",!0),1==h.userInfo.paypwdCheck?(t(),n(I,{key:1,class:"forgetCode",onClick:e[4]||(e[4]=a=>C.linkTo(`${h.globalData.appConfig.cfg_user_index}/security-paypwdEdit.html?step=2&title=修改支付密码`))},{default:s((()=>[i("忘记密码?")])),_:1})):r("",!0)])),_:1}),1!=h.userInfo.paypwdCheck?(t(),d("div",{key:0,class:"confirmPay",onClick:e[5]||(e[5]=(...a)=>C.setAndPayFn&&C.setAndPayFn(...a))},"确定并支付")):r("",!0)])),_:1},8,["style"]),l(I,{class:"keyboard",style:p(`transform: translateY(${h.passwordConb?0:"100%"});`)},{default:s((()=>[l(I,null,{default:s((()=>[l($,{onClick:e[6]||(e[6]=a=>C.inputCodeFn(1))},{default:s((()=>[i("1")])),_:1}),l($,{onClick:e[7]||(e[7]=a=>C.inputCodeFn(2))},{default:s((()=>[i("2")])),_:1}),l($,{onClick:e[8]||(e[8]=a=>C.inputCodeFn(3))},{default:s((()=>[i("3")])),_:1}),l($,{onClick:e[9]||(e[9]=a=>C.inputCodeFn(4))},{default:s((()=>[i("4")])),_:1}),l($,{onClick:e[10]||(e[10]=a=>C.inputCodeFn(5))},{default:s((()=>[i("5")])),_:1}),l($,{onClick:e[11]||(e[11]=a=>C.inputCodeFn(6))},{default:s((()=>[i("6")])),_:1}),l($,{onClick:e[12]||(e[12]=a=>C.inputCodeFn(7))},{default:s((()=>[i("7")])),_:1}),l($,{onClick:e[13]||(e[13]=a=>C.inputCodeFn(8))},{default:s((()=>[i("8")])),_:1}),l($,{onClick:e[14]||(e[14]=a=>C.inputCodeFn(9))},{default:s((()=>[i("9")])),_:1}),l($,{class:"none"}),l($,{onClick:e[15]||(e[15]=a=>C.inputCodeFn(0))},{default:s((()=>[i("0")])),_:1}),l($,{class:"backSpace",style:p(`background: url(${h.imgstatic}del_num.png) no-repeat 50%/60rpx;`),onClick:e[16]||(e[16]=a=>h.password=h.password.slice(0,-1))},null,8,["style"])])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})):r("",!0)])),_:1})):r("",!0)}],["__scopeId","data-v-a334afe7"]]),V={web:{development:{payreturn:"/pages/payreturn/index"},production:{payreturn:"/payreturn"}},mini:{payreturn:"/pages/payreturn/index"}};var U,B=_();const R=v({name:"sponsor",props:{service:{type:String,default:""},popb:{type:Boolean,default:!1},aid:{type:[Number,String],default:0},sponsorMoney:{type:Array,default:[6.6,8.8,68]},sponsorMax:{type:Number,default:2e3},successFn:{type:Function,default:a=>1}},data:()=>({globalData:B.globalData,sponsorAmount:0,preAmount:0,appConfig:"",selfSponsorb:!1,sponsorFocusb:!1,sponsorSuccessb:!1,popconb:!1,imgVersion:B.globalData.imgVersion,imgurl:B.globalData.imgPath+"/article/",paypopb:!1,payInfo:{},pages:{},platForm:B.globalData.platForm,paddTop:"0rpx"}),mounted(){U=this,B.globalData.appConfig?U.appConfig=B.globalData.appConfig:B.watchG("appConfig",(function(a){U.appConfig=a})),"web"==U.platForm?U.paddTop="20rpx":"mp-toutiao"==U.platForm?U.paddTop="14rpx":U.paddTop="10rpx",U.pages=B.pageFn(V)},methods:{linkTo(e){e&&("web"==this.platForm?e.indexOf("http")>-1||window.appBoolean?location.href=e:a({url:e}):a({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e}))},sponsorFn(a){if("web"!=U.platForm&&!B.loginCheck())return!1;a?(U.sponsorAmount=a,U.selfSponsorb=!1,U.sponsorFocusb=!1,U.submitSponsorFn()):(U.sponsorAmount=1,U.selfSponsorb=!0,U.sponsorFocusb=!0)},selfCheckFn(a){let e=a.detail.value;if(/^(\d*|\d*[.]|\d*[.]\d{1,2})$/.test(e)||""==e)if(e>U.sponsorMax){let a;a=setTimeout((e=>{clearTimeout(a),U.sponsorAmount=U.sponsorMax}),100),U.preAmount=U.sponsorMax}else U.preAmount=e;else{let a;a=setTimeout((e=>{clearTimeout(a),U.sponsorAmount=U.preAmount}),100)}},submitSponsorFn(){let a={service:U.service,action:"reward",aid:U.aid,amount:U.sponsorAmount};U.$ajax.post({url:B.encodeUrl("include/ajax.php?"),data:a}).then((a=>{100==a.data.state?"web"==B.globalData.platForm&&window.Android&&window.appBoolean?window.setupWebViewJavascriptBridge((function(e){e.callHandler("cashier",{service:U.service,module:U.service,type:"",orderinfo:a.data.info,ordertype:"action=pay"},(function(a){"ok"==a?e.callHandler("pageReload",{},(function(a){})):"end_countdown"==a&&alert("支付超时！")}))})):(U.payInfo=a.data.info,U.paypopb=!0):U.info=a.data.info}))},closeFn(){U.$emit("closeFn",!1)},paySuccess(a){if(2==U.successFn(U.payInfo))return e(),!1;function e(){U.closeFn(),U.sponsorAmount="",U.preAmount="",U.selfSponsorb=!1,U.sponsorFocusb=!1,U.sponsorSuccessb=!1,U.paypopb=!1}U.sponsorSuccessb=!0,setTimeout((a=>{e()}),3e3)},payError(a){e({title:a,icon:"none",success:a=>{setTimeout((a=>{o()}),3e3)}})}},watch:{popb(a,e){a?setTimeout((a=>{U.popconb=!0}),0):U.popconb=!1}}},[["render",function(a,e,o,y,b,g){const _=k,h=F,C=w,$=I,v=D(x("payBottom"),M);return t(),n(h,null,{default:s((()=>[o.popb?(t(),n(h,{key:0,class:"sponsorPop"},{default:s((()=>[l(h,{class:"sp-content",style:p(`transform:scale(${b.popconb?1:0})`)},{default:s((()=>[b.sponsorSuccessb?(t(),n(h,{key:1,class:"success"},{default:s((()=>[l(_,{src:`${b.imgurl}coin.png?v=${b.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(h,{class:"right"},{default:s((()=>[l(h,{class:"tip"},{default:s((()=>[i("打赏成功！")])),_:1}),l(h,{class:"text"},{default:s((()=>[i("感谢您的支持~")])),_:1})])),_:1})])),_:1})):(t(),d(u,{key:0},[l(h,{class:"content"},{default:s((()=>[l(_,{src:`${b.imgurl}sponsor_bgi.png?v=${b.imgVersion}`,mode:"aspectFit",class:"bgi_1"},null,8,["src"]),l(_,{src:`${b.imgurl}sponsor.png?v=${b.imgVersion}`,mode:"aspectFit",class:"bgi_2"},null,8,["src"]),l(h,{class:"title"},{default:s((()=>[l(h,null,{default:s((()=>[i("打赏支持")])),_:1}),l(C,null,{default:s((()=>[i("喜欢就打赏支持一下"+c("tieba"==o.service?"":"小编")+"吧",1)])),_:1})])),_:1}),l(h,{class:"sponsor"},{default:s((()=>[l(h,{class:"text"},{default:s((()=>[l(C,{class:"left"},{default:s((()=>[i("打赏金额")])),_:1}),l(h,{class:"right"},{default:s((()=>[b.selfSponsorb?(t(),n(C,{key:0},{default:s((()=>[i(c(b.sponsorAmount<o.sponsorMax?"请输入你想打赏的金额，":`最多打赏${o.sponsorMax}${b.globalData.appConfig.currency?b.globalData.appConfig.currency.short:"元"}哦，`),1)])),_:1})):r("",!0),l(C,{class:"tip",onClick:e[0]||(e[0]=a=>g.linkTo(b.appConfig.protocol["打赏须知"]))},{default:s((()=>[i("打赏须知")])),_:1})])),_:1})])),_:1}),l(h,{class:"list"},{default:s((()=>[(t(!0),d(u,null,f(o.sponsorMoney.slice(0,3),((a,e)=>(t(),n(h,{class:m(["item",{active:a==b.sponsorAmount&&!b.selfSponsorb}]),key:e,onClick:e=>g.sponsorFn(a)},{default:s((()=>[l(h,{class:"txt"},{default:s((()=>[i("打赏")])),_:1}),l(h,{class:"money"},{default:s((()=>[l(C,null,{default:s((()=>[i(c(b.globalData.appConfig.currency?b.globalData.appConfig.currency.symbol:"￥"),1)])),_:1}),i(c(a),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),b.selfSponsorb?(t(),n(h,{key:1,class:"item active"},{default:s((()=>[l(h,{class:"money",style:{display:"flex"}},{default:s((()=>[l(C,{style:p(`padding-top:${b.paddTop};`)},{default:s((()=>[i(c(b.globalData.appConfig.currency?b.globalData.appConfig.currency.symbol:"￥"),1)])),_:1},8,["style"]),l($,{type:"digit",style:{"font-size":"44rpx"},modelValue:b.sponsorAmount,"onUpdate:modelValue":e[2]||(e[2]=a=>b.sponsorAmount=a),onInput:g.selfCheckFn,focus:b.sponsorFocusb,onConfirm:g.submitSponsorFn},null,8,["modelValue","onInput","focus","onConfirm"])])),_:1})])),_:1})):(t(),n(h,{key:0,class:"item",onClick:e[1]||(e[1]=a=>g.sponsorFn())},{default:s((()=>[l(h,{class:"txt"},{default:s((()=>[i("打赏")])),_:1}),l(h,{class:"money"},{default:s((()=>[l(C,null,{default:s((()=>[i("其他金额")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1}),l(h,{class:"close",onClick:g.closeFn},{default:s((()=>[l(_,{src:`${b.imgurl}sponsor_close.png?v=${b.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"])],64))])),_:1},8,["style"])])),_:1})):r("",!0),l(v,{service:o.service,action:"pay",payInfo:b.payInfo,paypopb:b.paypopb,loginCheck:!1,apply:"sponsor",onPaypopb:e[3]||(e[3]=a=>b.paypopb=!1),onPayError:g.payError,onPaySuccess:g.paySuccess},null,8,["service","payInfo","paypopb","onPayError","onPaySuccess"])])),_:1})}],["__scopeId","data-v-b4872716"]]);var E,O,q=_();const W=v({name:"complain",props:{showPop:{type:Boolean,default:!1},complainList:{type:Array,default:["理由1","理由2"]},infoDetail:{type:Object,default:{service:"member",template:"complain",module:"article",dopost:"detail",aid:-1}}},components:{popWarn:T},data:()=>({imgPath:q.globalData.imgStaticPath,imgVersion:q.globalData.imgVersion,phoneArea:[],activeIndex:0,phone:"",description:"",areaCode:86,complainb:!1,complainConb:!1,phoneb:!1,phoneConb:!1,warningb:!1,info:"",ajaxb:!1}),mounted(){E=this},methods:{warnFn(a=2e3){E.warningb=!0,clearTimeout(O),O=setTimeout((a=>{E.warningb=!1}),a)},popFn(a){a?(E.complainb=!0,setTimeout((a=>{E.complainConb=!0}),0)):(E.complainConb=!1,setTimeout((a=>{E.complainb=!1}),220),E.$emit("hideFn",!1))},secPopFn(a){a?(E.phoneb=!0,setTimeout((a=>{E.phoneConb=!0}),0)):(E.phoneConb=!1,setTimeout((a=>{E.phoneb=!1}),220))},phoneAreaData(){if(0==E.phoneArea.length){let a={service:"siteConfig",action:"internationalPhoneSection"};E.$ajax.post({url:"include/ajax.php?",data:a}).then((a=>{100==a.data.state&&(E.phoneArea=a.data.info)}))}},submitFn(){let a=E.infoDetail;if(a.areaCode=E.areaCode,a.type=E.complainList[E.activeIndex],a.desc=E.description,a.phone=E.phone,"86"==E.areaCode){/^[1-9]\d{10}$/.test(E.phone)?E.ajaxb||(E.ajaxb=!0,E.$ajax.post({url:q.encodeUrl("include/ajax.php?"),data:a}).then((a=>{100==a.data.state&&setTimeout((a=>{E.popFn(0)}),2200),E.info=a.data.info,E.ajaxb=!1}))):E.info="请检查手机号格式"}else""==E.phone?E.info="手机号不能为空":E.ajaxb||(E.ajaxb=!0,E.$ajax.post({url:q.encodeUrl("include/ajax.php?"),data:a}).then((a=>{100==a.data.state&&setTimeout((a=>{E.popFn(0)}),2200),E.info=a.data.info,E.ajaxb=!1})))}},watch:{info(a,e){""!=a&&(E.warnFn(),setTimeout((a=>{E.info=""}),2200))},showPop(a,e){a&&E.popFn(1)}}},[["render",function(a,e,o,b,g,_){const h=w,C=k,v=F,P=I,j=$,S=D(x("popWarn"),T);return g.complainb?(t(),n(v,{key:0,class:"complain",onClick:e[9]||(e[9]=a=>_.popFn(0))},{default:s((()=>[l(v,{class:"c-content",style:p(`transform:translateY(${g.complainConb?"0%":"100%"})`),onClick:e[4]||(e[4]=y((()=>{}),["stop"]))},{default:s((()=>[l(v,{class:"cc-title"},{default:s((()=>[l(h,null,{default:s((()=>[i("举报内容")])),_:1}),l(C,{src:`${g.imgPath}/close_2.png?v=${g.imgVersion}`,mode:"aspectFit",onClick:e[0]||(e[0]=a=>_.popFn(0))},null,8,["src"])])),_:1}),l(v,{class:"cc-list"},{default:s((()=>[l(v,{class:"title"},{default:s((()=>[i("选择举报理由")])),_:1}),l(v,{class:"list"},{default:s((()=>[(t(!0),d(u,null,f(o.complainList,((a,e)=>(t(),n(v,{class:m(["item",{active:g.activeIndex==e}]),key:e,onClick:a=>g.activeIndex=e},{default:s((()=>[i(c(a),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),l(v,{class:"cc-phone"},{default:s((()=>[l(v,{class:"title"},{default:s((()=>[i("联系方式")])),_:1}),l(v,{class:"phone"},{default:s((()=>[l(v,{class:"select",onClick:e[1]||(e[1]=a=>_.secPopFn(1))},{default:s((()=>[l(h,null,{default:s((()=>[i("+"+c(g.areaCode),1)])),_:1}),l(C,{src:`${g.imgPath}/d_arr.png?v=${g.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1}),l(P,{type:"tel",placeholder:"输入手机号","placeholder-style":"opacity:.3;font-wei:500",modelValue:g.phone,"onUpdate:modelValue":e[2]||(e[2]=a=>g.phone=a)},null,8,["modelValue"])])),_:1})])),_:1}),l(v,{class:"cc-description"},{default:s((()=>[l(v,{class:"title"},{default:s((()=>[i("举报描述")])),_:1}),l(v,{class:"input"},{default:s((()=>[l(j,{placeholder:"可简述理由，以便快速处理举报","placeholder-style":"opacity:.3",maxlength:"100","auto-height":"",modelValue:g.description,"onUpdate:modelValue":e[3]||(e[3]=a=>g.description=a)},null,8,["modelValue"]),l(v,{class:"number"},{default:s((()=>[i(c(g.description.length)+"/100",1)])),_:1})])),_:1})])),_:1}),l(v,{class:"cc-btn",style:p("background:"+(g.phone?"linear-gradient(-90deg, #F6252F 0%, #FF4621 100%);":"#FFBABA")),onClick:_.submitFn},{default:s((()=>[i("提交")])),_:1},8,["style","onClick"])])),_:1},8,["style"]),g.phoneb?(t(),n(v,{key:0,class:"c-pop",onClick:e[7]||(e[7]=y((a=>_.secPopFn(0)),["stop"]))},{default:s((()=>[l(v,{class:"cp-content",style:p(`transform:translateY(${g.phoneConb?"0%":"100%"})`),onClick:e[6]||(e[6]=y((()=>{}),["stop"]))},{default:s((()=>[l(v,{class:"title"},{default:s((()=>[l(v,{class:"back",onClick:e[5]||(e[5]=a=>_.secPopFn(0))},{default:s((()=>[i("返回")])),_:1}),l(h,null,{default:s((()=>[i("选择地区")])),_:1})])),_:1}),l(v,{class:"list"},{default:s((()=>[(t(!0),d(u,null,f(g.phoneArea,((a,e)=>(t(),n(v,{class:"item",key:e,onClick:e=>{g.areaCode=a.code,_.secPopFn(0)}},{default:s((()=>[l(v,{class:"area"},{default:s((()=>[i(c(a.name),1)])),_:2},1024),l(v,{class:"num"},{default:s((()=>[i("+"+c(a.code),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["style"])])),_:1})):r("",!0),l(S,{info:g.info,warningb:g.warningb,onClick:e[8]||(e[8]=y((()=>{}),["stop"]))},null,8,["info","warningb"])])),_:1})):r("",!0)}],["__scopeId","data-v-ff8601ed"]]);export{R as _,W as a};
