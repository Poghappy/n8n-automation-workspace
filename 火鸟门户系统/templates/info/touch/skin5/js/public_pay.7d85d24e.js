import{o as e,i as a,w as t,l as o,G as n,y as l,F as s,z as i,m as c,q as r,t as d,v as p,k as u,b as g,$ as m,W as h,d as f,a0 as y,r as k,a1 as b,a as _,N as w,g as v,x as C,j as P,E as x,B as I,C as D,a2 as B,a3 as T,a4 as F,a5 as S,f as N,c as V,M,H as $,S as j,a6 as A,a7 as R,a8 as O,A as U,J as H,u as L,a9 as z,n as G,e as J,h as W,X as E,Y as q,I as K}from"./index-6ef16ca3.js";import{_ as Z,r as Q}from"./info.3393217b.js";var X;const Y=Z({props:{model:{type:Boolean,default:!1},confirmBtn:{type:Object,default:{text:"确定",style:"border-right:0rpx;border-radius:0rpx 0rpx 10rpx 0rpx"}},cancelBtn:{type:Object,default:{text:"取消",style:"border-radius:0rpx 0rpx 0rpx 10rpx"}},content:{type:Array,default:[{text:"弹窗",style:""}]},getCancelFn:{type:Function,default:e=>{}},getConfirmFn:{type:Function,default:e=>{}}},mounted(){X=this},methods:{confirmFn(){X.$emit("models",!1),this.getConfirmFn()},cancelFn(){X.$emit("models",!1),this.getCancelFn()}}},[["render",function(g,m,h,f,y,k){const b=u;return h.model?(e(),a(b,{key:0,class:"shellModel",onClick:k.cancelFn},{default:t((()=>[o(b,{class:"dialog",onClick:m[0]||(m[0]=n((()=>{}),["stop"]))},{default:t((()=>[o(b,{class:"content"},{default:t((()=>[(e(!0),l(s,null,i(h.content,((o,n)=>(e(),a(b,{class:"text",key:n,style:c(o.style)},{default:t((()=>[r(d(o.text),1)])),_:2},1032,["style"])))),128))])),_:1}),o(b,{class:"btn"},{default:t((()=>[o(b,{class:"confirm btn_a",style:c(h.cancelBtn.style),onClick:k.cancelFn},{default:t((()=>[r(d(h.cancelBtn.text),1)])),_:1},8,["style","onClick"]),o(b,{class:"cancel btn_a",style:c(h.confirmBtn.style),onClick:k.confirmFn},{default:t((()=>[r(d(h.confirmBtn.text),1)])),_:1},8,["style","onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):p("",!0)}],["__scopeId","data-v-4a96cb29"]]);var ee;const ae=P();const te=Z({emits:["totop"],components:{showModel:Y},data:()=>({model:!1,conArr:[{text:"检测到你目前的城市为",style:""},{text:"苏州",style:"font-size:50rpx;color:#ff6600;font-weight:bold;padding:10rpx 0rpx"},{text:"是否切换",style:""}],modelConfirm:function(){console.log("确定")},modelCancel:function(){g({key:"manualChange",data:1})},bottomNavArr:[],msgNum:0,userid:ae.globalData.userid,grayscale:"1"==ae.globalData.appConfig.sitePageGray||"2"==ae.globalData.appConfig.sitePageGray?"grayscale":"",platForm:ae.globalData.platForm,timerBottom:null,activeIndex:0}),props:{module:{type:String,default:"info"},active:{type:String,default:"0"},needMessage:{type:Boolean,default:!1},total:{type:Number,default:0},pageHide:{type:Boolean,default:!1},needCity:{type:Boolean,default:!0},activeColor:{type:String,default:""}},methods:{linkTo(e,a){if(e){if(ee.appBoolean)return window.setupWebViewJavascriptBridge((function(a){a.callHandler("redirectNative",{name:"",code:"",link:e},(function(){}))})),!1;"web"==ee.platForm?e.indexOf("http")>-1?location.href=e:h({url:e}):e.includes("/packages")&&!e.includes("/index/index")?m({url:e}):a?m({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e}):h({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e})}},handlePageShow:function(){var e=ae.globalData.userid;ee.grayscale="1"==ae.globalData.appConfig.sitePageGray||"2"==ae.globalData.appConfig.sitePageGray?"grayscale":"";var a=ee.module;ee.getModule(a),null!=e&&"undefined"!=e&&e&&(ee.getMessage(),ee.needMessage&&(ee.timerBottom=setInterval((function(){ee.getMessage()}),5e3),ee.pageShowCheck(5)))},getModule(e){var a="service=siteConfig&action=touchHomePageFooter&version=2.0&module="+e,t=ae.encodeUrl(a);ee.$ajax.post({url:"include/ajax.php?"+(t||a)}).then((e=>{var a=e.data;if(100==a.state){for(var t=a.info,o=[],n=0;n<t.length;n++)t[n].url=ae.addUrlParam(t[n].url,"forcelogout"),o.push(t[n]);ee.bottomNavArr=o,ee.activeIndex>=o.length&&(ee.activeIndex=o.length-1)}}))},getMessage(){var e=ae.encodeUrl("service=member&action=message&type=tongji&im=1");ee.$ajax.post({url:"include/ajax.php?"+e}).then((e=>{var a=e.data;100==a.state?ee.msgNum=a.info.pageInfo.total>99?"99+":a.info.pageInfo.total:"用户信息验证失败"==a.info&&(ee.msgNum=0,setTimeout((function(){f("access_token")?b.unit(f("refresh_token"),ae.globalData.masterDomain,(function(e){if(100==e.state){console.log("更新成功");var a=e.info.access_token,t=e.info.refresh_token;g({key:"access_token",data:a}),g({key:"refresh_token",data:t});var o=Date.parse(new Date)/1e3+7200-20;g({key:"token_expired",data:o}),ae.globalData.access_token=a,ae.globalData.refresh_token=t,ae.globalData.token_expired=o}else{k({key:"userid"}),k({key:"access_token"}),k({key:"refresh_token"}),k({key:"token_expired"}),ae.globalData.userid=null,ae.globalData.access_token=null,ae.globalData.refresh_token=null,ae.globalData.token_expired=null;var n=encodeURIComponent(ae.globalData.masterDomain+"/logout.html?redirect="+ae.globalData.masterDomain+"/login.html");h({url:"/pages/redirect/index?url="+encodeURIComponent(n),success:e=>{console.log("跳转")}})}})):(y({title:"账号状态异常，请重新登录！",icon:"none",duration:2e3}),k({key:"userid"}),k({key:"access_token"}),k({key:"refresh_token"}),k({key:"token_expired"}),ae.globalData.userid=null,ae.globalData.access_token=null,ae.globalData.refresh_token=null,ae.globalData.token_expired=null,ae.tologin("/pages/goback"))}),1e3))}))},goLink(e,a){var t=e.currentTarget.dataset.url,o=e.currentTarget.dataset.type,n=e.currentTarget.dataset.module;if(""==t)return"siteConfig"==ee.module&&"0"==ee.active&&ee.$emit("totop"),!1;if("mp-weixin"!=ee.platForm&&"mp-toutiao"!=ee.platForm||(a=t.indexOf("/message/")<=-1&&t.indexOf("/pages/member/index/index/")<=-1&&"siteConfig"==n),"2"==o||t.indexOf("/message/")>-1||t.indexOf("fabuJoin_touch_popup")>-1){let e=ae.globalData.userid;e?null==e||""==e?ae.loginCheck(t):ee.linkTo(t,a):ae.loginCheck(t)}else ee.linkTo(t,a)},cityChange(){if("waimai"==this.module||!this.needCity)return!1;let e;e=f("cityInfo"),e=e&&"string"==typeof e?JSON.parse(e):e,ae.globalData.locationFn({type:"gcj02",success:a=>{ae.getCityInfo(a.longitude||a.lng,a.latitude||a.lat,"gcj02ll",(function(a){var t=`service=siteConfig&action=verifyCity&region=${a.province}&city=${a.city}&town=${a.town}&district=${a.district}`,o=ae.encodeUrl(t);ee.$ajax.post({url:"include/ajax.php?"+o}).then((a=>{100==a.data.state&&(e?e.cityid!=a.data.info.cityid&&ae.globalData.appConfig&&ae.globalData.appConfig.site_city_auto_location&&(ee.model=!0):(ee.conArr[1].text="城市信息获取失败，是否切换到",console.log("跳转城市选择")),ee.conArr[1].text=a.data.info.name,ee.modelConfirm=function(){if(_("cityInfo",a.data.info),ee.model=!1,console.log("重新加载"),"web"==w().uniPlatform)if(window.appBoolean)window.setupWebViewJavascriptBridge((function(e){e.callHandler("changeCity",JSON.stringify(a.data.info),(function(){location.href=a.data.info.url+"?currentPageOpen=1&appIndex=1&appFullScreen"}))}));else{let e=window.masterDomains?window.masterDomains.replace("http://","").replace("https://",""):window.location.host,t=e.split("."),o=e.replace(t[0]+".","");e.split("/")[0],o=o.split("/")[0],window.$.cookie("HN_siteCityInfo",JSON.stringify(a.data.info),{expires:7,domain:e,path:"/"}),window.$.cookie("HN_siteCityInfo",JSON.stringify(a.data.info),{expires:7,domain:o,path:"/"}),location.href=a.data.info.url+"?currentPageOpen=1"}else ae.reloadFn()})}))}))}})},pageChangeVisible(e){e?this.needMessage&&Boolean(ae.globalData.userid)&&(clearInterval(this.timerBottom),this.getMessage(),this.timerBottom=setInterval((e=>{this.getMessage(),console.log("前台重置")}),5e3),this.pageShowCheck(5)):clearInterval(this.timerBottom)},pageShowCheck(e){const a=this;let t=e,o=5;switch(e){case 5:t=10,o=10;break;case 10:t=20,o=20;break;case 20:t=30,o=30;break;case 30:t=60,o=60;break;case 60:t=0,o=0}setTimeout((()=>{clearInterval(a.timerBottom),e&&o&&(a.timerBottom=setInterval(this.getMessage,1e3*o)),t&&a.pageShowCheck(t)}),60*e*1e3)}},mounted(){ee=this,this.handlePageShow(),v({key:"manualChange",fail:e=>{this.cityChange()}}),ee.activeIndex=ee.active},unmounted(){clearInterval(ee.timerBottom)},watch:{pageHide(e,a){e?clearInterval(ee.timerBottom):Boolean(ae.globalData.userid)&&(clearInterval(ee.timerBottom),ee.timerBottom=setInterval((e=>{this.getMessage()}),5e3))},total(e,a){0==e&&(this.msgNum=0)}}},[["render",function(n,g,m,h,f,y){const k=I,b=u,_=D,w=x("show-model");return f.bottomNavArr.length?(e(),a(b,{key:0,class:C("bottomBox "+f.grayscale)},{default:t((()=>[(e(!0),l(s,null,i(f.bottomNavArr,((n,l)=>(e(),a(b,{class:C("li ficon "+(n.fabu?"fabu":"")),"data-module":m.module,"data-url":f.activeIndex!=l?"web"==f.platForm?n.url:n.miniPath||n.url:"",onClick:e=>y.goLink(e,Boolean(n.fabu)||n.url.includes("currentPageOpen")),"data-type":1,key:l},{default:t((()=>[o(k,{src:f.activeIndex==l||"message"==f.activeIndex&&n.message?n.icon_h:n.icon,class:"image"},null,8,["src"]),!n.message||0==f.msgNum&&0==m.total?p("",!0):(e(),a(b,{key:0,class:"msg"},{default:t((()=>[r(d(m.total||f.msgNum),1)])),_:1})),n.fabu?p("",!0):(e(),a(_,{key:1,class:"text",style:c(f.activeIndex==l&&m.activeColor?"color:"+m.activeColor+";":"")},{default:t((()=>[r(d(n.name),1)])),_:2},1032,["style"]))])),_:2},1032,["class","data-module","data-url","onClick"])))),128)),o(w,{onModels:g[0]||(g[0]=e=>f.model=!1),model:f.model,content:f.conArr,getConfirmFn:f.modelConfirm,getCancelFn:f.modelCancel},null,8,["model","content","getConfirmFn","getCancelFn"])])),_:1},8,["class"])):p("",!0)}],["__scopeId","data-v-83e159c0"]]),oe=P();const ne=Z({components:{bottomNav:te},data:()=>({globalData:oe.globalData,navTop:oe.globalData.navTop,menuTop:0,navLeft:0,offTop:0,imgVersion:oe.globalData.imgVersion,imgPath:oe.globalData.imgPath,headMenuShow:!1,msgNum:0,cityurl:"/pages/redirect/index?url="+oe.globalData.masterDomain+"/changecity.htmlhuoniaowhcurrentPageOpenhuoniaodh1huoniaoljbackModulehuoniaodhinfohuoniaoljfromOriginalhuoniaodh1",grayscale:"1"==oe.globalData.appConfig.sitePageGray||"2"==oe.globalData.appConfig.sitePageGray?"grayscale":"",lng:"",lat:"",cityNum:"",navList:[],msgNumClone:0,cityInfoClone:{name:""},homeBackClone:!1,showClone:!1,navWidth:0,platForm:oe.globalData.platForm,click_disabled:!1,timerHead:null}),props:{ifIndex:{type:Boolean,default:!1},headerTitle:{type:String,default:"分类信息"},headerBgImg:{type:Boolean,default:!1},headerBgOpacity:{type:String,default:"1"},headerBg:{type:String,default:"#fff"},headerBack:{type:Boolean,default:!0},homeBack:{type:Boolean,default:!1},pullend:{type:Boolean,default:!1},backOnly:{type:Boolean,default:!1},noBorder:{type:Boolean,default:!1},module:{type:String,default:"info"},activeIndex:{type:Number,default:0},showBottom:{type:Boolean,default:!1},cityInfo:{type:Object,default:{name:oe.globalData.cityInfo.name?oe.globalData.cityInfo.name:"加载中",cityid:oe.globalData.cityInfo.cityid}},posiInfo:{type:Object,default:{address:"定位中"}},scanIcon:{type:Boolean,default:!1},temp:{type:String,default:" "},searchInp:{type:Boolean,default:!1},searchHot:{type:Array,default:[]},needMessage:{type:Boolean,default:!1},pageHide:{type:Boolean,default:!1},show:{type:Boolean,default:!1},rightGrow:{type:Boolean,default:!1},backDefine:{type:String,default:""}},mounted(){"mp-weixin"==oe.globalData.platForm?(this.wexin(),this.$nextTick((e=>{this.attached()}))):"mp-toutiao"==oe.globalData.platForm?this.toutiao():oe.globalData.platForm,this.handlePageShow()},unmounted(){clearInterval(this.timerHead)},methods:{pageChangeVisible(e){e?this.needMessage&&Boolean(oe.globalData.userid)&&(this.timerHead=setInterval((e=>{this.getMessage()}),5e3),this.pageShowCheck(5)):clearInterval(this.timerHead)},attached(){const e=this;B({success:a=>{if("windows"==a.platform)oe.globalData.biasTop_88=0,e.offTop=0;else if(0!=oe.globalData.biasTop_88){e.offTop=oe.globalData.biasTop_88;var t=uni.getMenuButtonBoundingClientRect();e.navWidth=t.width}else{t=uni.getMenuButtonBoundingClientRect();e.navWidth=t.width;const a=V().in(this);this.$nextTick((o=>{a.select(".head").boundingClientRect((a=>{e.offTop=-(a.height-t.height)/2-(e.navTop-e.menuTop),oe.globalData.biasTop_88=e.offTop})).exec()}))}}})},handlePageShow(){var e=this;if("web"!=e.platForm){let a=uni.getMenuButtonBoundingClientRect();e.menuTop=a.top}e.grayscale="1"==oe.globalData.appConfig.sitePageGray||"2"==oe.globalData.appConfig.sitePageGray?"grayscale":"",v({key:"cityInfo",success(a){console.log(typeof a.data),e.cityInfoClone="string"==typeof a.data?JSON.parse(a.data):a.data;try{var t=f("currlocation");t?(e.lng=t.split(",")[0],e.lat=t.split(",")[1]):e.getCurrLocation()}catch(o){console.log("CatchClause",o),console.log("CatchClause",o),e.getCurrLocation()}},fail(a){console.log(a);try{var t=f("currlocation");t?(e.lng=t.split(",")[0],e.lat=t.split(",")[1],oe.globalData.cityInfo={},oe.getCityInfo(t.split(",")[0],t.split(",")[1])):e.getCurrLocation()}catch(n){console.log("CatchClause",n),console.log("CatchClause",n),e.getCurrLocation()}var o=setInterval((function(){v({key:"cityInfo",success(a){e.cityInfoClone=a.data,clearInterval(o)}})}),1e3)}}),1==T().length&&(this.homeBackClone=!0);var a=setInterval((function(){oe.globalData.cityNum&&(e.cityNum=oe.globalData.cityNum,clearInterval(a))}),1e3),t=setInterval((function(){oe.globalData.appConfig&&oe.globalData.appConfig.cfg_user_index&&(e.navList=[{url:"/pages/index/index",title:"返回首页",icon:"home_icon.png",type:"3"},{url:oe.addUrlParam(oe.globalData.appConfig.cfg_user_index+"/message.html"),title:"消息",icon:"msg_icon.png",type:"2",msg:!0},{url:oe.addUrlParam(oe.globalData.appConfig.cfg_user_index),title:"个人中心",icon:"member_icon.png",type:"2"},{url:oe.addUrlParam(oe.globalData.appConfig.cfg_user_index+"/collection.html?module=info"),title:"我的收藏",icon:"star_icon.png",type:"2"},{url:oe.addUrlParam(oe.globalData.appConfig.cfg_user_index+"/history?module=info"),title:"我的足迹",icon:"clock_icon.png",type:"2"}],clearInterval(t))}),1e3);e.getMessage(),e.needMessage&&(console.log("测试1"),this.timerHead=setInterval((function(){e.getMessage()}),5e3)),Boolean(oe.globalData.userid)&&e.pageShowCheck(5)},wexin(){const e=uni.getMenuButtonBoundingClientRect();this.navLeft=e.left-10+"px",this.showClone=!0,this.platForm="mp-weixin"},toutiao(){this.navLeft="100%",this.platForm="mp-toutiao"},handlePageResize(e){},backIndex(){this.$emit("backIndex",{detail:{}})},homeBackFun(){F({url:"/pages/index/index"})},goback(){oe.backFn("/pages/index/index")},showMenu(e){this.headMenuShow=!0},hideMenu(e){this.headMenuShow=!1},goLink(e){var a=e.currentTarget,t=a.dataset.url;if(!t)return!1;1==a.dataset.type?m({url:oe.addUrlParam(t)}):2==a.dataset.type?m({url:"/pages/redirect/index?url="+t.replace("?","huoniaowh").replace(/&/g,"huoniaolj").replace(/=/g,"huoniaodh")}):3==a.dataset.type?F({url:oe.addUrlParam(t)}):F({url:"/pages/index/index"})},getMessage(){var e=this;if(f("access_token")){var a=oe.encodeUrl("service=member&action=message&type=tongji&im=1");this.$ajax.post({url:"include/ajax.php?"+a}).then((a=>{var t=a.data;100==t.state?e.msgNum=t.info.pageInfo.total>99?"99+":t.info.pageInfo.total:"用户信息验证失败"==t.info&&setTimeout((function(){f("access_token")?b.unit(f("refresh_token"),oe.globalData.masterDomain,(function(e){if(100==e.state){console.log("更新成功"),console.log(e.info);var a=e.info.access_token,t=e.info.refresh_token;g({key:"access_token",data:a}),g({key:"refresh_token",data:t});var o=Date.parse(new Date)/1e3+7200-20;g({key:"token_expired",data:o}),oe.globalData.access_token=a,oe.globalData.refresh_token=t,oe.globalData.token_expired=o}else{k({key:"userid"}),k({key:"access_token"}),k({key:"refresh_token"}),k({key:"token_expired"}),oe.globalData.userid=null,oe.globalData.access_token=null,oe.globalData.refresh_token=null,oe.globalData.token_expired=null;var n=encodeURIComponent(oe.globalData.masterDomain+"/logout.html?redirect="+oe.globalData.masterDomain+"/login.html");h({url:"/pages/redirect/index?url="+encodeURIComponent(n),success:e=>{console.log("跳转")}})}})):(y({title:"账号状态异常，请重新登录！",icon:"none",duration:2e3}),k({key:"userid"}),k({key:"access_token"}),k({key:"refresh_token"}),k({key:"token_expired"}),oe.globalData.userid=null,oe.globalData.access_token=null,oe.globalData.refresh_token=null,oe.globalData.token_expired=null,oe.tologin("/pages/goback"))}),1e3)}))}else e.msgNum=0},getCurrLocation(){var e=this;oe.globalData.locationFn({type:"web"==e.platForm?"wgs84":"gcj02",success(a){const t=a.latitude||a.lat,o=a.longitude||a.lng;e.lng=a.longitude||a.lng,e.lat=a.latitude||a.lat,oe.globalData.lnglat=t+","+o,g({key:"currlocation",data:o+","+t}),oe.globalData.cityInfo={},oe.getCityInfo(o,t)},fail(a){console.log(e.platForm,666);try{var t=f("cityInfo");t?oe.globalData.cityInfo=t:oe.getdefaultCity()}catch(o){console.log("CatchClause",o),console.log("CatchClause",o),oe.getdefaultCity()}}})},scanQr(){S({success(e){var a=e.result;/^((http|https):\/\/)?(([A-Za-z0-9]+-[A-Za-z0-9]+|[A-Za-z0-9]+)\.)+([A-Za-z]+)[/\?\:]?.*$/.test(a)?m({url:"/pages/redirect/index?url="+a.replace("?","huoniaowh").replace(/&/g,"huoniaolj").replace(/=/g,"huoniaodh")}):"EAN_13"==e.scanType?m({url:"/pages/redirect/index?url="+encodeURIComponent(oe.globalData.masterDomain+"/include/ajax.php?service=shop&action=barcodeSearch&type=redirect&code="+a)}):N({title:"扫码结果",content:e.result,showCancel:!1})}})},toSearchPage(e){if(a=e.currentTarget.dataset.url)this.goLink(e);else{var a=oe.globalData.masterDomain,t=0,o=f("cityInfo");o&&(t=o.cityid),m({url:"/pages/redirect/index?url="+encodeURIComponent(a+"/siteSearch.html?cityid="+t)})}},catchTouchMove(){console.log("占位：函数 catchTouchMove 未声明")},gobackFn(){const e=this;if(e.click_disabled)return!1;e.click_disabled=!0;let a=T();if(e.$nextTick((()=>{e.click_disabled=!1})),"web"==oe.globalData.platForm){document.body.style.overflow="",document.removeEventListener("touchmove",(function(e){e.preventDefault()}),!1)}if("web"==oe.globalData.platForm&&oe.globalData.webMini)return jWeixin.miniProgram.navigateBack(),!1;"web"!=oe.globalData.platForm||oe.globalData.appBoolean||a&&a.length>1?oe.backFn(this.module?`/pages/packages/${this.module}/index/index`:"/pages/index/index",oe.globalData.masterDomain):window.history.go(-1)},pageShowCheck(e){const a=this;let t=e,o=5;switch(e){case 5:t=10,o=10;break;case 10:t=20,o=20;break;case 20:t=30,o=30;break;case 30:t=60,o=60;break;case 60:t=0,o=0}setTimeout((()=>{clearInterval(a.timerHead),e&&o&&(a.timerHead=setInterval(this.getMessage,1e3*o)),t&&a.pageShowCheck(t)}),60*e*1e3)}},watch:{cityInfo:{handler(e,a){this.cityInfoClone=e},immediate:!0},homeBack:{handler(e,a){this.homeBackClone=e},immediate:!0},pageHide(e,a){e?clearInterval(this.timerHead):Boolean(oe.globalData.userid)&&(this.timerHead=setInterval((e=>{this.getMessage()}),5e3))}}},[["render",function(g,m,h,f,y,k){const b=I,_=u,w=D,v=$,P=j,B=x("bottom-nav");return h.show||y.showClone?(e(),a(_,{key:0,style:c(`height: calc(${y.navTop||0}px + 88rpx)`)},{default:t((()=>[o(_,{class:C("headTop "+y.grayscale),style:c("padding-top:"+y.navTop+"px; background-color:"+h.headerBg+"; ")},{default:t((()=>[o(_,{class:"headBgBox headBg",style:c("padding-top:"+y.navTop+"px; opacity:"+(h.headerBgImg?1:0))},{default:t((()=>["siteConfig"!=h.module&&h.headerBgImg?(e(),a(b,{key:0,src:y.imgPath+"/"+h.module+"/bg_index.png?v="+y.imgVersion,mode:"widthFix",class:"headBgImg img"},null,8,["src"])):p("",!0)])),_:1},8,["style"]),o(_,{class:"head",style:c("margin-top:"+y.offTop+"px")},{default:t((()=>["siteConfig"==h.module?(e(),a(_,{key:0,class:"headCon",style:c(`width:${y.navLeft}`)},{default:t((()=>[y.cityNum>1?(e(),a(_,{key:0,class:"city index","data-url":"/pages/changeCity/index?module=siteConfig",onClick:k.goLink,"data-type":"1"},{default:t((()=>[o(w,null,{default:t((()=>[r(d(y.cityInfoClone.name),1)])),_:1}),o(b,{class:"arr",src:y.imgPath+"/info/arr_down.png?v="+y.imgVersion,mode:"widthFix"},null,8,["src"])])),_:1},8,["onClick"])):p("",!0),o(_,{class:"searchInp"},{default:t((()=>[o(_,{class:"searchIcon"},{default:t((()=>[o(b,{src:y.imgPath+"/skin1/search_icon.png?v="+y.imgVersion,mode:"aspectFit"},null,8,["src"])])),_:1}),o(_,{class:"swiperBox"},{default:t((()=>[o(P,{class:"searchSwipe search",interval:"2000",circular:!0,autoplay:h.searchHot.length>0,vertical:!0},{default:t((()=>[h.searchHot.length>0?(e(!0),l(s,{key:0},i(h.searchHot,((l,s)=>(e(),a(v,{key:s,"data-keys":l.oldkeyword,onTouchmove:n(k.catchTouchMove,["stop","prevent"]),onClick:k.toSearchPage,"data-url":"","data-type":"2"},{default:t((()=>[o(_,{class:"searchInp"},{default:t((()=>[r(d(l.oldkeyword),1)])),_:2},1024)])),_:2},1032,["data-keys","onTouchmove","onClick"])))),128)):p("",!0),0==h.searchHot.length?(e(),a(v,{key:1,onClick:k.toSearchPage,"data-url":"",class:"swiperItem"},{default:t((()=>[o(_,{class:"searchInp"},{default:t((()=>[r("搜索")])),_:1})])),_:1},8,["onClick"])):p("",!0)])),_:1},8,["autoplay"])])),_:1})])),_:1}),o(_,{class:"scanIcon",onClick:k.scanQr},{default:t((()=>[o(b,{src:y.imgPath+"/skin1/scanIcon.png?v="+y.imgVersion,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"])])),_:1},8,["style"])):"waimai"!=h.module||h.backOnly?"job"==h.module?(e(),a(_,{key:2,class:"headerCon"},{default:t((()=>[o(_,{class:"leftCon",onClick:k.gobackFn},{default:t((()=>[h.ifIndex&&h.headerBack?p("",!0):(e(),a(_,{key:0,class:C("headBtns "+(!h.headerBack||h.backOnly?"circle":"")+" "+(h.noBorder?"noCircle":""))},{default:t((()=>[o(_,{class:"navBack navbtn"},{default:t((()=>[h.backDefine?(e(),a(b,{key:1,class:"navbtnImg img",src:h.backDefine,mode:"aspectFill"},null,8,["src"])):(e(),a(b,{key:0,class:"navbtnImg img",src:y.imgPath+"/info/navBack.png?v="+y.imgVersion,mode:"aspectFill"},null,8,["src"]))])),_:1})])),_:1},8,["class"])),o(_,{class:"headerTitle"},{default:t((()=>[M(g.$slots,"headTitle",{},void 0,!0)])),_:3})])),_:3},8,["onClick"]),o(_,{class:"rightBtns",style:c(h.rightGrow?"flex-grow:1;min-width:0;":"")},{default:t((()=>[M(g.$slots,"rightbtns",{},void 0,!0)])),_:3},8,["style"])])),_:3})):(e(),l(s,{key:3},[h.ifIndex&&h.headerBack?h.ifIndex&&y.cityNum>1?(e(),a(_,{key:1,class:"city","data-url":"/pages/changeCity/index?module="+h.module,onClick:k.goLink,"data-type":"3"},{default:t((()=>[o(w,null,{default:t((()=>[r(d(y.cityInfoClone.name),1)])),_:1}),o(b,{class:"arr img",src:y.imgPath+"/info/arr_down.png?v="+y.imgVersion,mode:"widthFix"},null,8,["src"])])),_:1},8,["data-url","onClick"])):p("",!0):(e(),a(_,{key:0,class:C("headBtns "+(!h.headerBack||h.backOnly?"circle":"")+" "+(h.noBorder?"noCircle":""))},{default:t((()=>[h.headerBack&&!y.homeBackClone?(e(),a(_,{key:0,class:"navBack navbtn",onClick:k.goback},{default:t((()=>[o(b,{class:"navbtnImg img",src:y.imgPath+"/info/navBack.png?v="+y.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"])):p("",!0),y.homeBackClone&&h.headerBack?(e(),a(_,{key:1,class:"navBack navbtn",onClick:k.homeBackFun},{default:t((()=>[o(b,{class:"navbtnImg img",src:y.imgPath+"/info/homepage.png?v="+y.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"])):p("",!0),h.headerBack?p("",!0):(e(),a(_,{key:2,class:"navBack navbtn",onClick:k.backIndex},{default:t((()=>[o(b,{class:"navbtnImg img",src:y.imgPath+"/info/navBack.png?v="+y.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"])),o(_,{class:"navLine"}),o(_,{class:"navMenu navbtn",onClick:k.showMenu},{default:t((()=>[o(b,{src:y.imgPath+"/info/menu_icon.png?v="+y.imgVersion,mode:"aspectFill",class:"navbtnImg"},null,8,["src"]),y.headMenuShow?(e(),a(_,{key:0,class:"bg_mask",onTouchstart:n(k.hideMenu,["stop","prevent"])},null,8,["onTouchstart"])):p("",!0),y.headMenuShow?(e(),a(_,{key:1,class:"navMenuBox"},{default:t((()=>[o(_,{class:"arr_top"},{default:t((()=>[o(b,{src:y.imgPath+"/info/arr_top.png?v="+y.imgVersion,mode:"aspectFill",class:"topImg"},null,8,["src"])])),_:1}),(e(!0),l(s,null,i(y.navList,((n,l)=>(e(),a(_,{key:l,class:"navMenuLi","data-url":n.url,onClick:k.goLink,"data-type":n.type},{default:t((()=>[o(b,{src:y.imgPath+"/info/"+n.icon+"?v="+y.imgVersion,mode:"aspectFill",class:"navImg"},null,8,["src"]),o(_,{class:"navText"},{default:t((()=>[r(d(n.title)+" ",1),n.msg&&y.msgNum>0?(e(),a(_,{key:0,class:"circle_txt"},{default:t((()=>[r(d(y.msgNum),1)])),_:1})):p("",!0)])),_:2},1024)])),_:2},1032,["data-url","onClick","data-type"])))),128))])),_:1})):p("",!0)])),_:1},8,["onClick"])])),_:1},8,["class"])),o(w,{class:"text"},{default:t((()=>[r(d(h.headerTitle),1)])),_:1})],64)):(e(),a(_,{key:1,class:"leftCon"},{default:t((()=>[o(_,{class:"backBtn",onClick:k.goback},{default:t((()=>[o(b,{class:"img",src:y.imgPath+"/waimai/header_back_index.png?v="+y.imgVersion},null,8,["src"])])),_:1},8,["onClick"]),o(w,{class:"text"},{default:t((()=>[r(d(h.headerTitle),1)])),_:1}),o(_,{class:"posi"},{default:t((()=>[o(_,{class:"posiIcon"},{default:t((()=>[o(b,{class:"img",src:y.imgPath+"/waimai/posi.png?v="+y.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1}),o(_,{class:"posiText","data-url":"/pages/packages/waimai/local/local","data-type":"1",onClick:k.goLink},{default:t((()=>[r(d(h.posiInfo&&h.posiInfo.address?h.posiInfo.address:"定位中..."),1)])),_:1},8,["onClick"]),o(_,{class:"arr_r"},{default:t((()=>[o(b,{class:"img",src:y.imgPath+"/waimai/arr_r.png?v="+y.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1})])),_:1})])),_:1})),y.showClone?(e(),a(_,{key:4,class:"navPlace",style:c(y.navWidth?"width:"+y.navWidth+"px;height:2rpx;opciaty:0; ":"")},null,8,["style"])):p("",!0)])),_:3},8,["style"])])),_:3},8,["class","style"]),o(_,{class:"pullDownRefresh",style:c("top:"+y.navTop+"px")},{default:t((()=>[h.pullend?h.pullend?p("",!0):(e(),a(_,{key:1,class:"icon rotate"},{default:t((()=>[o(b,{src:y.imgPath+"/info/refresh.png?v="+y.imgVersion},null,8,["src"])])),_:1})):(e(),a(_,{key:0,class:"icon"},{default:t((()=>[o(b,{src:y.imgPath+"/info/pullDown.png?v="+y.imgVersion},null,8,["src"])])),_:1})),o(_,{class:"pullState"},{default:t((()=>[r(d(h.pullend?"正在刷新":"松开刷新"),1)])),_:1})])),_:1},8,["style"]),h.showBottom?(e(),a(B,{key:0,module:h.module,active:"0",msgNum:y.msgNum,needMessage:!1},null,8,["module","msgNum"])):p("",!0)])),_:3},8,["style"])):p("",!0)}],["__scopeId","data-v-ff750a07"]]);const le=Z({data:()=>({animationData:{},content:"提示内容",icon:""}),options:{multipleSlots:!0},methods:{showToast(e,a){var t=A({duration:300,timingFunction:"ease"});this.animation=t,t.opacity(1).step(),this.animationData=t.export(),this.content=e,this.icon=a||"",setTimeout(function(){t.opacity(0).step(),this.animationData=t.export()}.bind(this),1500)}},created:function(){}},[["render",function(n,l,s,i,c,g){const m=I,h=u;return e(),a(h,{class:"wx-toast-box",animation:c.animationData},{default:t((()=>[o(h,{class:"wx-toast-content"},{default:t((()=>[""!=c.icon?(e(),a(h,{key:0,class:"wx-toast-icon"},{default:t((()=>[o(m,{src:c.icon,mode:"aspectFit"},null,8,["src"])])),_:1})):p("",!0),o(h,{class:"wx-toast-toast"},{default:t((()=>[r(d(c.content),1)])),_:1})])),_:1})])),_:1},8,["animation"])}],["__scopeId","data-v-5ea59f62"]]),se=P();const ie=Z({emits:["topay","haspay","showhasPayNumber","showPrivateNumber"],data:()=>({showRewardPop:!1,masterDomain:se.globalData.masterDomain,imgPath:se.globalData.imgPath,imgVersion:se.globalData.imgVersion,cfg_payPhone:{payPhone_entrance:0,payPhone_price:1,wxmini:"adunit-078d0de41e6925bf"},currency:{short:"元",symbol:"￥"},rewardedVideoAd:"",uniPlatform:"",android:"web"==se.globalData.platForm&&window.Android,interval:null,globalData:se.globalData,clickTime:0}),props:{phoneData:{type:Object,default:{privateNumberPhone:"",privateNumberCountDown:0,showhasPayNumber:0,privateNumberPhoneTip:"",showPrivateNumber:0,privateNumberFrom:0,privateNumberDataSet:{module:"",temp:"",aid:""}}},payInfo:{type:Object,default:{order_amount:"",order_sn:"",ordernum:"",service:"",timeout:0}}},watch:{showRewardPop:function(e){const a=this;e&&(a.clickTime=parseInt((new Date).valueOf()/1e3),"web"==a.uniPlatform&&se.globalData.appBoolean&&window.Android||("mp-weixin"==a.uniPlatform?a.initRewardAdv():a.callByPay()))}},mounted(){const e=this;e.$nextTick((()=>{e.uniPlatform=se.globalData.platForm,setTimeout((()=>{se.globalData.appConfig&&(e.cfg_payPhone=se.globalData.appConfig.cfg_payPhone,e.currency=se.globalData.appConfig.currency)}),1500)}))},methods:{privatenumberClick(e){var a=e.currentTarget.dataset.type;if("close"==a)this.$emit("showPrivateNumber",0),this.$emit("showhasPayNumber",0);else if("call"==a){var t=e.currentTarget.dataset.phone;se.globalData.appBoolean&&"web"==se.globalData.platForm?window.location.href="tel:"+t:R({phoneNumber:t})}},callByPay(){const e=this;let a=parseInt((new Date).valueOf()/1e3)-e.clickTime;e.$emit("topay",a),e.showRewardPop=!1},callBgAdv(){const e=this;e.showRewardPop=!1,se.globalData.appBoolean&&window.Android?window.setupWebViewJavascriptBridge((function(a){a.callHandler("playRewardAd",{value:e.payInfo.ordernum},(function(a){"success"==a&&(e.interval=setInterval((()=>{e.getPhoneInfo()}),1e3))}))})):e.rewardedVideoAd.show().catch((()=>{e.rewardedVideoAd.load().then((()=>e.rewardedVideoAd.show())).catch((a=>{let t=e.cfg_payPhone.payPhone_entrance?"广告拉取失败，请支付后查看或者稍后重试":"广告拉取失败，请稍后重试";e.$refs.toasts.showToast(t)}))}))},initRewardAdv(){const e=this;if(e.rewardedVideoAd)return!1;wx.createRewardedVideoAd&&(e.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:e.cfg_payPhone.wxmini}),e.rewardedVideoAd.onLoad((()=>{console.log("onLoad event emit")})),e.rewardedVideoAd.onError((a=>{console.log("onError event emit",a),e.updatePlayState(2)})),e.rewardedVideoAd.onClose((a=>{console.log("onClose event emit",a),a&&a.isEnded&&(e.showRewardPop=!1,e.updatePlayState(1))})))},updatePlayState(e){const a=this;O({success:t=>{var o=t.code,n="service=siteConfig&action=wxminiAdRewardVideoNotify&ordernum="+a.payInfo.ordernum+"&code="+o+"&state="+e,l=se.encodeUrl(n);a.$ajax.post({url:"include/ajax.php?"+l}).then((t=>{1==e&&a.getPhoneInfo()}))}})},getPhoneInfo(){const e=this;var a="service=member&action=tradePayResult&order="+e.payInfo.ordernum,t=se.encodeUrl(a);e.$ajax.post({url:"include/ajax.php?"+t}).then((a=>{var t=a.data;100==t.state&&(e.interval&&clearInterval(e.interval),e.$emit("haspay",{detail:t,fromAdv:1}))}))}}},[["render",function(n,l,s,i,c,g){const m=Q(U("toast"),le),h=u,f=D,y=I,k=H;return e(),a(h,{style:{height:"100%"}},{default:t((()=>[o(h,{style:{position:"relative","z-index":"9999999999"}},{default:t((()=>[o(m,{id:"toast",ref:"toasts"},null,512)])),_:1}),c.cfg_payPhone.wxmini&&"mp-weixin"==c.uniPlatform||"web"==c.uniPlatform&&c.android&&c.cfg_payPhone.tencentGDP_placement_id&&c.cfg_payPhone.tencentGDP_app_id?(e(),a(h,{key:0,class:C({rewardadvPop:!0,rewardadvShow:c.showRewardPop})},{default:t((()=>[o(h,{class:"rewardAdvContent"},{default:t((()=>[o(h,{class:"rewardAdvCon"},{default:t((()=>[o(h,{class:"rewardClose",onClick:l[0]||(l[0]=e=>c.showRewardPop=!1)},{default:t((()=>[r("×")])),_:1}),o(h,{class:"h3"},{default:t((()=>[r("看广告免费获取联系方式")])),_:1}),o(h,{class:"p"},{default:t((()=>[r(d(c.cfg_payPhone.payPhone_entrance?"观看广告免费获取对方联系电话":"观看广告，或直接付费获取对方联系电话"),1)])),_:1})])),_:1}),o(h,{class:"btns_group"},{default:t((()=>[c.cfg_payPhone.payPhone_entrance?p("",!0):(e(),a(h,{key:0,class:"btn_pay",onClick:g.callByPay},{default:t((()=>[o(h,{class:"txt"},{default:t((()=>[r("直接付费")])),_:1}),o(h,{class:"span"},{default:t((()=>[o(f,{class:"symbol"},{default:t((()=>[r(d(c.currency.symbol),1)])),_:1}),o(f,{class:"amount"},{default:t((()=>[r(d(s.payInfo.order_amount),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),o(h,{class:"btn_watch",onClick:g.callBgAdv},{default:t((()=>[o(h,{class:"txt"},{default:t((()=>[r("免费获取")])),_:1}),o(y,{class:"img",src:c.imgPath+"/payPop/video_icon.png?v="+c.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"])])),_:1})])),_:1}),o(h,{class:"rewardAdvMask","data-type":"close",onClick:l[1]||(l[1]=e=>c.showRewardPop=!1)})])),_:1},8,["class"])):p("",!0),o(h,{class:C("privatenumber-popup "+(s.phoneData.showPrivateNumber?"privatenumber-show":""))},{default:t((()=>[o(h,{class:"privatenumber-content"},{default:t((()=>[o(h,{class:"privatenumber-header"},{default:t((()=>[o(h,{class:"privatenumber-title"},{default:t((()=>[r("请使用"+d(s.phoneData.privateNumberFrom)+"拨打",1)])),_:1}),o(h,{class:"privatenumber-tips"},{default:t((()=>[o(f,null,{default:t((()=>[r("我们将为您使用虚拟号码拨出")])),_:1}),p("",!0)])),_:1}),o(k,{class:"privatenumber-close","data-type":"close",onClick:g.privatenumberClick},{default:t((()=>[r("×")])),_:1},8,["onClick"])])),_:1}),o(h,{class:"privatenumber-main"},{default:t((()=>[o(h,{class:"privatenumber-phone"},{default:t((()=>[r(d(s.phoneData.privateNumberPhone),1)])),_:1}),o(h,{class:"privatenumber-text"},{default:t((()=>[r(" 此号码将在 "),o(f,{class:"privatenumber-countdown"},{default:t((()=>[r(d(s.phoneData.privateNumberCountDown)+"秒",1)])),_:1}),r(" 后失效，请尽快拨打 ")])),_:1})])),_:1}),o(k,{class:"privatenumber-btn","data-type":"call","data-phone":s.phoneData.privateNumberPhone,onClick:g.privatenumberClick},{default:t((()=>[r("立即拨打")])),_:1},8,["data-phone","onClick"]),c.globalData.appConfig&&c.globalData.appConfig.cfg_shortname?(e(),a(h,{key:0,class:"concat_tip"},{default:t((()=>[r("联系我时，请说是在"),o(f,{class:"span"},{default:t((()=>[r(d(c.globalData.appConfig.cfg_shortname),1)])),_:1}),r("上看到的，谢谢！")])),_:1})):p("",!0)])),_:1}),o(h,{class:"privatenumber-mask","data-type":"close",onClick:g.privatenumberClick},null,8,["onClick"])])),_:1},8,["class"]),o(h,{class:C("privatenumber-popup "+(s.phoneData.showhasPayNumber?"privatenumber-show":""))},{default:t((()=>[o(h,{class:"privatenumber-content"},{default:t((()=>[o(h,{class:"privatenumber-header"},{default:t((()=>[o(h,{class:"privatenumber-title"},{default:t((()=>[r("已获取联系方式，请尽快拨打")])),_:1}),o(h,{class:"privatenumber-tips"},{default:t((()=>[o(f,null,{default:t((()=>[r("温馨提示，您可截图保存联系方式到相册")])),_:1})])),_:1}),o(k,{class:"privatenumber-close","data-type":"close",onClick:g.privatenumberClick},{default:t((()=>[r("×")])),_:1},8,["onClick"])])),_:1}),o(h,{class:"privatenumber-main"},{default:t((()=>[o(h,{class:"privatenumber-phone"},{default:t((()=>[r(d(s.phoneData.privateNumberPhone),1)])),_:1}),o(h,{class:"privatenumber-text"},{default:t((()=>[r(d(s.phoneData.privateNumberPhoneTip),1)])),_:1})])),_:1}),o(k,{class:"privatenumber-btn","data-type":"call","data-phone":s.phoneData.privateNumberPhone,onClick:g.privatenumberClick},{default:t((()=>[r("立即拨打")])),_:1},8,["data-phone","onClick"]),c.globalData.appConfig&&c.globalData.appConfig.cfg_shortname?(e(),a(h,{key:0,class:"concat_tip"},{default:t((()=>[r("联系我时，请说是在"),o(f,{class:"span"},{default:t((()=>[r(d(c.globalData.appConfig.cfg_shortname),1)])),_:1}),r("上看到的，谢谢！")])),_:1})):p("",!0)])),_:1}),o(h,{class:"privatenumber-mask","data-type":"close",onClick:g.privatenumberClick},null,8,["onClick"])])),_:1},8,["class"])])),_:1})}],["__scopeId","data-v-7855818f"]]);let ce,re=P();const de=Z({name:"privateTip",props:{privateShow:{type:Boolean,default:!1}},data:()=>({disagree:!1,maskb:!1,appConfig:""}),mounted(){ce=this,ce.privateShow&&ce.maskState(),re.globalData.appConfig?ce.appConfig=re.globalData.appConfig:re.watchG("appConfig",(function(e){ce.appConfig=e}))},methods:{agreeFn(){re.globalData.wxprivate=!1,re.reloadFn()},openPrivacyContract(){uni.openPrivacyContract()},maskState(){let e=V().in(this);ce.$nextTick((a=>{e.select(".pc-text").boundingClientRect((e=>{let a=L(300);ce.maskb=Boolean(e.height>=a)})).exec()}))}}},[["render",function(n,l,s,i,c,g){const m=u,h=D,f=H,y=z;return s.privateShow?(e(),a(m,{key:0,class:"privateTip"},{default:t((()=>[o(m,{class:"p-bgc"}),c.disagree?(e(),a(m,{key:1,class:"p-content"},{default:t((()=>[o(m,{class:"pc-title"},{default:t((()=>[r("温馨提示")])),_:1}),o(m,{class:"pc-text"},{default:t((()=>[r(" 如果您不同意"),o(h,{onClick:g.openPrivacyContract},{default:t((()=>[r("《用户隐私保护指引》")])),_:1},8,["onClick"]),r("，我们将无法为您提供"+d(c.appConfig.cfg_miniProgramName)+"小程序服务。 ",1)])),_:1}),o(m,{class:"pc-btn"},{default:t((()=>[o(y,{class:"disagree","open-type":"exit",target:"miniProgram"},{default:t((()=>[r("退出小程序")])),_:1}),o(f,{class:"agree",id:"agree-btn","open-type":"agreePrivacyAuthorization",onAgreeprivacyauthorization:g.agreeFn},{default:t((()=>[r("同意并继续")])),_:1},8,["onAgreeprivacyauthorization"]),c.maskb?(e(),a(m,{key:0,class:"mask"})):p("",!0)])),_:1})])),_:1})):(e(),a(m,{key:0,class:"p-content"},{default:t((()=>[o(m,{class:"pc-title"},{default:t((()=>[r("隐私保护提示")])),_:1}),o(m,{class:"pc-text"},{default:t((()=>[r(" 为了更好地保障您的个人权益，在您使用"+d(c.appConfig.cfg_miniProgramName)+"小程序前，请您仔细阅读 ",1),o(h,{onClick:g.openPrivacyContract},{default:t((()=>[r("《用户隐私保护指引》")])),_:1},8,["onClick"]),r("， 并确认了解我们的服务内容。我们将在条款说明的范国内收集、使用您的个人信息。如果您不同意，我们将不能继续为您提供服务。 "),o(m,{style:{"margin-top":"20rpx"}}),r(" 若您点击“同意并继续”按钮，表示您已理解并同意以上协议全部内容。 ")])),_:1}),o(m,{class:"pc-btn"},{default:t((()=>[o(f,{class:"disagree",onClick:l[0]||(l[0]=e=>{c.disagree=!0,g.maskState()})},{default:t((()=>[r("不同意")])),_:1}),o(f,{class:"agree",id:"agree-btn","open-type":"agreePrivacyAuthorization",onAgreeprivacyauthorization:g.agreeFn},{default:t((()=>[r("同意并继续")])),_:1},8,["onAgreeprivacyauthorization"]),c.maskb?(e(),a(m,{key:0,class:"mask"})):p("",!0)])),_:1})])),_:1}))])),_:1})):p("",!0)}],["__scopeId","data-v-9f0383d3"]]),pe=P();const ue=Z({components:{toast:le},data:()=>({uniPlatform:"",imgstatic:`${pe.globalData.masterDomain}/static/images/miniprograme/payPop/`,imgVersion:pe.globalData.imgVersion,imgPath:pe.globalData.imgPath,paypwd:[],paypwdStr:"",payment:[],onChosePay:"balance",money:0,bouns:0,showPwdPop:!1,showCancelPop:!1,timeInfo:{dd:0,hh:0,ss:0,mm:0,showText:"0"},focus:!0,hasshowPwdPop:!1,checkIn:!1,interVal:null,payInterval:null,keyboardHeight:0,i:"",currency:{code:"RMB",name:"人民币",rate:"1",short:"元",symbol:"￥"},timeoutpay:!0,userid:pe.globalData.userid,keyboardShow:!1,userInfo:""}),props:{showPayPop:{type:Boolean,default:!1},action:{type:String,default:"payPhone"},service:{type:String,default:"siteConfig"},payInfo:{type:Object,default:{order_amount:"",order_sn:"",ordernum:"",service:"",timeout:0}},callType:{type:Number,default:0},needPayTime:{type:Boolean,default:!0},needSuccess:{type:Boolean,default:!0}},emits:["paypopb","keepToCall"],methods:{ready:function(){const e=this;var a=setInterval((function(){pe.globalData.appConfig&&pe.globalData.appConfig.currency&&(e.currency=pe.globalData.appConfig.currency,clearInterval(a))}),1e3)},inputCodeFn(){},getPayment(){const e=this;var a=pe.encodeUrl("service=siteConfig&action=payment");e.$ajax.get({url:"include/ajax.php?"+a}).then((a=>{var t=a.data;if(100==t.state){let a=pe.globalData.platForm;if("mp-weixin"==a)for(let o=0;o<t.info.length;o++){let a=t.info[o];("alipay"==a.pay_code||!e.userid&&"huoniao_bonus"==a.pay_code)&&t.info.splice(o,1)}else if("mp-toutiao"==a)for(let o=0;o<t.info.length;o++){let a=t.info[o];("alipay"==a.pay_code||"wxpay"==a.pay_code||!e.userid&&"huoniao_bonus"==a.pay_code)&&t.info.splice(o,1)}else if("web"==a&&!e.userid)for(let e=0;e<t.info.length;e++){"huoniao_bonus"==t.info[e].pay_code&&t.info.splice(e,1)}pe.globalData.userid||(e.onChosePay=t.info[0].pay_code),e.payment=t.info}}))},getMemberInfo:function(){const e=this;var a="service=member&action=detail&id="+pe.globalData.userid,t=pe.encodeUrl(a);e.$ajax.get({url:"include/ajax.php?"+t}).then((a=>{100==a.data.state&&(pe.globalData.userInfo=a.data.info,e.money=1*a.data.info.money,e.bouns=1*a.data.info.bonus)}))},changePay(e){const a=this;var t=e.currentTarget.dataset.code;0!=e.currentTarget.dataset.click&&(a.onChosePay=t)},cancelConfirm(){this.showCancelPop=!0},cancelPay(){const e=this;clearInterval(e.interVal),e.showCancelPop=!1,e.showPwdPop=!1,this.$emit("paypopb",!1),e.interVal=null,"发布任务"==e.payInfo.subject&&G({delta:2,success:e=>{h({url:"web"==pe.globalData.platForm?"/taskmanage?index=0":"/pages/packages/task/taskmanage/taskmanage?index=0"})}})},keepPay(){this.showCancelPop=!1},toPay(){const e=this;"balance"==e.onChosePay?(e.showPwdPop=!0,e.keyboardShow=!0,e.hasshowPwdPop=!0):(console.log("开始支付"),e.checkPwd())},hidePwdPop(){const e=this;e.showPwdPop=!1,e.keyboardShow=!1,e.hasshowPwdPop=!1,e.paypwd=[],e.paypwdStr=""},focusin(){const e=this;e.hasshowPwdPop=!0,"web"!=e.uniplatform?e.focus=!0:e.keyboardShow=!0},showKeyboard(e){const a=this;e.detail.height&&a.keyboardHeight!=e.detail.height&&(a.keyboardHeight=e.detail.height),a.showPwdPop&&e.detail.height&&(a.hasshowPwdPop=!0,"web"!=a.uniplatform?a.focus=!0:(a.focus=!1,a.keyboardShow=!0))},goLink(e){var a=pe.globalData.appConfig.cfg_user_index+e.currentTarget.dataset.href;pe.linkTo(a)},inputPwd(e){const a=this;var t=e.detail.value,o=t.split("");if(o.length>6&&8!=e.detail.keyCode)return!1;a.paypwd=t.split(""),6==o.length&&a.checkPwd()},keyBoardIn(e){const a=this;a.paypwd.length>=6||(a.paypwd.push(e),6==a.paypwd.length&&a.checkPwd())},checkPwd(e){const a=this;if(a.checkIn||1!=a.userInfo.paypwdCheck&&!e&&"balance"==a.onChosePay)return!1;a.checkIn=!0;let t={service:a.service,action:a.action,ordernum:a.payInfo.ordernum,paytype:"pay"==a.action&&"balance"==a.onChosePay?"money":a.onChosePay};"balance"==a.onChosePay?(t.useBalance=1,t.paypwd=a.paypwd.join(""),t.balance=a.payInfo.order_amount):t.useBalance=0;let o=pe.globalData.platForm;if("mp-toutiao"==o)if("bytemini"==a.onChosePay){let e="";for(let o in t)e+=`&${o}=${t[o]}`;let a=`${pe.globalData.masterDomain}/include/ajax.php?${e}`;m({url:"/pages/redirect/index?url="+encodeURIComponent(a)})}else a.payRequest(t,(function(e){a.paySuccess(),a.paypwd=[],a.paypwdStr=""}));else if("mp-weixin"==o)"wxpay"==a.onChosePay?a.payRequest(t,(function(e){a.payBywxChat(e.data.info)})):a.payRequest(t,(function(e){a.paySuccess(),a.paypwd=[],a.paypwdStr=""}));else if("web"==o)if(!window.appBoolean||"wxpay"!=a.onChosePay&&"alipay"!=a.onChosePay)if("wxpay"==a.onChosePay||"alipay"==a.onChosePay){let e="";for(let a in t)e+=`&${a}=${t[a]}`;e=e.slice(1),location.href=`${pe.globalData.masterDomain}/include/ajax.php?${e}`}else a.payRequest(t,(function(e){a.paySuccess(),a.paypwd=[],a.paypwdStr=""}));else a.$ajax.post({url:pe.encodeUrl("include/ajax.php?mark=pay&app=1"),data:t}).then((e=>{100==e.data.state&&window.setupWebViewJavascriptBridge((function(t){t.callHandler("wxpay"==a.onChosePay?"wechatPay":"aliPay",{orderInfo:e.data.info},(function(e){}))}))}))},payRequest(e,a){const t=this;J({title:"支付中..."}),t.$ajax.post({url:pe.encodeUrl("include/ajax.php?mark=pay"),data:e}).then((e=>{W(),t.checkIn=!1,e.data.state&&100!=e.data.state?(t.$refs.toasts.showToast(e.data.info),t.paypwd=[],t.paypwdStr=""):100==e.data.state?a(e):(t.paypwd=[],t.paypwdStr="",t.$refs.toasts.showToast("网络请求失败，请稍后重新请求，错误代码："+JSON.stringify(e.data)))}))},payBywxChat(e){const a=this;uni.requestPayment({timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:decodeURIComponent(e.paySign),success:function(e){a.paySuccess()},fail:function(e){console.log(e),a.$refs.toasts.showToast("支付失败！")}})},paybytoutiao(e){console.log(e)},initData(e){const a=this;a.$emit("keepToCall",{detail:e}),a.$emit("paypopb",!1),a.paypwd=[],a.onChosePay="balance",a.money=0,a.bouns=0,a.showPwdPop=!1,a.showCancelPop=!1,a.hasshowPwdPop=!1,a.getMemberInfo()},paySuccess(){const e=this;if(clearInterval(e.interVal),e.needSuccess){var a=e.imgPath+"/payPop/successIcon.png?v="+e.imgVersion;e.$refs.toasts.showToast("支付成功",a)}e.getPhoneInfo()},getPhoneInfo(){const e=this;var a="service=member&action=tradePayResult&order="+e.payInfo.ordernum;e.$ajax.post({url:"include/ajax.php?"+a}).then((a=>{var t=a.data;100==t.state&&e.initData(t)}))},setPayPwd:function(){const e=this;var a=this;if(a.loading)return!1;if(6!=a.paypwd.length)return showErrAlert("请输入新密码"),!1;a.loading=!0;var t="service=member&action=updateAccount&do=paypwdAdd"+("&pay1="+a.paypwd.join("")+"&pay2="+a.paypwd.join("")),o=pe.encodeUrl(t);a.$ajax.post({url:"include/ajax.php?"+o}).then((t=>{var o=t.data;if(a.loading=!1,100==o.state){var n=e.imgPath+"/payPop/successIcon.png?v="+e.imgVersion;a.$refs.toasts.showToast("支付密码设置成功",n),a.checkPwd(1)}}))},payCutDown(e,a,t=0){const o=this;a=parseInt((new Date).valueOf()/1e3)+1800,e.order_amount>o.money&&(o.onChosePay=o.payment[0].pay_code),o.interVal&&clearInterval(o.interVal),o.timeInfo={dd:"0",hh:"00",mm:"00",ss:"00",showText:"0天0小时0分钟0秒"},o.interVal=setInterval((function(){var e=parseInt(Date.parse(new Date));if(1e3*a-e>0)var t=1e3*a-e;else t=0;t||clearInterval(o.interVal);var n=Math.floor(t/864e5),l=Math.floor(t/36e5%24),s=Math.floor(t/6e4%60),i=Math.floor(t/1e3%60),c={dd:n>9?n:"0"+n,hh:l>9?l:"0"+l,mm:s>9?s:"0"+s,ss:i>9?i:"0"+i,showText:n?n+"天":l?l+"小时":s?s+"分钟":i+"秒"};o.timeInfo=c}),1e3)},showtoast(){console.log("测试方法")},trueFun(){console.log("占位：函数 true 未声明")}},created(){const e=this;e.getPayment(),pe.globalData.userid&&e.getMemberInfo(),setTimeout((a=>{e.timeoutpay=!1}),400)},mounted(){const e=this;this.uniPlatform=w().uniPlatform,"web"==this.uniPlatform&&(this.focus=!1,this.hasshowPwdPop=!1),"{}"!=JSON.stringify(pe.globalData.userInfo)?this.userInfo=pe.globalData.userInfo:v({key:"userid",success:a=>{pe.memberInfo(a.data,(function(a){e.userInfo=a}))}}),this.$nextTick((()=>this.ready()))},unmounted(){clearInterval(this.interVal)}},[["render",function(g,m,h,f,y,k){const b=u,_=D,w=I,v=K,P=Q(U("toast"),le);return E((e(),a(b,{class:"payPopContainer"},{default:t((()=>[o(b,{class:C("payPopMask "+(h.showPayPop?"showPop":"")),onTouchmove:n(k.trueFun,["stop","prevent"])},null,8,["class","onTouchmove"]),o(b,{class:C("payPop payPhonePop "+(h.showPayPop?"showPop":""))},{default:t((()=>[o(b,{class:"payInfoShow"},{default:t((()=>[o(b,{class:"pi-title"},{default:t((()=>[r(d(h.payInfo.subject)+"需支付",1)])),_:1}),o(b,{class:"h2",onClick:k.showtoast},{default:t((()=>[y.currency?(e(),a(_,{key:0,class:"span"},{default:t((()=>[r(d(y.currency.symbol),1)])),_:1})):p("",!0),o(_,{class:"b",id:"amout"},{default:t((()=>[r(d(h.payInfo.order_amount),1)])),_:1})])),_:1},8,["onClick"]),h.needPayTime?(e(),a(b,{key:0,class:"p"},{default:t((()=>[r(" 支付时间: "),o(_,{class:"payCutDown span"},{default:t((()=>[o(_,{class:"em"},{default:t((()=>[r(d(y.timeInfo.hh),1)])),_:1}),r(" : "),o(_,{class:"em"},{default:t((()=>[r(d(y.timeInfo.mm),1)])),_:1}),r(" : "),o(_,{class:"em"},{default:t((()=>[r(d(y.timeInfo.ss),1)])),_:1})])),_:1})])),_:1})):p("",!0)])),_:1}),o(b,{class:"payListBox"},{default:t((()=>[o(b,{class:"close_pay_pop",onClick:k.cancelConfirm},{default:t((()=>[o(w,{mode:"aspectFit",src:y.imgPath+"/payPop/close.png?v="+y.imgVersion},null,8,["src"])])),_:1},8,["onClick"]),o(b,{class:"ul"},{default:t((()=>[y.userid?(e(),a(b,{key:0,class:C("check-item li "+("balance"==y.onChosePay&&h.payInfo.order_amount<=y.money?"paychosed":"")+" "+(h.payInfo.order_amount>y.money?"disabled_pay":"")),id:"balance","data-code":"balance",onClick:k.changePay,"data-click":h.payInfo.order_amount>y.money?0:1},{default:t((()=>[o(b,{class:"left_item div"},{default:t((()=>[o(b,{class:"check-item-img"},{default:t((()=>[o(w,{class:"img",mode:"aspectFit",src:y.imgPath+"/payPop/balance.png?v="+y.imgVersion},null,8,["src"])])),_:1}),o(b,{class:"check-item-txt"},{default:t((()=>[o(b,{class:"h3"},{default:t((()=>[r(" 余额 "),h.payInfo.order_amount<=y.money?(e(),a(_,{key:0},{default:t((()=>[r("(可用余额"+d(y.currency.symbol)+d(y.money)+")",1)])),_:1})):(e(),a(_,{key:1},{default:t((()=>[r("(余额不足，可用余额"+d(y.currency.symbol)+d(y.money)+")",1)])),_:1}))])),_:1})])),_:1})])),_:1}),o(b,{class:"check-item-right"},{default:t((()=>[o(b,{class:"checkbox-icon-round span"},{default:t((()=>[o(w,{mode:"aspectFiill",src:y.imgPath+"/payPop/chosed.png?v="+y.imgVersion},null,8,["src"])])),_:1})])),_:1}),h.payInfo.order_amount>y.money?(e(),a(b,{key:0,class:"investMoney","data-href":"/deposit.html?paytype=deposit",onClick:k.goLink},{default:t((()=>[r("充值")])),_:1},8,["onClick"])):p("",!0)])),_:1},8,["class","onClick","data-click"])):p("",!0),(e(!0),l(s,null,i(y.payment,((n,l)=>(e(),a(b,{key:l,class:C("check-item li "+(n.pay_code==y.onChosePay?"paychosed":"")+"  "+(h.payInfo.order_amount>y.bouns&&"huoniao_bonus"==n.pay_code?"disabled_pay":"")),"data-code":n.pay_code,"data-click":h.payInfo.order_amount>y.bouns&&"huoniao_bonus"==n.pay_code?0:1,onClick:k.changePay},{default:t((()=>[o(b,{class:"left_item div"},{default:t((()=>[o(b,{class:"check-item-img"},{default:t((()=>["huoniao_bonus"==n.pay_code?(e(),a(w,{key:0,class:"img",mode:"aspectFit",src:y.imgPath+"/payPop/bonus_pay.png?v="+y.imgVersion},null,8,["src"])):(e(),a(w,{key:1,class:"img",mode:"aspectFit",src:n.pay_icon},null,8,["src"]))])),_:2},1024),o(b,{class:"check-item-txt"},{default:t((()=>["huoniao_bonus"==n.pay_code?(e(),a(b,{key:0,class:"h3"},{default:t((()=>[r(d(n.pay_name)+" ",1),h.payInfo.order_amount<=y.bouns?(e(),a(_,{key:0},{default:t((()=>[r("(可用余额"+d(y.currency.symbol)+d(y.bouns)+")",1)])),_:1})):(e(),a(_,{key:1},{default:t((()=>[r("(余额不足，可用余额"+d(y.currency.symbol)+d(y.bouns)+")",1)])),_:1}))])),_:2},1024)):(e(),a(b,{key:1,class:"h3"},{default:t((()=>[r(d(n.pay_name),1)])),_:2},1024))])),_:2},1024)])),_:2},1024),h.payInfo.order_amount>y.bouns&&"huoniao_bonus"==n.pay_code?(e(),a(b,{key:0,class:"investMoney",onClick:k.goLink,"data-href":"/recharge.html"},{default:t((()=>[r("充值")])),_:1},8,["onClick"])):(e(),a(b,{key:1,class:"check-item-right"},{default:t((()=>[o(b,{class:"checkbox-icon-round span"},{default:t((()=>[o(w,{mode:"aspectFiill",src:y.imgPath+"/payPop/chosed.png?v="+y.imgVersion},null,8,["src"])])),_:1})])),_:1}))])),_:2},1032,["class","data-code","data-click","onClick"])))),128))])),_:1})])),_:1}),o(b,{class:"btn_pay a",onClick:k.toPay},{default:t((()=>[o(_,{style:{display:"block"},class:"span"},{default:t((()=>[r("立即付款")])),_:1})])),_:1},8,["onClick"]),o(b,{class:C("payCancelMask "+(y.showCancelPop?"showPop":""))},null,8,["class"]),o(b,{class:C("payCancelPop "+(y.showCancelPop?"showPop":"")),style:c(h.needPayTime?"":"height:250rpx;")},{default:t((()=>[o(b,{class:"h4"},{default:t((()=>[r("确定放弃本次付款？")])),_:1}),h.needPayTime?(e(),a(b,{key:0,class:"p"},{default:t((()=>[r(" 您的订单在 "),o(_,{class:"daojs_order span"},{default:t((()=>[r(d(y.timeInfo.showText),1)])),_:1}),r(" 内未支付将被取消， 请尽快完成支付 ")])),_:1})):p("",!0),o(b,{class:"payBtns"},{default:t((()=>[o(b,{class:"cancelPay a",onClick:k.cancelPay},{default:t((()=>[r("放弃")])),_:1},8,["onClick"]),o(b,{class:"keepPay a",onClick:k.keepPay},{default:t((()=>[r("继续支付")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["class","style"])])),_:1},8,["class"]),o(b,{class:"inputBox"},{default:t((()=>[o(v,{type:"number","hold-keyboard":!0,focus:y.hasshowPwdPop&&y.focus,class:"keyInp",onKeyboardheightchange:k.showKeyboard,onInput:k.inputPwd,maxlength:"6",modelValue:y.paypwdStr,"onUpdate:modelValue":m[0]||(m[0]=e=>y.paypwdStr=e)},null,8,["focus","onKeyboardheightchange","onInput","modelValue"])])),_:1}),o(b,{class:C("payPwdPop "+(y.showPwdPop?"showPop":""))},{default:t((()=>[o(b,{class:"payBackBtn a",onClick:k.hidePwdPop},{default:t((()=>[o(w,{src:y.imgPath+"/payPop/arr_back.png?v="+y.imgVersion,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"]),o(b,{class:"h4"},{default:t((()=>[r(d(1==y.userInfo.paypwdCheck?"输入":"设置")+"支付密码",1)])),_:1}),o(b,{class:"payPwdBox",style:c("padding-bottom:"+(y.keyboardHeight+10)+"px;")},{default:t((()=>[o(b,{class:"p"},{default:t((()=>[r("请"+d(1==y.userInfo.paypwdCheck?"输入":"设置")+"6位数字密码确认支付",1)])),_:1}),o(b,{class:"payPwdInp"},{default:t((()=>[o(b,{class:"ul",onClick:k.focusin},{default:t((()=>[(e(),l(s,null,i(6,((n,l)=>o(b,{class:"li",key:l},{default:t((()=>[y.paypwd[l]||0==y.paypwd[l]?(e(),a(_,{key:0,class:"em"},{default:t((()=>[r("•")])),_:1})):p("",!0)])),_:2},1024))),64))])),_:1},8,["onClick"])])),_:1}),1==y.userInfo.paypwdCheck?(e(),a(b,{key:0,class:"fpwtbox"},{default:t((()=>[o(b,{"data-href":"/security-paypwdEdit.html?step=2",class:"fpwt a",onClick:k.goLink},{default:t((()=>[r("忘记密码?")])),_:1},8,["onClick"])])),_:1})):(e(),a(b,{key:1,class:"spwtbox"},{default:t((()=>[o(b,{class:"p"},{default:t((()=>[r("·避免使用连续或重复数字，类似“123456”“112233”")])),_:1}),o(b,{class:"p"},{default:t((()=>[r("·避免使用手机号、证件号中的连续数字")])),_:1})])),_:1})),1!=y.userInfo.paypwdCheck?(e(),a(b,{key:2,class:"setPwdUp",onClick:k.setPayPwd},{default:t((()=>[r("确认并支付")])),_:1},8,["onClick"])):p("",!0)])),_:1},8,["style"]),"web"==y.uniPlatform?(e(),a(b,{key:0,class:C({keyboard:!0,showKeyBoard:y.keyboardShow})},{default:t((()=>[o(b,null,{default:t((()=>[o(_,{onClick:m[1]||(m[1]=e=>k.keyBoardIn(1))},{default:t((()=>[r("1")])),_:1}),o(_,{onClick:m[2]||(m[2]=e=>k.keyBoardIn(2))},{default:t((()=>[r("2")])),_:1}),o(_,{onClick:m[3]||(m[3]=e=>k.keyBoardIn(3))},{default:t((()=>[r("3")])),_:1}),o(_,{onClick:m[4]||(m[4]=e=>k.keyBoardIn(4))},{default:t((()=>[r("4")])),_:1}),o(_,{onClick:m[5]||(m[5]=e=>k.keyBoardIn(5))},{default:t((()=>[r("5")])),_:1}),o(_,{onClick:m[6]||(m[6]=e=>k.keyBoardIn(6))},{default:t((()=>[r("6")])),_:1}),o(_,{onClick:m[7]||(m[7]=e=>k.keyBoardIn(7))},{default:t((()=>[r("7")])),_:1}),o(_,{onClick:m[8]||(m[8]=e=>k.keyBoardIn(8))},{default:t((()=>[r("8")])),_:1}),o(_,{onClick:m[9]||(m[9]=e=>k.keyBoardIn(9))},{default:t((()=>[r("9")])),_:1}),o(_,{class:"none"}),o(_,{onClick:m[10]||(m[10]=e=>k.keyBoardIn(0))},{default:t((()=>[r("0")])),_:1}),o(_,{class:"backSpace",style:c(`background: url(${y.imgstatic}del_num.png) no-repeat 50%/60rpx;`),onClick:m[11]||(m[11]=e=>y.paypwd=y.paypwd.slice(0,-1))},null,8,["style"])])),_:1})])),_:1},8,["class"])):p("",!0)])),_:1},8,["class"]),o(b,{style:{position:"relative","z-index":"9999999999"}},{default:t((()=>[o(P,{id:"toast",ref:"toasts"},null,512)])),_:1})])),_:1},512)),[[q,!y.timeoutpay]])}],["__scopeId","data-v-406453c0"]]);export{ne as _,ie as a,te as b,de as c,ue as p};
