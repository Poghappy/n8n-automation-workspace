# 用户手册

## 欢迎使用N8N企业级自动化工作流平台

本手册将帮助您快速上手并充分利用平台的各项功能，从基础操作到高级应用，让您轻松实现业务自动化。

## 目录

1. [快速入门](#快速入门)
2. [界面介绍](#界面介绍)
3. [工作流管理](#工作流管理)
4. [AI智能体使用](#ai智能体使用)
5. [节点详解](#节点详解)
6. [最佳实践](#最佳实践)
7. [故障排除](#故障排除)
8. [常见问题](#常见问题)

## 快速入门

### 第一次登录

1. **访问系统**
   - 打开浏览器，访问 `http://localhost:5678`
   - 使用管理员提供的账号密码登录

2. **界面概览**
   - 左侧：节点面板，包含所有可用的工作流节点
   - 中央：工作流画布，用于设计和编辑工作流
   - 右侧：节点配置面板，设置选中节点的参数
   - 顶部：工具栏，包含保存、执行、设置等功能

3. **创建第一个工作流**
   - 点击"New Workflow"创建新工作流
   - 从左侧拖拽一个"Manual Trigger"节点到画布
   - 添加一个"Set"节点用于数据处理
   - 连接两个节点
   - 点击"Save"保存工作流

### 5分钟快速体验

让我们创建一个简单的数据处理工作流：

1. **添加触发器**
   ```
   Manual Trigger → 手动触发工作流
   ```

2. **添加数据处理**
   ```
   Set Node → 设置变量: name = "Hello World"
   ```

3. **添加输出**
   ```
   HTTP Request → 发送数据到指定URL
   ```

4. **测试执行**
   - 点击"Execute Workflow"
   - 查看执行结果
   - 检查每个节点的输出数据

## 界面介绍

### 主界面布局

#### 1. 顶部导航栏
- **工作流名称**: 显示当前工作流名称，点击可重命名
- **保存按钮**: 保存当前工作流更改
- **执行按钮**: 手动执行工作流
- **设置按钮**: 工作流全局设置
- **用户菜单**: 账户设置、退出登录等

#### 2. 左侧节点面板
- **触发器节点**: Webhook、Schedule、Manual等
- **数据处理节点**: Set、Function、IF等
- **集成节点**: HTTP Request、Database、Email等
- **搜索功能**: 快速查找所需节点

#### 3. 中央工作流画布
- **节点操作**: 拖拽、连接、删除节点
- **缩放控制**: 放大缩小画布视图
- **网格对齐**: 帮助节点整齐排列
- **执行状态**: 显示节点执行状态和结果

#### 4. 右侧配置面板
- **节点参数**: 配置选中节点的各项参数
- **表达式编辑**: 使用N8N表达式处理数据
- **测试功能**: 测试节点配置是否正确

### 快捷键

| 快捷键 | 功能 |
|--------|------|
| Ctrl+S | 保存工作流 |
| Ctrl+E | 执行工作流 |
| Delete | 删除选中节点 |
| Ctrl+Z | 撤销操作 |
| Ctrl+Y | 重做操作 |
| Ctrl+A | 全选节点 |
| Ctrl+C | 复制节点 |
| Ctrl+V | 粘贴节点 |

## 工作流管理

### 创建工作流

#### 1. 从模板创建
```
1. 点击"Templates"
2. 选择合适的模板
3. 点击"Use this template"
4. 根据需要修改配置
5. 保存并命名工作流
```

#### 2. 从零开始创建
```
1. 点击"New Workflow"
2. 添加触发器节点
3. 添加处理节点
4. 配置节点参数
5. 连接节点
6. 测试和保存
```

### 工作流配置

#### 基础设置
- **名称**: 工作流的显示名称
- **描述**: 工作流功能说明
- **标签**: 用于分类和搜索
- **时区**: 定时任务的时区设置

#### 高级设置
- **错误处理**: 设置错误处理工作流
- **超时设置**: 工作流执行超时时间
- **并发控制**: 限制同时执行的实例数
- **日志级别**: 设置日志记录详细程度

### 版本管理

#### 版本控制
- **自动保存**: 每次修改自动创建版本
- **版本对比**: 查看不同版本间的差异
- **版本回滚**: 恢复到历史版本
- **版本标签**: 为重要版本添加标签

#### 导入导出
```json
// 导出工作流
{
  "name": "数据同步工作流",
  "nodes": [...],
  "connections": {...},
  "settings": {...}
}
```

## AI智能体使用

### 智能体类型

#### 1. 执行官智能体 🎯
**专长**: 工作流创建、执行优化、需求分析

**使用场景**:
- "帮我创建一个数据同步工作流"
- "优化这个工作流的性能"
- "分析工作流执行失败的原因"

**示例对话**:
```
用户: 我需要每天定时从API获取数据并存储到数据库
智能体: 我来帮您创建一个定时数据同步工作流：
1. 使用Schedule Trigger设置每日执行时间
2. 添加HTTP Request节点获取API数据
3. 使用Set节点处理数据格式
4. 添加Database节点存储数据
5. 配置错误处理和通知机制
```

#### 2. 教学老师智能体 👨‍🏫
**专长**: 学习指导、最佳实践、技能提升

**使用场景**:
- "如何使用Function节点处理复杂数据"
- "工作流设计的最佳实践是什么"
- "如何调试工作流执行错误"

**示例对话**:
```
用户: Function节点怎么使用？
智能体: Function节点是处理复杂逻辑的强大工具：

基础语法：
- 使用JavaScript编写处理逻辑
- 通过$input访问输入数据
- 返回处理后的数据

示例代码：
```javascript
// 处理用户数据
const users = $input.all();
return users.map(user => ({
  id: user.json.id,
  name: user.json.name.toUpperCase(),
  email: user.json.email.toLowerCase()
}));
```

#### 3. 分析师智能体 🔍
**专长**: 数据分析、性能监控、优化建议

**使用场景**:
- "分析工作流的执行性能"
- "找出系统瓶颈"
- "提供优化建议"

### 智能对话功能

#### 启动对话
1. 点击右下角的AI助手图标
2. 选择合适的智能体类型
3. 输入您的问题或需求
4. 查看智能体的回复和建议

#### 对话技巧
- **具体描述**: 详细说明您的需求和场景
- **提供上下文**: 说明当前的工作流状态
- **分步骤**: 复杂问题可以分步骤询问
- **反馈结果**: 告诉智能体操作结果，获得进一步指导

## 节点详解

### 触发器节点

#### 1. Manual Trigger (手动触发)
**用途**: 手动启动工作流执行
**配置**: 无需配置
**使用场景**: 测试、一次性任务

#### 2. Schedule Trigger (定时触发)
**用途**: 按时间计划自动执行工作流
**配置**:
```
- 触发规则: 每小时/每天/每周/自定义
- 时间设置: 具体的执行时间
- 时区: 时区设置
```
**使用场景**: 定时备份、定期报告、数据同步

#### 3. Webhook (网络钩子)
**用途**: 接收HTTP请求触发工作流
**配置**:
```
- HTTP方法: GET/POST/PUT/DELETE
- 路径: webhook的URL路径
- 认证: 可选的认证设置
```
**使用场景**: API集成、实时数据处理

### 数据处理节点

#### 1. Set (设置变量)
**用途**: 设置或修改数据变量
**配置**:
```javascript
// 设置新变量
{
  "user_name": "John Doe",
  "timestamp": "{{new Date().toISOString()}}"
}
```

#### 2. Function (函数处理)
**用途**: 使用JavaScript处理复杂逻辑
**配置**:
```javascript
// 处理输入数据
const items = $input.all();
return items.map(item => {
  // 数据处理逻辑
  return {
    json: {
      processed: true,
      original: item.json
    }
  };
});
```

#### 3. IF (条件判断)
**用途**: 根据条件分支执行不同逻辑
**配置**:
```
- 条件类型: 字符串/数字/布尔值比较
- 比较操作: 等于/不等于/大于/小于等
- 条件值: 比较的目标值
```

### 集成节点

#### 1. HTTP Request (HTTP请求)
**用途**: 发送HTTP请求到外部API
**配置**:
```
- 请求方法: GET/POST/PUT/DELETE
- URL: 目标API地址
- 请求头: 自定义HTTP头
- 请求体: POST/PUT请求的数据
- 认证: API密钥、OAuth等
```

#### 2. MySQL (数据库)
**用途**: 连接和操作MySQL数据库
**配置**:
```
- 操作类型: 查询/插入/更新/删除
- 数据库连接: 主机、端口、用户名、密码
- SQL语句: 要执行的SQL命令
```

#### 3. Email (邮件)
**用途**: 发送邮件通知
**配置**:
```
- SMTP设置: 邮件服务器配置
- 收件人: 邮件接收者
- 主题: 邮件主题
- 内容: 邮件正文（支持HTML）
```

## 最佳实践

### 工作流设计原则

#### 1. 单一职责原则
- 每个工作流专注解决一个特定问题
- 避免在单个工作流中处理过多不相关的任务
- 复杂业务逻辑拆分为多个简单工作流

#### 2. 错误处理
```
推荐模式：
主工作流 → 业务逻辑 → 成功处理
    ↓
错误处理工作流 → 日志记录 → 通知管理员
```

#### 3. 数据验证
- 在处理数据前进行格式验证
- 使用IF节点检查必要字段
- 设置默认值处理缺失数据

### 性能优化

#### 1. 减少不必要的节点
- 合并相似的数据处理操作
- 使用Function节点替代多个Set节点
- 避免冗余的数据转换

#### 2. 批量处理
```javascript
// 推荐：批量处理
const items = $input.all();
const results = items.map(item => processItem(item));
return results;

// 避免：逐个处理
// 会导致多次数据库连接
```

#### 3. 缓存机制
- 对频繁访问的数据使用缓存
- 避免重复的API调用
- 使用Redis等缓存服务

### 安全最佳实践

#### 1. 凭证管理
- 使用N8N凭证系统存储敏感信息
- 定期更新API密钥和密码
- 避免在工作流中硬编码敏感数据

#### 2. 访问控制
- 为不同用户设置适当的权限
- 限制工作流的执行权限
- 定期审查用户访问权限

#### 3. 数据安全
- 对敏感数据进行加密传输
- 避免在日志中记录敏感信息
- 实施数据备份和恢复策略

## 故障排除

### 常见问题诊断

#### 1. 工作流执行失败
**症状**: 工作流状态显示为"Error"
**诊断步骤**:
```
1. 查看执行日志
2. 检查失败节点的错误信息
3. 验证节点配置参数
4. 测试外部服务连接
5. 检查数据格式是否正确
```

#### 2. 节点连接问题
**症状**: 无法连接到外部服务
**解决方案**:
```
1. 检查网络连接
2. 验证API密钥和认证信息
3. 确认服务端点URL正确
4. 检查防火墙设置
5. 测试服务可用性
```

#### 3. 数据格式错误
**症状**: 数据处理节点报错
**解决方案**:
```
1. 使用Set节点查看数据结构
2. 添加数据验证逻辑
3. 使用Function节点处理异常数据
4. 设置默认值和错误处理
```

### 调试技巧

#### 1. 使用调试模式
- 启用详细日志记录
- 逐步执行工作流
- 检查每个节点的输入输出

#### 2. 数据检查
```javascript
// 在Function节点中添加调试代码
console.log('Input data:', JSON.stringify($input.all(), null, 2));
// 处理逻辑
console.log('Output data:', JSON.stringify(result, null, 2));
return result;
```

#### 3. 错误日志分析
- 查看系统日志文件
- 分析错误堆栈信息
- 记录问题复现步骤

## 常见问题

### Q1: 如何设置定时任务？
**A**: 使用Schedule Trigger节点，配置执行时间和频率。支持Cron表达式进行精确控制。

### Q2: 工作流执行很慢怎么办？
**A**: 
1. 检查是否有不必要的延迟
2. 优化数据库查询
3. 使用批量处理
4. 减少外部API调用次数

### Q3: 如何处理大量数据？
**A**: 
1. 使用分页处理
2. 实施批量操作
3. 考虑使用队列系统
4. 设置合理的超时时间

### Q4: 如何备份工作流？
**A**: 
1. 定期导出工作流JSON文件
2. 使用版本控制系统
3. 设置自动备份计划
4. 测试恢复流程

### Q5: 如何监控工作流状态？
**A**: 
1. 使用内置的执行历史
2. 设置邮件通知
3. 集成监控系统
4. 创建状态仪表板

## 技术支持

### 获取帮助
- 📖 **在线文档**: [https://docs.example.com](https://docs.example.com)
- 💬 **社区论坛**: [https://community.example.com](https://community.example.com)
- 📧 **邮件支持**: support@example.com
- 🎫 **工单系统**: [https://support.example.com](https://support.example.com)

### 学习资源
- 🎥 **视频教程**: 系统功能演示和最佳实践
- 📚 **案例研究**: 真实业务场景的解决方案
- 🛠️ **模板库**: 常用工作流模板下载
- 🎓 **在线培训**: 定期举办的培训课程

### 社区参与
- 🌟 **GitHub**: 参与开源项目开发
- 💡 **功能建议**: 提交新功能需求
- 🐛 **问题反馈**: 报告系统问题和Bug
- 📝 **文档贡献**: 帮助完善文档内容

---

**版本**: v1.0.0  
**更新时间**: 2024-01-01  
**适用版本**: N8N 1.0+