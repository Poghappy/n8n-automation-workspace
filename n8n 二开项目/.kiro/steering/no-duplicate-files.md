---
inclusion: always
---

# Kiro开发规则：避免重复创建文件

## 核心原则

**优先更新和修复现有文件，避免创建重复的测试脚本、文档和功能文件。**

## 具体规则

### 1. 文件创建限制

**禁止创建的重复文件类型：**
- 测试脚本（test-*.js, *-test.js, debug-*.js）
- 文档文件（*.md, README*, SUMMARY*, REPORT*）
- 配置文件（*-config.js, config-*.js）
- 示例文件（example-*.js, *-example.js）

**例外情况：**
- 明确需要新的独立功能模块
- 用户明确要求创建新文件
- 现有文件无法满足新需求且修改会破坏原有功能

### 2. 优先操作顺序

1. **更新现有文件** - 修改、增强、优化现有代码
2. **修复现有问题** - 解决bug、性能问题、兼容性问题
3. **重构现有代码** - 改进结构、提高可维护性
4. **最后考虑新建** - 仅在必要时创建新文件

### 3. 文件操作指导

#### 3.1 代码文件
```javascript
// ✅ 推荐：更新现有文件
// 在现有类中添加新方法
class ExistingProcessor {
    // 新增方法
    newMethod() { ... }
    
    // 修改现有方法
    existingMethod() {
        // 优化的实现
    }
}

// ❌ 避免：创建新的相似文件
// class NewProcessor extends ExistingProcessor { ... }
```

#### 3.2 测试文件
```javascript
// ✅ 推荐：在现有测试文件中添加测试用例
describe('Enhanced Processor', () => {
    // 现有测试
    it('should process content', () => { ... });
    
    // 新增测试用例
    it('should handle new feature', () => { ... });
});

// ❌ 避免：创建新的测试文件
// test-new-feature.js
```

#### 3.3 文档文件
```markdown
<!-- ✅ 推荐：更新现有文档 -->
# 现有文档标题

## 新增章节
新功能说明...

## 更新的章节
修改后的内容...

<!-- ❌ 避免：创建新的文档文件 -->
<!-- NEW_FEATURE_DOCS.md -->
```

### 4. 实施策略

#### 4.1 代码更新策略
- 使用 `strReplace` 工具修改现有代码
- 使用 `fsAppend` 工具添加新功能
- 保持向后兼容性
- 添加版本注释说明变更

#### 4.2 测试更新策略
- 在现有测试文件中添加新测试用例
- 更新测试数据和预期结果
- 保留原有测试确保回归测试
- 使用describe嵌套组织新测试

#### 4.3 文档更新策略
- 在现有文档中添加新章节
- 更新变更日志
- 修正过时信息
- 保持文档结构一致性

### 5. 检查清单

在进行任何文件操作前，检查：

- [ ] 是否存在可以更新的现有文件？
- [ ] 现有文件是否可以通过修改满足需求？
- [ ] 新功能是否可以集成到现有模块中？
- [ ] 是否会创建功能重复的文件？
- [ ] 用户是否明确要求创建新文件？

### 6. 异常处理

**允许创建新文件的情况：**
1. 用户明确要求创建特定文件
2. 现有文件架构无法支持新功能
3. 需要创建独立的工具或实用程序
4. 创建配置文件或数据文件

**创建新文件时的要求：**
- 说明为什么不能更新现有文件
- 确保新文件有明确的独特用途
- 避免与现有文件功能重叠
- 考虑未来的维护成本

### 7. 示例场景

#### 场景1：添加新功能
```
用户要求：添加新的内容分类功能

❌ 错误做法：创建 new-classifier.js
✅ 正确做法：在现有处理器中添加分类方法
```

#### 场景2：修复bug
```
用户要求：修复处理器的性能问题

❌ 错误做法：创建 fixed-processor.js
✅ 正确做法：直接修改现有处理器文件
```

#### 场景3：优化配置
```
用户要求：优化配置参数

❌ 错误做法：创建 optimized-config.js
✅ 正确做法：更新现有配置文件
```

## 执行监督

Kiro将在每次文件操作时检查此规则，确保：
- 优先考虑更新现有文件
- 避免创建重复功能的文件
- 保持代码库的整洁和一致性
- 提高代码的可维护性

## 规则更新

此规则可根据项目需求和用户反馈进行调整，但核心原则保持不变：
**优先更新，避免重复，保持整洁。**