# è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµç›‘æ§ä»ªè¡¨æ¿

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµç³»ç»Ÿçš„ç›‘æ§ä»ªè¡¨æ¿é…ç½®å’Œä½¿ç”¨æ–¹æ³•ï¼ŒåŒ…æ‹¬å…³é”®æŒ‡æ ‡ã€å‘Šè­¦è®¾ç½®å’ŒæŠ¥å‘Šæ¨¡æ¿ã€‚

## ç›‘æ§æ¶æ„

```mermaid
graph TB
    subgraph "æ•°æ®æ”¶é›†å±‚"
        N8N[n8nå·¥ä½œæµå¼•æ“]
        LOGS[æ—¥å¿—æ–‡ä»¶]
        METRICS[æ€§èƒ½æŒ‡æ ‡]
        APIS[å¤–éƒ¨APIçŠ¶æ€]
    end

    subgraph "ç›‘æ§å¤„ç†å±‚"
        COLLECTOR[æ•°æ®æ”¶é›†å™¨]
        PROCESSOR[æŒ‡æ ‡å¤„ç†å™¨]
        ANALYZER[å¼‚å¸¸åˆ†æå™¨]
    end

    subgraph "å±•ç¤ºå±‚"
        DASHBOARD[ç›‘æ§ä»ªè¡¨æ¿]
        ALERTS[å‘Šè­¦ç³»ç»Ÿ]
        REPORTS[æŠ¥å‘Šç”Ÿæˆ]
    end

    N8N --> COLLECTOR
    LOGS --> COLLECTOR
    METRICS --> COLLECTOR
    APIS --> COLLECTOR

    COLLECTOR --> PROCESSOR
    PROCESSOR --> ANALYZER
    ANALYZER --> DASHBOARD
    ANALYZER --> ALERTS
    PROCESSOR --> REPORTS
```

## å…³é”®æŒ‡æ ‡

### 1. ç³»ç»Ÿå¥åº·æŒ‡æ ‡

#### æœåŠ¡å¯ç”¨æ€§
- **n8næœåŠ¡çŠ¶æ€**: åœ¨çº¿/ç¦»çº¿
- **æ•°æ®åº“è¿æ¥**: æ­£å¸¸/å¼‚å¸¸
- **å¤–éƒ¨APIçŠ¶æ€**: å„APIæœåŠ¡çš„å“åº”çŠ¶æ€

```javascript
// ç›‘æ§é…ç½®ç¤ºä¾‹
const healthMetrics = {
  n8n_service: {
    endpoint: 'http://localhost:5678/rest/active',
    timeout: 5000,
    expected_status: 200
  },
  notion_api: {
    endpoint: 'https://api.notion.com/v1/users/me',
    timeout: 10000,
    expected_status: 200
  },
  openai_api: {
    endpoint: 'https://api.openai.com/v1/models',
    timeout: 10000,
    expected_status: 200
  },
  huoniao_api: {
    endpoint: 'https://hawaiihub.net/include/ajax.php',
    timeout: 15000,
    expected_status: 200
  }
};
```

#### èµ„æºä½¿ç”¨æƒ…å†µ
- **CPUä½¿ç”¨ç‡**: å½“å‰/å¹³å‡/å³°å€¼
- **å†…å­˜ä½¿ç”¨ç‡**: å½“å‰/å¹³å‡/å³°å€¼
- **ç£ç›˜ä½¿ç”¨ç‡**: å½“å‰ä½¿ç”¨é‡å’Œå¯ç”¨ç©ºé—´
- **ç½‘ç»œI/O**: å…¥ç«™/å‡ºç«™æµé‡

### 2. å·¥ä½œæµæ‰§è¡ŒæŒ‡æ ‡

#### æ‰§è¡Œç»Ÿè®¡
- **æ€»æ‰§è¡Œæ¬¡æ•°**: 24å°æ—¶/7å¤©/30å¤©
- **æˆåŠŸæ‰§è¡Œæ¬¡æ•°**: æˆåŠŸç‡ç»Ÿè®¡
- **å¤±è´¥æ‰§è¡Œæ¬¡æ•°**: å¤±è´¥ç‡å’Œé”™è¯¯åˆ†ç±»
- **å¹³å‡æ‰§è¡Œæ—¶é—´**: å„é˜¶æ®µè€—æ—¶åˆ†æ

```json
{
  "workflow_metrics": {
    "total_executions": 1440,
    "successful_executions": 1397,
    "failed_executions": 43,
    "success_rate": "97.01%",
    "average_execution_time": "4.2 minutes",
    "execution_breakdown": {
      "content_collection": "1.8 minutes",
      "ai_processing": "1.5 minutes",
      "notion_storage": "0.4 minutes",
      "firebird_publishing": "0.5 minutes"
    }
  }
}
```

#### å†…å®¹å¤„ç†æŒ‡æ ‡
- **é‡‡é›†å†…å®¹æ•°é‡**: å„æºé‡‡é›†ç»Ÿè®¡
- **å¤„ç†é€šè¿‡ç‡**: AIè¿‡æ»¤é€šè¿‡çš„å†…å®¹æ¯”ä¾‹
- **å‘å¸ƒæˆåŠŸç‡**: æˆåŠŸå‘å¸ƒåˆ°ç«é¸Ÿé—¨æˆ·çš„æ¯”ä¾‹
- **é‡å¤å†…å®¹æ£€æµ‹**: å»é‡æ•ˆæœç»Ÿè®¡

### 3. ä¸šåŠ¡æŒ‡æ ‡

#### å†…å®¹è´¨é‡
- **å¹³å‡è´¨é‡åˆ†æ•°**: AIè¯„ä¼°çš„å†…å®¹è´¨é‡
- **åˆ†ç±»å‡†ç¡®ç‡**: è‡ªåŠ¨åˆ†ç±»çš„å‡†ç¡®æ€§
- **ç”¨æˆ·å‚ä¸åº¦**: å‘å¸ƒå†…å®¹çš„é˜…è¯»é‡å’Œäº’åŠ¨

#### æ•°æ®æºè¡¨ç°
- **RSSæºå¯ç”¨æ€§**: å„RSSæºçš„å¯ç”¨æ€§ç»Ÿè®¡
- **APIå“åº”æ—¶é—´**: å„å¤–éƒ¨APIçš„å“åº”æ€§èƒ½
- **æ•°æ®è·å–æˆåŠŸç‡**: å„æ•°æ®æºçš„æˆåŠŸè·å–ç‡

## ä»ªè¡¨æ¿é…ç½®

### ä¸»ä»ªè¡¨æ¿å¸ƒå±€

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµç›‘æ§ä»ªè¡¨æ¿</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .dashboard-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }
        .metric-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .metric-value {
            font-size: 2em;
            font-weight: bold;
            color: #2563eb;
        }
        .metric-label {
            color: #6b7280;
            margin-top: 5px;
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-online { background-color: #10b981; }
        .status-offline { background-color: #ef4444; }
        .status-warning { background-color: #f59e0b; }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- ç³»ç»ŸçŠ¶æ€å¡ç‰‡ -->
        <div class="metric-card">
            <h3>ç³»ç»ŸçŠ¶æ€</h3>
            <div id="system-status">
                <div><span class="status-indicator status-online"></span>n8næœåŠ¡: åœ¨çº¿</div>
                <div><span class="status-indicator status-online"></span>Notion API: æ­£å¸¸</div>
                <div><span class="status-indicator status-online"></span>OpenAI API: æ­£å¸¸</div>
                <div><span class="status-indicator status-warning"></span>ç«é¸ŸAPI: å»¶è¿Ÿ</div>
            </div>
        </div>

        <!-- æ‰§è¡Œç»Ÿè®¡å¡ç‰‡ -->
        <div class="metric-card">
            <h3>ä»Šæ—¥æ‰§è¡Œç»Ÿè®¡</h3>
            <div class="metric-value" id="total-executions">48</div>
            <div class="metric-label">æ€»æ‰§è¡Œæ¬¡æ•°</div>
            <div style="margin-top: 10px;">
                <div>æˆåŠŸ: <span style="color: #10b981;">46</span></div>
                <div>å¤±è´¥: <span style="color: #ef4444;">2</span></div>
                <div>æˆåŠŸç‡: <span style="color: #10b981;">95.8%</span></div>
            </div>
        </div>

        <!-- æ€§èƒ½æŒ‡æ ‡å¡ç‰‡ -->
        <div class="metric-card">
            <h3>æ€§èƒ½æŒ‡æ ‡</h3>
            <div>
                <div>å¹³å‡æ‰§è¡Œæ—¶é—´: <strong>4.2åˆ†é’Ÿ</strong></div>
                <div>CPUä½¿ç”¨ç‡: <strong>45%</strong></div>
                <div>å†…å­˜ä½¿ç”¨ç‡: <strong>62%</strong></div>
                <div>ç£ç›˜ä½¿ç”¨ç‡: <strong>78%</strong></div>
            </div>
        </div>

        <!-- å†…å®¹ç»Ÿè®¡å¡ç‰‡ -->
        <div class="metric-card">
            <h3>å†…å®¹ç»Ÿè®¡</h3>
            <div class="metric-value" id="content-processed">156</div>
            <div class="metric-label">ä»Šæ—¥å¤„ç†å†…å®¹</div>
            <div style="margin-top: 10px;">
                <div>å·²å‘å¸ƒ: <span style="color: #10b981;">142</span></div>
                <div>å·²æ‹’ç»: <span style="color: #ef4444;">14</span></div>
                <div>é€šè¿‡ç‡: <span style="color: #10b981;">91.0%</span></div>
            </div>
        </div>

        <!-- æ‰§è¡Œæ—¶é—´è¶‹åŠ¿å›¾ -->
        <div class="metric-card" style="grid-column: span 2;">
            <h3>æ‰§è¡Œæ—¶é—´è¶‹åŠ¿</h3>
            <canvas id="execution-time-chart" width="400" height="200"></canvas>
        </div>

        <!-- æ•°æ®æºçŠ¶æ€ -->
        <div class="metric-card">
            <h3>æ•°æ®æºçŠ¶æ€</h3>
            <div id="data-sources">
                <div><span class="status-indicator status-online"></span>The Neuron: æ­£å¸¸</div>
                <div><span class="status-indicator status-online"></span>Futurepedia: æ­£å¸¸</div>
                <div><span class="status-indicator status-warning"></span>Superhuman: å»¶è¿Ÿ</div>
                <div><span class="status-indicator status-online"></span>The Rundown AI: æ­£å¸¸</div>
            </div>
        </div>

        <!-- æœ€è¿‘é”™è¯¯ -->
        <div class="metric-card">
            <h3>æœ€è¿‘é”™è¯¯</h3>
            <div id="recent-errors">
                <div style="font-size: 0.9em; margin-bottom: 5px;">
                    <span style="color: #ef4444;">14:32</span> - Notion APIè¶…æ—¶
                </div>
                <div style="font-size: 0.9em; margin-bottom: 5px;">
                    <span style="color: #f59e0b;">13:45</span> - RSSæºå“åº”æ…¢
                </div>
                <div style="font-size: 0.9em;">
                    <span style="color: #ef4444;">12:18</span> - ç«é¸ŸAPIè°ƒç”¨å¤±è´¥
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ‰§è¡Œæ—¶é—´è¶‹åŠ¿å›¾
        const ctx = document.getElementById('execution-time-chart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00'],
                datasets: [{
                    label: 'å¹³å‡æ‰§è¡Œæ—¶é—´(åˆ†é’Ÿ)',
                    data: [3.8, 4.2, 4.5, 4.1, 3.9, 4.3],
                    borderColor: '#2563eb',
                    backgroundColor: 'rgba(37, 99, 235, 0.1)',
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'æ‰§è¡Œæ—¶é—´(åˆ†é’Ÿ)'
                        }
                    }
                }
            }
        });

        // å®æ—¶æ•°æ®æ›´æ–°
        function updateDashboard() {
            fetch('/api/metrics')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('total-executions').textContent = data.totalExecutions;
                    document.getElementById('content-processed').textContent = data.contentProcessed;
                    // æ›´æ–°å…¶ä»–æŒ‡æ ‡...
                })
                .catch(error => console.error('æ›´æ–°ä»ªè¡¨æ¿æ•°æ®å¤±è´¥:', error));
        }

        // æ¯30ç§’æ›´æ–°ä¸€æ¬¡æ•°æ®
        setInterval(updateDashboard, 30000);
    </script>
</body>
</html>
```

### ç›‘æ§APIç«¯ç‚¹

```javascript
// monitoring-api.js - ç›‘æ§æ•°æ®APIæœåŠ¡
const express = require('express');
const app = express();

// è·å–å®æ—¶æŒ‡æ ‡
app.get('/api/metrics', async (req, res) => {
    try {
        const metrics = await collectMetrics();
        res.json(metrics);
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

// è·å–ç³»ç»Ÿå¥åº·çŠ¶æ€
app.get('/api/health', async (req, res) => {
    try {
        const health = await checkSystemHealth();
        res.json(health);
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

// è·å–æ‰§è¡Œå†å²
app.get('/api/executions', async (req, res) => {
    try {
        const { limit = 50, offset = 0 } = req.query;
        const executions = await getExecutionHistory(limit, offset);
        res.json(executions);
    } catch (error) {
        res.status(500).json({ error: error.message });
    }
});

async function collectMetrics() {
    const [systemMetrics, workflowMetrics, contentMetrics] = await Promise.all([
        getSystemMetrics(),
        getWorkflowMetrics(),
        getContentMetrics()
    ]);

    return {
        timestamp: new Date().toISOString(),
        system: systemMetrics,
        workflow: workflowMetrics,
        content: contentMetrics
    };
}

async function getSystemMetrics() {
    // è·å–ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
    const usage = await getResourceUsage();
    
    return {
        cpu_usage: usage.cpu,
        memory_usage: usage.memory,
        disk_usage: usage.disk,
        network_io: usage.network
    };
}

async function getWorkflowMetrics() {
    // è·å–å·¥ä½œæµæ‰§è¡Œç»Ÿè®¡
    const executions = await getRecentExecutions();
    
    const total = executions.length;
    const successful = executions.filter(e => e.status === 'success').length;
    const failed = executions.filter(e => e.status === 'error').length;
    
    return {
        total_executions: total,
        successful_executions: successful,
        failed_executions: failed,
        success_rate: total > 0 ? (successful / total * 100).toFixed(2) + '%' : '0%',
        average_execution_time: calculateAverageExecutionTime(executions)
    };
}

async function checkSystemHealth() {
    const services = [
        { name: 'n8n', url: 'http://localhost:5678/rest/active' },
        { name: 'notion', url: 'https://api.notion.com/v1/users/me' },
        { name: 'openai', url: 'https://api.openai.com/v1/models' },
        { name: 'huoniao', url: 'https://hawaiihub.net/include/ajax.php' }
    ];

    const healthChecks = await Promise.allSettled(
        services.map(service => checkServiceHealth(service))
    );

    return services.map((service, index) => ({
        name: service.name,
        status: healthChecks[index].status === 'fulfilled' ? 'online' : 'offline',
        response_time: healthChecks[index].value?.responseTime || null,
        error: healthChecks[index].reason?.message || null
    }));
}

app.listen(3001, () => {
    console.log('ç›‘æ§APIæœåŠ¡å¯åŠ¨åœ¨ç«¯å£ 3001');
});
```

## å‘Šè­¦é…ç½®

### å‘Šè­¦è§„åˆ™

```json
{
  "alert_rules": [
    {
      "name": "å·¥ä½œæµæ‰§è¡Œå¤±è´¥ç‡è¿‡é«˜",
      "condition": "workflow_failure_rate > 5%",
      "severity": "critical",
      "notification_channels": ["slack", "email"],
      "cooldown": "15m"
    },
    {
      "name": "ç³»ç»Ÿèµ„æºä½¿ç”¨ç‡è¿‡é«˜",
      "condition": "cpu_usage > 80% OR memory_usage > 85%",
      "severity": "warning",
      "notification_channels": ["slack"],
      "cooldown": "10m"
    },
    {
      "name": "å¤–éƒ¨APIå“åº”æ—¶é—´è¿‡é•¿",
      "condition": "api_response_time > 10s",
      "severity": "warning",
      "notification_channels": ["slack"],
      "cooldown": "5m"
    },
    {
      "name": "ç£ç›˜ç©ºé—´ä¸è¶³",
      "condition": "disk_usage > 90%",
      "severity": "critical",
      "notification_channels": ["slack", "email", "sms"],
      "cooldown": "30m"
    },
    {
      "name": "å†…å®¹å‘å¸ƒæˆåŠŸç‡è¿‡ä½",
      "condition": "content_publish_rate < 95%",
      "severity": "warning",
      "notification_channels": ["slack"],
      "cooldown": "20m"
    }
  ]
}
```

### é€šçŸ¥é…ç½®

```javascript
// notification-config.js
const notificationConfig = {
  slack: {
    webhook_url: process.env.SLACK_WEBHOOK_URL,
    channel: '#alerts',
    username: 'NewsWorkflow Bot',
    icon_emoji: ':warning:'
  },
  email: {
    smtp_server: process.env.SMTP_SERVER,
    smtp_port: process.env.SMTP_PORT,
    username: process.env.SMTP_USERNAME,
    password: process.env.SMTP_PASSWORD,
    from: 'alerts@newsworkflow.com',
    to: ['admin@example.com', 'ops@example.com']
  },
  webhook: {
    url: process.env.WEBHOOK_ALERT_URL,
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${process.env.WEBHOOK_TOKEN}`
    }
  }
};

// å‘é€å‘Šè­¦é€šçŸ¥
async function sendAlert(alert, channels) {
    const promises = channels.map(channel => {
        switch (channel) {
            case 'slack':
                return sendSlackAlert(alert);
            case 'email':
                return sendEmailAlert(alert);
            case 'webhook':
                return sendWebhookAlert(alert);
            default:
                console.warn(`æœªçŸ¥çš„é€šçŸ¥æ¸ é“: ${channel}`);
        }
    });

    await Promise.allSettled(promises);
}

async function sendSlackAlert(alert) {
    const payload = {
        text: `ğŸš¨ ${alert.name}`,
        attachments: [{
            color: alert.severity === 'critical' ? 'danger' : 'warning',
            fields: [
                { title: 'ä¸¥é‡ç¨‹åº¦', value: alert.severity, short: true },
                { title: 'æ—¶é—´', value: new Date().toISOString(), short: true },
                { title: 'è¯¦æƒ…', value: alert.description, short: false }
            ]
        }]
    };

    const response = await fetch(notificationConfig.slack.webhook_url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
    });

    if (!response.ok) {
        throw new Error(`Slacké€šçŸ¥å‘é€å¤±è´¥: ${response.statusText}`);
    }
}
```

## æŠ¥å‘Šæ¨¡æ¿

### æ—¥æŠ¥æ¨¡æ¿

```javascript
// daily-report-template.js
async function generateDailyReport(date = new Date()) {
    const report = {
        date: date.toISOString().split('T')[0],
        summary: await getDailySummary(date),
        metrics: await getDailyMetrics(date),
        issues: await getDailyIssues(date),
        recommendations: await getDailyRecommendations(date)
    };

    return formatDailyReport(report);
}

function formatDailyReport(report) {
    return `
# è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµæ—¥æŠ¥ - ${report.date}

## ğŸ“Š æ‰§è¡Œæ¦‚å†µ

- **æ€»æ‰§è¡Œæ¬¡æ•°**: ${report.summary.total_executions}
- **æˆåŠŸæ‰§è¡Œ**: ${report.summary.successful_executions} (${report.summary.success_rate})
- **å¤±è´¥æ‰§è¡Œ**: ${report.summary.failed_executions}
- **å¹³å‡æ‰§è¡Œæ—¶é—´**: ${report.summary.average_execution_time}

## ğŸ“ˆ å…³é”®æŒ‡æ ‡

### å†…å®¹å¤„ç†
- **é‡‡é›†å†…å®¹æ•°é‡**: ${report.metrics.content_collected}
- **å¤„ç†é€šè¿‡æ•°é‡**: ${report.metrics.content_processed}
- **å‘å¸ƒæˆåŠŸæ•°é‡**: ${report.metrics.content_published}
- **å†…å®¹é€šè¿‡ç‡**: ${report.metrics.content_pass_rate}

### ç³»ç»Ÿæ€§èƒ½
- **å¹³å‡CPUä½¿ç”¨ç‡**: ${report.metrics.avg_cpu_usage}
- **å¹³å‡å†…å­˜ä½¿ç”¨ç‡**: ${report.metrics.avg_memory_usage}
- **ç£ç›˜ä½¿ç”¨ç‡**: ${report.metrics.disk_usage}
- **ç½‘ç»œæµé‡**: ${report.metrics.network_traffic}

### APIæ€§èƒ½
- **Notion APIå¹³å‡å“åº”æ—¶é—´**: ${report.metrics.notion_response_time}
- **OpenAI APIå¹³å‡å“åº”æ—¶é—´**: ${report.metrics.openai_response_time}
- **ç«é¸ŸAPIå¹³å‡å“åº”æ—¶é—´**: ${report.metrics.huoniao_response_time}

## âš ï¸ é—®é¢˜å’Œå¼‚å¸¸

${report.issues.map(issue => `
### ${issue.title}
- **å‘ç”Ÿæ—¶é—´**: ${issue.timestamp}
- **ä¸¥é‡ç¨‹åº¦**: ${issue.severity}
- **å½±å“èŒƒå›´**: ${issue.impact}
- **è§£å†³çŠ¶æ€**: ${issue.status}
- **è¯¦ç»†æè¿°**: ${issue.description}
`).join('\n')}

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

${report.recommendations.map(rec => `
- **${rec.category}**: ${rec.suggestion}
  - é¢„æœŸæ•ˆæœ: ${rec.expected_impact}
  - å®æ–½éš¾åº¦: ${rec.difficulty}
`).join('\n')}

## ğŸ“‹ æ˜æ—¥è®¡åˆ’

- [ ] ç›‘æ§ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
- [ ] æ£€æŸ¥APIå‡­æ®æœ‰æ•ˆæ€§
- [ ] æ¸…ç†è¿‡æœŸæ—¥å¿—æ–‡ä»¶
- [ ] éªŒè¯å¤‡ä»½å®Œæ•´æ€§

---
*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: ${new Date().toISOString()}*
*ä¸‹ä¸€æ¬¡æŠ¥å‘Š: ${new Date(Date.now() + 24*60*60*1000).toISOString().split('T')[0]}*
`;
}
```

### å‘¨æŠ¥æ¨¡æ¿

```javascript
// weekly-report-template.js
async function generateWeeklyReport(startDate, endDate) {
    const report = {
        period: `${startDate.toISOString().split('T')[0]} è‡³ ${endDate.toISOString().split('T')[0]}`,
        overview: await getWeeklyOverview(startDate, endDate),
        trends: await getWeeklyTrends(startDate, endDate),
        performance: await getWeeklyPerformance(startDate, endDate),
        issues: await getWeeklyIssues(startDate, endDate),
        improvements: await getWeeklyImprovements(startDate, endDate)
    };

    return formatWeeklyReport(report);
}

function formatWeeklyReport(report) {
    return `
# è‡ªåŠ¨åŒ–æ–°é—»å·¥ä½œæµå‘¨æŠ¥

**æŠ¥å‘Šå‘¨æœŸ**: ${report.period}

## ğŸ“Š æ•´ä½“æ¦‚å†µ

### æ‰§è¡Œç»Ÿè®¡
- **æ€»æ‰§è¡Œæ¬¡æ•°**: ${report.overview.total_executions}
- **å¹³å‡æ—¥æ‰§è¡Œæ¬¡æ•°**: ${report.overview.avg_daily_executions}
- **æ•´ä½“æˆåŠŸç‡**: ${report.overview.overall_success_rate}
- **è¾ƒä¸Šå‘¨å˜åŒ–**: ${report.overview.week_over_week_change}

### å†…å®¹ç»Ÿè®¡
- **æ€»é‡‡é›†å†…å®¹**: ${report.overview.total_content_collected}
- **æ€»å‘å¸ƒå†…å®¹**: ${report.overview.total_content_published}
- **å†…å®¹è´¨é‡è¯„åˆ†**: ${report.overview.avg_content_quality}

## ğŸ“ˆ è¶‹åŠ¿åˆ†æ

### æ‰§è¡Œæ—¶é—´è¶‹åŠ¿
${report.trends.execution_time_trend}

### æˆåŠŸç‡è¶‹åŠ¿
${report.trends.success_rate_trend}

### å†…å®¹é‡è¶‹åŠ¿
${report.trends.content_volume_trend}

## ğŸ¯ æ€§èƒ½åˆ†æ

### æœ€ä½³è¡¨ç°
- **æœ€å¿«æ‰§è¡Œæ—¶é—´**: ${report.performance.fastest_execution}
- **æœ€é«˜æˆåŠŸç‡æ—¥æœŸ**: ${report.performance.best_success_rate_date}
- **æœ€é«˜å†…å®¹è´¨é‡**: ${report.performance.highest_quality_content}

### éœ€è¦æ”¹è¿›
- **æœ€æ…¢æ‰§è¡Œæ—¶é—´**: ${report.performance.slowest_execution}
- **æœ€ä½æˆåŠŸç‡æ—¥æœŸ**: ${report.performance.worst_success_rate_date}
- **ä¸»è¦ç“¶é¢ˆ**: ${report.performance.main_bottlenecks}

## ğŸ”§ ç³»ç»Ÿæ”¹è¿›

### æœ¬å‘¨å®æ–½çš„æ”¹è¿›
${report.improvements.implemented.map(imp => `- ${imp}`).join('\n')}

### è®¡åˆ’ä¸­çš„æ”¹è¿›
${report.improvements.planned.map(imp => `- ${imp}`).join('\n')}

## ğŸ“‹ ä¸‹å‘¨è®¡åˆ’

- [ ] æ€§èƒ½ä¼˜åŒ–å®æ–½
- [ ] ç›‘æ§è§„åˆ™è°ƒæ•´
- [ ] å¤‡ä»½ç­–ç•¥éªŒè¯
- [ ] å®‰å…¨å®¡è®¡æ‰§è¡Œ

---
*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: ${new Date().toISOString()}*
`;
}
```

## ä½¿ç”¨æŒ‡å—

### å¯åŠ¨ç›‘æ§ç³»ç»Ÿ

```bash
# 1. å¯åŠ¨ç›‘æ§APIæœåŠ¡
node monitoring-api.js

# 2. å¯åŠ¨ä»ªè¡¨æ¿æœåŠ¡
python -m http.server 8080 --directory dashboard/

# 3. é…ç½®å‘Šè­¦è§„åˆ™
node scripts/setup-alerting.js

# 4. å¯åŠ¨æŠ¥å‘Šç”Ÿæˆå™¨
node scripts/start-report-generator.js
```

### è®¿é—®ä»ªè¡¨æ¿

- **ä¸»ä»ªè¡¨æ¿**: http://localhost:8080
- **ç›‘æ§API**: http://localhost:3001/api/metrics
- **å¥åº·æ£€æŸ¥**: http://localhost:3001/api/health

### ç”ŸæˆæŠ¥å‘Š

```bash
# ç”Ÿæˆä»Šæ—¥æŠ¥å‘Š
node scripts/generate-daily-report.js

# ç”Ÿæˆæœ¬å‘¨æŠ¥å‘Š
node scripts/generate-weekly-report.js

# ç”Ÿæˆè‡ªå®šä¹‰æ—¶é—´æ®µæŠ¥å‘Š
node scripts/generate-custom-report.js --start=2025-01-01 --end=2025-01-07
```

### é…ç½®å‘Šè­¦

```bash
# è®¾ç½®Slackå‘Šè­¦
export SLACK_WEBHOOK_URL="https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# è®¾ç½®é‚®ä»¶å‘Šè­¦
export SMTP_SERVER="smtp.example.com"
export SMTP_USERNAME="alerts@example.com"
export SMTP_PASSWORD="your_password"

# åº”ç”¨å‘Šè­¦é…ç½®
node scripts/apply-alert-config.js
```

---

*æœ€åæ›´æ–°: 2025å¹´1æœˆ*