<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset={#$cfg_soft_lang#}" />
<title>新增运费模板</title>
<link rel="stylesheet" href="/static/css/admin/ace.min.css?v={#$cfg_staticVersion#}">
<link rel="stylesheet" href="/static/css/admin/font-awesome.min.css?v={#$cfg_staticVersion#}">
<link rel="stylesheet" href="/static/css/ui/element_ui_index.css?v={#$cfg_staticVersion#}">
{#$cssFile#}
<script type="text/javascript" src="/static/js/vue/vue.js"></script>
<script src="/static/js/ui/element_ui_index.js"></script>
<script type="text/javascript" src="/static/js/vue/axios.min.js"></script>
<script type="text/javascript">
var staticPath  = '{#$cfg_staticPath#}';
    var adminPath = '{#$adminPath#}', sid = {#$sid#};
    var valuation = '{#$valuation#}'
    var freeArea  = '{#$freeArea#}'
    var opennospecify  = '{#$opennospecify#}'

    var logisticArea_arr = '{#$deliveryarea#}';
    var logisticAreaJson;
    var logisticArr = [];
    if(logisticArea_arr!=''){
      logisticAreaJson = JSON.parse(logisticArea_arr);
      for(let i in logisticAreaJson){
        var item = logisticAreaJson[i];
        logisticArr.push(item)
      }
    }

    var freeArr = '{#$specify#}';
    var freeArrAreaJson;
    var freeArea_arr = [];
    if(freeArr!=''){
      freeArrAreaJson = JSON.parse(freeArr);
      for(let i in freeArrAreaJson){
        var item = freeArrAreaJson[i];
        freeArea_arr.push(item)
      }
    }


    var noFreeaArr = {#if $nospecify!=''#}{#$nospecify#}{#else#}[]{#/if#};
    var logistype = '{#$logistype|default:0#}'; // 配送类型
    var delivery_fee_mode = '{#$delivery_fee_mode|default:0#}'; // 配送类型
    var range_delivery_fee_valuearr = '{#json_encode($range_delivery_fee_valuearr)#}';
</script>
</head>

<body>
<form action="" method="post" name="editform" id="editform" class="editform w-form shopForm">
  <input type="hidden" name="id" id="id" value="{#$id#}" />
  <input type="hidden" name="sid" id="sid" value="{#$sid#}" />
  <input type="hidden" name="dopost" id="dopost" value="{#$dopost#}" />
  <input type="hidden" name="token" id="token" value="{#$token#}" />

  <div class="confirmTab">
    <strong><font style="color: #FF0000">*</font>运费类型：</strong>
    <ul>
      <li :class="{'active':logistype != '1'}" data-id="0" @click="logistype = 0"><a href="javascript:;"><i><s></s></i>快递邮寄</a></li>
      <li :class="{'active':logistype != '0'}" data-id="1" @click="logistype = '1'"><a href="javascript:;"><i><s></s></i>商家配送</a></li>
    </ul>
    <input type="hidden" name="logistype" :value="logistype" id="logistype">
  </div>
<!-- 快递配送s -->
  <div class="templateBox" v-if="logistype != '1'">
    <dl class="clearfix">
      <dt><label for="title">名称：</label></dt>
      <dd><input class="input-xlarge" type="text" name="title" id="title" data-regex=".{2,60}" maxlength="60" value="{#$title#}" /></dd>
    </dl>
    <!-- 运费说明 -->
    <dl class="fn-clear" data-required="1">
      <dt>运费说明：</dt>
      <dd><textarea class="text" name="content" id="content" maxlength="200" value="{#$content#}"> {#$content#} </textarea></dd>
    </dl>



    <div id="freight">
      <dl class="fn-clear">
        <dt>{#$langData['siteConfig'][26][110]#}：</dt>
        <dd>
          <div class="radio valuation">
            <span data-id="0" @click="valuation = 0" :class="{'curr':valuation == 0 }">{#$langData['siteConfig'][26][111]#}</span>
            <span data-id="1" @click="valuation = 1" :class="{'curr':valuation == '1'}">{#$langData['siteConfig'][26][112]#}</span>
            <span data-id="2" @click="valuation = 2" :class="{'curr':valuation == '2'}">{#$langData['siteConfig'][26][113]#}</span>
            <input type="hidden" name="valuation" id="valuation" :value="valuation">
          </div>
          <span class="input-tips" style="display:inline-block;"><s></s>注意：团购套餐类型的商品只能使用按件数计价的方式</span>
        </dd>
      </dl>
      <!-- 配送运费及区域 -->
      <dl class="fn-clear" data-required="1">
        <dt>配送运费及区域：</dt>
        <dd>
          <table class="logi_tb">
            <colgroup> <col width="30%"> <col width="15%"> <col width="15%"> <col width="15%"> <col width="15%"> <col width="10%"> </colgroup>
            <thead>
              <tr data-type="0" v-if="valuation == 0"> <th>可配送区域</th> <th>首件</th> <th>运费({#echoCurrency type="short"#})</th> <th>续件</th> <th>续费({#echoCurrency type="short"#})</th> <th>操作</th> </tr>
              <tr data-type="1" v-if="valuation == 1"> <th>可配送区域</th> <th>首件重量(kg)</th> <th>运费({#echoCurrency type="short"#})</th> <th>续件重量(kg)</th> <th>续费({#echoCurrency type="short"#})</th> <th>操作</th> </tr>
              <tr data-type="2" v-if="valuation == 2"> <th>可配送区域</th> <th>首件体积(m³)</th> <th>运费({#echoCurrency type="short"#})</th> <th>续件体积(m³)</th> <th>续费({#echoCurrency type="short"#})</th> <th>操作</th> </tr>
            </thead>
            <tbody v-cloak>
              <tr v-for="(item,i) in logisticArea_arr">
                <td >
                  <el-cascader v-if="i != 0" v-model="item.area"	:props="props" :options="options" collapse-tags clearable filterable></el-cascader>
                  <!-- <div class="selectBox"  > -->
                  <!-- <s class="arr"></s> -->
                  <!-- <input v-else type="text" name="addr[]"  placeholder="请选择" "> -->
                  <!-- </div> -->
                  <span v-else>默认全国</span>
                </td>

                <td>
                  <div class="inpbox">
                    <input type="text" name="express_start" v-model="item.express_start" @input="checkInp(logisticArea_arr,i,'express_start','int')">
                    <div class="btn_group">
                      <i class="add" @click="item.express_start++"></i>
                      <i :class="['sub', {'noClick':item.express_start <= 1}]" @click="item.express_start--;item.express_start = item.express_start<1?1: item.express_start"></i>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="inpbox">
                    <input type="text" name="express_postage" v-model="item.express_postage" @input="checkInp(logisticArea_arr,i,'express_postage')">
                    <div class="btn_group">
                      <i class="add" @click="item.express_postage++"></i>
                      <i :class="['sub', {'noClick':item.express_postage <= 0}]"  @click="item.express_postage--;item.express_postage = item.express_postage<0?0: item.express_postage" ></i>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="inpbox">
                    <input type="text" name="express_plus" v-model="item.express_plus" @input="checkInp(logisticArea_arr,i,'express_plus','int')">
                    <div class="btn_group">
                      <i class="add" @click="item.express_plus++"></i>
                      <i :class="['sub', {'noClick':item.express_plus<=1}]" @click="item.express_plus--; item.express_plus = item.express_plus<1?1: item.express_plus;"></i>
                    </div>
                  </div>
                </td>
                <td>
                  <div class="inpbox">
                    <input type="text" name="express_postageplus"  v-model="item.express_postageplus" @input="checkInp(logisticArea_arr,i,'express_postageplus')">
                    <div class="btn_group">
                      <i class="add" @click="item.express_postageplus++"></i>
                      <i :class="['sub', {'noClick':item.express_postageplus <= 0}]"@click="item.express_postageplus--; item.express_postageplus = item.express_postageplus<0?0: item.express_postageplus;"></i>
                    </div>
                  </div>
                </td>
                <td><a href="javascript:;" v-if="i!=0" class="del_btn" @click="del_tb(logisticArea_arr,i)">删除</a></td>
              </tr>
            </tbody>
          </table>
          <a href="javascript:;" class="add_logi_tr" @click="addAreaLogi(2)">添加配送区域</a>
        </dd>
      </dl>
    </div>

    <!-- 指定地区包邮 -->
    <div class="freeArea">
      <dl class="fn-clear">
        <dt>指定包邮：</dt>
        <dd>
          <div class="radio ">
            <span  :class="{'curr':!freeArea}" @click="freeArea = 0">关闭</span>
            <span  :class="{'curr':freeArea}" @click="freeArea = 1">开启</span>
            <input type="hidden" name="freeArea" id="" :value="freeArea">
          </div>
        </dd>
      </dl>
      <dl class="fn-clear" v-show="freeArea">
        <dt></dt>
        <dd>
          <table class="logi_tb">
            <colgroup> <col width="35%"> <col width="25%"> <col width="25%"> <col width="15%"> </colgroup>
            <thead>
              <tr>
                <th>选择地区</th>
                <th>最低购买件数</th>
                <th>最低购买金额（{#echoCurrency type='short'#}）</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr v-for="(item,i) in freeArr">
                <td><el-cascader v-model="item.area"  	:props="props" :options="options"  collapse-tags
                  clearable filterable></el-cascader></td>
                  <td>
                    <div class="inpbox">
                      <input type="text" name="preferentialStandard" @input="checkInp(freeArr,i,'preferentialStandard','int')" v-model="item.preferentialStandard">
                      <div class="btn_group">
                        <i class="add" @click="item.min_num++"></i>
                        <i :class="['sub', {'noClick':item.min_num <= 1}]" @click="item.min_num--;item.min_num = item.min_num>=1?item.min_num: 1"></i>
                      </div>
                    </div>
                  </td>
                  <td>
                    <div class="inpbox">
                      <input type="text" name="preferentialMoney" v-model="item.preferentialMoney" @input="checkInp(freeArr,i,'preferentialMoney')">
                      <div class="btn_group">
                        <i class="add" @click="item.min_amount++"></i>
                        <i :class="['sub', {'noClick':item.min_amount <= 0.01}]" @click="item.min_amount--;item.min_amount = item.min_amount<0?0.01: parseFloat(item.min_amount.toFixed(2))"></i>
                      </div>
                    </div>
                  </td>
                  <td><a href="javascript:;" class="del_btn" @click="del_tb(freeArr,i)">删除</a></td>
                </tr>
              </tbody>
            </table>
            <a href="javascript:;" class="add_logi_tr" @click="addAreaLogi(1)">添加指定包邮区域</a>
          </dd>
        </dl>
      </div>

      <!-- 指定区域不配送 -->
      <dl class="fn-clear">
        <dt>指定区域不配送：</dt>
        <dd>
          <div class="radio ">
            <span  :class="{'curr':!noFreeArea}" @click="noFreeArea = 0">关闭</span>
            <span  :class="{'curr':noFreeArea}" @click="noFreeArea = 1">开启</span>
            <input type="hidden" name="noFreeArea" id="" :value="noFreeArea">
          </div>
          <div style="clear:both;" v-show="noFreeArea" ><el-cascader  v-model="noFreeAreaArr"  :props="props" :options="options"  collapse-tags clearable filterable></el-cascader></div>
        </dd>
      </dl>

  </div>
<!-- 快递配送e -->
<!-- ******************************************** -->
<!-- 商家配送 s -->
  <div class="templateBox" v-else>
    <!-- 模板名称 -->
    <dl class="fn-clear" data-required="1">
      <dt><span>*</span>{#$langData['siteConfig'][19][547]#}：</dt>
      <dd>
        <input type="text" name="title" class="inp title" id="title" size="39" maxlength="50" value="{#$title#}" data-title="请输入模板名称"/>
        <span class="tip-inline"></span>
      </dd>
    </dl>
    <!-- 运费说明 -->
    <dl class="fn-clear">
      <dt><span>*</span>运费说明：</dt>
      <dd>
        <textarea class="text content" id="content" name="content" maxlength="200" value="{#$content#}" data-title="请输入运费说明">{#$content#}</textarea>
        <span class="tip-inline"></span>
      </dd>
    </dl>
    <dl class="fn-clear">
      <dt><span>*</span>起送价、配送模式：</dt>
      <dd>
        <select name="delivery_fee_mode" id="delivery_fee_mode" v-model="feemodeval" class="input-large">
                    <option value="0" selected="selected">固定配送费/起送价</option>
                    <option value="1">按距离</option>
                  </select>
                  <div class="delivery_fee_mode widget-box" id="delivery_fee_mode0" v-if="feemodeval == 0">
                  <div class="widget-header"><h5>固定起送价和配送费</h5></div>
                    <div class="widget-body">
                      <div class="widget-main">
                          <div class="form-group fn-clear">
                            <label for="fixbasic">固定起送价</label>
                            <input size="10" maxlength="10" name="basicprice" id="fixbasic" type="text" value="{#$basicprice#}" data-title="请输入固定起送价"><span class="required">{#echoCurrency type='short'#}*</span>
                            <span class="tip-inline"></span>
                          </div>
                          <div class="form-group fn-clear">
                            <label for="fixfee">固定配送费</label>
                            <input size="10" maxlength="10" name="express_postage" id="fixfee" type="text" value="{#$express_postage#}" data-title="请输入固定配送费">
                            <span class="required">{#echoCurrency type='short'#}*</span>
                            <span class="tip-inline"></span>
                          </div>
                          <div class="form-group fn-clear">
                            <label for="fixjuli">最远配送距离</label>
                            <input size="10" maxlength="10" name="express_juli" id="fixjuli" type="text" value="{#$express_juli#}" data-title="请输入固定配送费">
                            <span class="required">公里</span>
                            <span class="tip-inline"></span>
                          </div>

                          <div class="form-group fn-clear">
                            <label>
                                <input name="openFree" value="1" type="hidden">
                                <span class="lbl"> 满</span>
                            </label>
                            <label>
                                <input size="10" maxlength="10" name="preferentialMoney" id="fixover" type="text" value="{#$preferentialMoney#}">
                               <span class="lbl">{#echoCurrency type='short'#}免配送费</span>
                            </label>
                            <span class="tip-inline"></span>
                          </div>
                      </div>
                    </div>
                </div>
                <div class="delivery_fee_mode widget-box" id="delivery_fee_mode1"  v-if="feemodeval == 1">
                  <div class="widget-header"><h5>设置不同配送距离的外送费和起送价</h5></div>
                  <div class="widget-body">
                    <div class="widget-main ">
                        <div class="lievf">
                          <div class="btn btn-sm btn-success addrangedeliveryfee" @click="addRange">添加不同距离外送费</div>
                          <div class="clear"></div>
                        </div>

                        <div class="rangedeliveryfee rangedeliveryfeeblock" v-for="item in rangedelivery_arr">
                        配送距离<input type="text" style="width:80px;" class="juliSt"  v-model="item[0]">公里至<input type="text" style="width:80px;" class="juliEd" v-model="item[1]">公里，外送费<input type="text" style="width:80px;" class="ranfee" v-model="item[2]">元，起送价<input type="text" style="width:80px;" class="ranbasic"  v-model="item[3]">元<div class="deleterangedeliveryfee" title="删除自定义显示项">删除</div>
                        </div>
                        <div id="rangedeliveryfeecontent"></div>
                        <div style="clear:both;"></div>
                    </div>
                  </div>
                </div>
      </dd>
    </dl>
  </div>
<!-- 商家配送 e-->
<dl class="clearfix formbtn">
  <dt>&nbsp;</dt>
  <dd><button class="btn btn-large btn-success" type="submit" name="button" @click.prevent="submit">确认提交</button></dd>
</dl>
</form>

{#$jsFile#}
</body>
</html>
