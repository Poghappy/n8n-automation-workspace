import{u as a,a as e,s as t,h as n,B as i,b as l,d as o,r as s,e as c,w as r,n as p,f as d,i as f,o as g,j as b,l as u,t as y,q as m,k as h,m as v,F as x,p as P,v as C,x as _,y as w}from"./index-BELzE-EM.js";import{_ as k,d as D,p as F,r as I,a as T,b as S,c as V,e as j}from"./sfcar.BcYzY1jm.js";var B,N;const U=d();const A=k({components:{popWarn:D},data:()=>({imgVersion:U.globalData.imgVersion,masterDomain:U.globalData.masterDomain,wh:U.globalData.navTop,imgPath:`${U.globalData.imgPath}/sfcar`,cityInfo:U.globalData.cityInfo,listdata:[],sfConfig:{},page:1,pageSize:10,activeIndex:1,tabConfig:[{cartype:"",orderby:1},{cartype:"",orderby:1}],startPlace:"",endPlace:"",callItem:{},warningb:!1,info:"",phoneData:{},payInfo:{},paypopb:!1,loadingb:!0,ajaxb:!1,fixPopb:!1,fixPopConb:!1,loadCardb:!1,privateb:!1,platForm:U.globalData.platForm,appBoolean:!1,Android:!1,pages:{},biasTop:0,navTop:0,shareLink:"",firstb:!0}),onLoad(a){B=this,U.globalData.imgVersion?B.imgVersion=U.globalData.imgVersion:U.watchG("imgVersion",(a=>{B.imgVersion=a})),-1==U.globalData.wxprivate?U.watchG("wxprivate",(function(e){B.wxprivate=e,e?B.privateb=!0:B.onload(a)})):U.globalData.wxprivate?B.privateb=!0:B.onload(a)},onShow(){B.firstb?B.firstb=!1:U.wxShareFn({title:`{${B.startPlace}}到{${B.endPlace}}(找顺风车)`,link:B.shareLink,imgUrl:B.sfConfig.sharePic,description:B.sfConfig.description})},methods:{onload(e){U.cachePage("sfcarIndex",this);let t=B.activeIndex;switch(e&&(t=e.type,B.activeIndex=t,B.tabConfig[t].cartype=e.cartype||"",B.tabConfig[t].orderby=e.orderby||1,B.startPlace=e.startaddr||"",B.endPlace=e.endaddr||""),B.configData(),B.tabFn("activeIndex",t,!0),B.platForm){case"web":B.appBoolean=window.appBoolean,B.cityInfo=window.cityInfo,B.navTop=!B.appBoolean&&a(88),B.shareLink=`${location.href}&fromShare=${U.globalData.userid}`,$('link[rel="canonical"]').attr("href",B.shareLink),$('meta[property="og:title"]').attr("content",B.sfConfig.channelName),$('meta[property="og:description"]').attr("content",B.sfConfig.description||""),window.setupWebViewJavascriptBridge((function(a){a.callHandler("setDragRefresh",{value:"off"},(function(){}))}));break;case"mp-weixin":B.biasTop=U.globalData.biasTop_88,B.navTop=a(88)}B.pages=U.pageFn(F)},async configData(){let a=await B.$ajax.post({url:U.encodeUrl("include/ajax.php?"),data:{service:"sfcar",action:"config"}});100==a.data.state&&(B.sfConfig=a.data.info,U.globalData.moduleConfig.sfcar=a.data.info,e({title:a.data.info.channelName})),U.wxShareFn({title:`{${B.startPlace}}到{${B.endPlace}}(找顺风车)`,link:B.shareLink,imgUrl:B.sfConfig.sharePic,description:B.sfConfig.description}),B.cacheData.sfConfig=B.sfConfig,t("sfcarIndex",B.cacheData)},directTopay(){B.paypopb=!0},async getPhonePayAmount(a){let e=`service=siteConfig&action=payPhoneDeal&aid=${a.aid}&temp=${a.temp}&module=${a.module}`;"mp-weixin"==U.globalData.platForm&&(e=e+"&appid="+U.globalData.appid);let t=U.encodeUrl(e),i=await B.$ajax.post({url:`include/ajax.php?${t}`});n();let l=i.data;100==l.state?(B.payInfo=l.info,U.globalData.appConfig&&U.globalData.appConfig.cfg_payPhone&&("mp-weixin"==B.platForm&&U.globalData.appConfig.cfg_payPhone.wxmini||"web"==B.platForm&&U.globalData.appBoolean&&window.Android&&U.globalData.appConfig.cfg_payPhone.tencentGDP_app_id&&U.globalData.appConfig.cfg_payPhone.tencentGDP_placement_id)?B.$refs.privatenumber.showRewardPop=!0:B.directTopay()):B.info=l.info},backFn(){U.backFn("/pages/packages/sfcar/index/index")},linkTo(a){if(a){if(B.appBoolean)return window.setupWebViewJavascriptBridge((function(e){e.callHandler("redirectNative",{name:"",code:"",link:a},(function(){}))})),!1;"web"==U.globalData.platForm?a.indexOf("http")>-1?location.href=a:i({url:a}):i({url:a.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(a):a})}},warnFn(a=2e3){B.warningb=!0,clearTimeout(N),N=setTimeout((a=>{B.warningb=!1}),a)},listFn(a,e=!1){B.ajaxb=!0,B.$ajax.post({url:U.encodeUrl("include/ajax.php?"),data:a}).then((a=>{100==a.data.state?(B.listdata=e?B.listdata.concat(a.data.info.list):[...a.data.info.list],a.data.info.list.length<B.pageSize?B.loadingb=!1:B.loadingb=!0):B.loadingb=!1,B.ajaxb=!1}))},tabFn(a,e,t=!1){let n=B.activeIndex;if(("activeIndex"==a&&n!=e||"activeIndex"!=a&&B.tabConfig[n][a]!==e||t)&&!B.ajaxb){"activeIndex"==a?(B.activeIndex=e,n=e):B.tabConfig[n][a]=e,B.page=1;let t={service:"sfcar",action:"getsfcarlist",page:1,pageSize:10,cityid:B.cityInfo.cityid,startaddr:B.startPlace,endaddr:B.endPlace,type:n};t={...t,...B.tabConfig[n]},B.listdata=[],B.listFn(t)}},fixPopFn(a){a?(B.fixPopb=!0,setTimeout((a=>{B.fixPopConb=!0}),0)):(B.fixPopConb=!1,setTimeout((a=>{B.fixPopb=!1}),200))},callUpFn(a){if(B.callItem=a,!U.globalData.userid)return U.tologin(B.pages.index),!1;let e=a.tel,t={module:"sfcar",temp:"detail",aid:a.id};a.payPhoneState||!U.globalData.appConfig.cfg_payPhoneState?(l({title:"获取中..."}),U.callPhone(B,e,t)):U.globalData.iOSMiniPay_forbid?o({title:"温馨提示",content:U.globalData.iosMiniPay_msg,showCancel:!1}):(l({title:"获取中..."}),B.getPhonePayAmount(t))},paySuccess(a){a&&a.fromAdv&&1==a.fromAdv||(B.callItem.payPhoneState=1),l({title:"获取中..."});let e={module:"sfcar",temp:"detail",aid:B.callItem.id};U.callPhone(B,a.detail,e)}},watch:{info(a,e){""!=a&&(B.warnFn(),setTimeout((a=>{B.info=""}),2200))}},onPullDownRefresh(){U.reloadFn()},onReachBottom(){if(!B.loadingb)return;let a=B.activeIndex,e={service:"sfcar",action:"getsfcarlist",page:++B.page,pageSize:10,cityid:B.cityInfo.cityid,startaddr:B.startPlace,endaddr:B.endPlace,type:a};e={...e,...B.tabConfig[a]},B.ajaxb||B.listFn(e,!0)},onShareAppMessage:a=>({title:`{${B.startPlace}}到{${B.endPlace}}(找顺风车)`,desc:B.sfConfig.description}),onShareTimeline:()=>({title:`{${B.startPlace}}到{${B.endPlace}}(找顺风车)`,imageUrl:B.sfConfig.sharePic})},[["render",function(a,e,t,n,i,l){const o=I(s("webTop"),T),d=_,k=f,$=w,F=I(s("privatenumber"),S),B=I(s("payBottom"),V),N=I(s("popWarn"),D),U=I(s("private_tip"),j);return g(),c(k,{class:"Shell",style:p(`padding-top:calc(${i.navTop+i.wh+i.biasTop}px + 90rpx);`)},{default:r((()=>["web"!=i.platForm||i.appBoolean?"mp-weixin"==i.platForm?(g(),c(k,{key:1,class:"navTop",style:p(`padding-top:calc(${i.wh+i.biasTop}px);`)},{default:r((()=>[b(k,{class:"n-back",onClick:l.backFn},{default:r((()=>[b(d,{src:`${i.masterDomain}/static/images/header_back.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"]),b($,null,{default:r((()=>[u(y(i.sfConfig.channelName||"顺风车"),1)])),_:1})])),_:1},8,["style"])):m("",!0):(g(),c(o,{key:0,title:i.sfConfig.channelName||"顺风车",module:"sfcar",class:"webTop"},null,8,["title"])),b(k,{class:"fixTop",style:p(`top: calc(${i.navTop+i.wh+i.biasTop}px)`)},{default:r((()=>[b(k,{class:"bar"},{default:r((()=>[b(k,{class:"f-tab"},{default:r((()=>[b(k,{class:h(""===i.tabConfig[i.activeIndex].cartype&&"active"),onClick:e[0]||(e[0]=a=>l.tabFn("cartype",""))},{default:r((()=>[u("全部 ")])),_:1},8,["class"]),1==i.activeIndex?(g(),v(x,{key:0},[b(k,{class:h("0"===i.tabConfig[1].cartype&&"active"),onClick:e[1]||(e[1]=a=>l.tabFn("cartype","0"))},{default:r((()=>[u(" 找乘用车")])),_:1},8,["class"]),b(k,{class:h(1==i.tabConfig[1].cartype&&"active"),onClick:e[2]||(e[2]=a=>l.tabFn("cartype",1))},{default:r((()=>[u(" 找载货车")])),_:1},8,["class"])],64)):(g(),v(x,{key:1},[b(k,{class:h("0"===i.tabConfig[0].cartype&&"active"),onClick:e[3]||(e[3]=a=>l.tabFn("cartype","0"))},{default:r((()=>[u(" 找乘客")])),_:1},8,["class"]),b(k,{class:h(1==i.tabConfig[0].cartype&&"active"),onClick:e[4]||(e[4]=a=>l.tabFn("cartype",1))},{default:r((()=>[u(" 找货物")])),_:1},8,["class"])],64)),b(k,{class:"active",onClick:e[5]||(e[5]=a=>l.fixPopFn(1))},{default:r((()=>[b($,null,{default:r((()=>[u(y(1==i.tabConfig[i.activeIndex].orderby?"最新发布":2==i.tabConfig[i.activeIndex].orderby?"最近出发":1==i.activeIndex&&"天天发车"),1)])),_:1}),b(d,{src:`${i.imgPath}/more-arr.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1})])),_:1})])),_:1}),b(k,{class:"f-pop",style:p("display:"+(i.fixPopb?"block":"none")),onClick:e[11]||(e[11]=a=>l.fixPopFn(0))},{default:r((()=>[b(k,{class:"fp-content",style:p(`transform:translateY(${i.fixPopConb?"0%":"-100%"})`),onClick:e[10]||(e[10]=P((()=>{}),["stop"]))},{default:r((()=>[b(k,{class:h(`item ${1==i.tabConfig[i.activeIndex].orderby&&"active"}`),onClick:e[6]||(e[6]=a=>l.tabFn("orderby",1))},{default:r((()=>[b($,null,{default:r((()=>[u("最新发布")])),_:1}),b(d,{src:`${i.imgPath}/on.png?v=${i.imgVersion}`},null,8,["src"])])),_:1},8,["class"]),b(k,{class:h(`item ${2==i.tabConfig[i.activeIndex].orderby&&"active"}`),onClick:e[7]||(e[7]=a=>l.tabFn("orderby",2))},{default:r((()=>[b($,null,{default:r((()=>[u("最近出发")])),_:1}),b(d,{src:`${i.imgPath}/on.png?v=${i.imgVersion}`},null,8,["src"])])),_:1},8,["class"]),1==i.activeIndex?(g(),c(k,{key:0,class:h(`item ${3==i.tabConfig[i.activeIndex].orderby&&"active"}`),onClick:e[8]||(e[8]=a=>l.tabFn("orderby",3))},{default:r((()=>[b($,null,{default:r((()=>[u("天天发车")])),_:1}),b(d,{src:`${i.imgPath}/on.png?v=${i.imgVersion}`},null,8,["src"])])),_:1},8,["class"])):m("",!0),b(k,{class:"btn",onClick:e[9]||(e[9]=a=>l.fixPopFn(0))},{default:r((()=>[u("取消")])),_:1})])),_:1},8,["style"])])),_:1},8,["style"])])),_:1},8,["style"]),b(k,{class:"lc-list"},{default:r((()=>[0==i.listdata.length?(g(),c(k,{key:0,class:"item loading"},{default:r((()=>[u(y(i.loadingb?"加载中...":"暂无相关数据！"),1)])),_:1})):(g(!0),v(x,{key:1},C(i.listdata,((a,e)=>(g(),c(k,{class:"item",key:e,onClick:e=>l.linkTo(i.appBoolean?a.url:`${i.pages.detail}?id=${a.id}`)},{default:r((()=>[b(k,{class:"lcl-address"},{default:r((()=>[b(k,{class:h("label "+(0==a.usetype?"blue":"green"))},{default:r((()=>[u(y(a.usetypename),1)])),_:2},1032,["class"]),b(k,{class:"destination"},{default:r((()=>[b($,null,{default:r((()=>[u(y(a.startaddr),1)])),_:2},1024),b(d,{src:`${i.imgPath}/placeFan.png?v=${i.imgVersion}`,mode:"aspectFit"},null,8,["src"]),b($,null,{default:r((()=>[u(y(a.endaddr),1)])),_:2},1024),a.accessaddr?(g(),c($,{key:0,class:"access"},{default:r((()=>[u(y(a.accessaddr),1)])),_:2},1024)):m("",!0)])),_:2},1024)])),_:2},1024),b(k,{class:"lcl-time"},{default:r((()=>[b(k,{class:"start"},{default:r((()=>[b($,null,{default:r((()=>[u(y(a.missiontime),1)])),_:2},1024),u(y(a.missiontime1),1)])),_:2},1024),b(k,{class:"date"},{default:r((()=>[u(y(a.pubdatetime),1)])),_:2},1024)])),_:2},1024),a.note?(g(),c(k,{key:0,class:"lcl-note"},{default:r((()=>[b($,null,{default:r((()=>[u("备注：")])),_:1}),u(y(a.note),1)])),_:2},1024)):m("",!0),b(k,{class:"lcl-btn"},{default:r((()=>[b(k,{class:h("left "+(0==a.tag.length?"none":""))},{default:r((()=>[a.tag.length>0?(g(),c(k,{key:0,class:"label"},{default:r((()=>[(g(!0),v(x,null,C(a.tag,((a,t)=>(g(),c(k,{key:e},{default:r((()=>[u(y(a),1)])),_:2},1024)))),128))])),_:2},1024)):m("",!0)])),_:2},1032,["class"]),b(k,{class:"btn",onClick:P((e=>l.callUpFn(a)),["stop"])},{default:r((()=>[u("拨打电话")])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),0!=i.listdata.length?(g(),c(k,{key:2,class:"loadingText"},{default:r((()=>[u(y(i.loadingb?"加载中...":"没有更多了~"),1)])),_:1})):m("",!0),b(F,{phoneData:i.phoneData,onShowPrivateNumber:e[12]||(e[12]=a=>i.phoneData.showPrivateNumber=0),onShowhasPayNumber:e[13]||(e[13]=a=>i.phoneData.showhasPayNumber=0),ref:"privatenumber",onTopay:l.directTopay,onHaspay:l.paySuccess,payInfo:i.payInfo},null,8,["phoneData","onTopay","onHaspay","payInfo"]),b(B,{service:"siteConfig",action:"payPhone",payInfo:i.payInfo,paypopb:i.paypopb,onPayError:e[14]||(e[14]=a=>i.info=a),onPaySuccess:l.paySuccess,onPaypopb:e[15]||(e[15]=a=>i.paypopb=!1)},null,8,["payInfo","paypopb","onPaySuccess"]),b(N,{info:i.info,warningb:i.warningb},null,8,["info","warningb"]),b(U,{privateShow:i.privateb},null,8,["privateShow"])])),_:1},8,["style"])}],["__scopeId","data-v-afffa6cb"]]);export{A as default};
