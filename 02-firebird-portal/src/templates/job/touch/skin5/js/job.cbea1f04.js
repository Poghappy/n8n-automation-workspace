import{o as e,a,w as t,b as o,B as n,E as s,F as l,D as i,d as r,t as c,G as g,e as p,i as d,s as u,x as h,U as m,m as f,ah as b,M as k,ai as y,v as j,k as x,q as w,C as D,g as C,K as v,I as _,f as z}from"./index-160de7c6.js";const B=(e,a)=>{const t=e.__vccOpts||e;for(const[o,n]of a)t[o]=n;return t};var S;const F=B({props:{model:{type:Boolean,default:!1},confirmBtn:{type:Object,default:{text:"确定",style:"border-right:0rpx;border-radius:0rpx 0rpx 10rpx 0rpx"}},cancelBtn:{type:Object,default:{text:"取消",style:"border-radius:0rpx 0rpx 0rpx 10rpx"}},content:{type:Array,default:[{text:"弹窗",style:""}]},getCancelFn:{type:Function,default:e=>{}},getConfirmFn:{type:Function,default:e=>{}}},mounted(){S=this},methods:{confirmFn(){S.$emit("models",!1),this.getConfirmFn()},cancelFn(){S.$emit("models",!1),this.getCancelFn()}}},[["render",function(u,h,m,f,b,k){const y=d;return m.model?(e(),a(y,{key:0,class:"shellModel",onClick:k.cancelFn},{default:t((()=>[o(y,{class:"dialog",onClick:h[0]||(h[0]=g((()=>{}),["stop"]))},{default:t((()=>[o(y,{class:"content"},{default:t((()=>[(e(!0),n(l,null,s(m.content,((o,n)=>(e(),a(y,{class:"text",key:n,style:i(o.style)},{default:t((()=>[r(c(o.text),1)])),_:2},1032,["style"])))),128))])),_:1}),o(y,{class:"btn"},{default:t((()=>[o(y,{class:"confirm btn_a",style:i(m.cancelBtn.style),onClick:k.cancelFn},{default:t((()=>[r(c(m.cancelBtn.text),1)])),_:1},8,["style","onClick"]),o(y,{class:"cancel btn_a",style:i(m.confirmBtn.style),onClick:k.confirmFn},{default:t((()=>[r(c(m.confirmBtn.text),1)])),_:1},8,["style","onClick"])])),_:1})])),_:1})])),_:1},8,["onClick"])):p("",!0)}],["__scopeId","data-v-4a96cb29"]]);var I;const N=C();const O=B({emits:["totop"],components:{showModel:F},data:()=>({model:!1,conArr:[{text:"检测到你目前的城市为",style:""},{text:"苏州",style:"font-size:50rpx;color:#ff6600;font-weight:bold;padding:10rpx 0rpx"},{text:"是否切换",style:""}],modelConfirm:function(){console.log("确定")},modelCancel:function(){u({key:"manualChange",data:1})},bottomNavArr:[],msgNum:0,userid:N.globalData.userid,grayscale:"1"==N.globalData.appConfig.sitePageGray||"2"==N.globalData.appConfig.sitePageGray?"grayscale":"",platForm:N.globalData.platForm,timerBottom:null}),props:{module:{type:String,default:"info"},active:{type:String,default:"0"},needMessage:{type:Boolean,default:!1},total:{type:Number,default:0},pageHide:{type:Boolean,default:!1},needCity:{type:Boolean,default:!0},activeColor:{type:String,default:""}},methods:{linkTo(e,a){if(e){if(I.appBoolean)return window.setupWebViewJavascriptBridge((function(a){a.callHandler("redirectNative",{name:"",code:"",link:e},(function(){}))})),!1;"web"==I.platForm?e.indexOf("http")>-1?location.href=e:m({url:e}):e.includes("/packages")&&!e.includes("/index/index")?h({url:e}):a?h({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e}):m({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e})}},handlePageShow:function(){var e=N.globalData.userid;I.grayscale="1"==N.globalData.appConfig.sitePageGray||"2"==N.globalData.appConfig.sitePageGray?"grayscale":"";var a=I.module;I.getModule(a),null!=e&&"undefined"!=e&&e&&(I.getMessage(),I.needMessage&&(I.timerBottom=setInterval((function(){I.getMessage()}),5e3),I.pageShowCheck(5)))},getModule(e){var a="service=siteConfig&action=touchHomePageFooter&version=2.0&module="+e,t=N.encodeUrl(a);I.$ajax.post({url:"include/ajax.php?"+(t||a)}).then((e=>{var a=e.data;if(100==a.state){for(var t=a.info,o=[],n=0;n<t.length;n++)t[n].url=N.addUrlParam(t[n].url,"forcelogout"),o.push(t[n]);I.bottomNavArr=o}}))},getMessage(){var e=N.encodeUrl("service=member&action=message&type=tongji&im=1");I.$ajax.post({url:"include/ajax.php?"+e}).then((e=>{var a=e.data;100==a.state?I.msgNum=a.info.pageInfo.total>99?"99+":a.info.pageInfo.total:"用户信息验证失败"==a.info&&(I.msgNum=0,setTimeout((function(){f("access_token")?y.unit(f("refresh_token"),N.globalData.masterDomain,(function(e){if(100==e.state){console.log("更新成功");var a=e.info.access_token,t=e.info.refresh_token;u({key:"access_token",data:a}),u({key:"refresh_token",data:t});var o=Date.parse(new Date)/1e3+7200-20;u({key:"token_expired",data:o}),N.globalData.access_token=a,N.globalData.refresh_token=t,N.globalData.token_expired=o}else{k({key:"userid"}),k({key:"access_token"}),k({key:"refresh_token"}),k({key:"token_expired"}),N.globalData.userid=null,N.globalData.access_token=null,N.globalData.refresh_token=null,N.globalData.token_expired=null;var n=encodeURIComponent(N.globalData.masterDomain+"/logout.html?redirect="+N.globalData.masterDomain+"/login.html");m({url:"/pages/redirect/index?url="+encodeURIComponent(n),success:e=>{console.log("跳转")}})}})):(b({title:"账号状态异常，请重新登录！",icon:"none",duration:2e3}),k({key:"userid"}),k({key:"access_token"}),k({key:"refresh_token"}),k({key:"token_expired"}),N.globalData.userid=null,N.globalData.access_token=null,N.globalData.refresh_token=null,N.globalData.token_expired=null,N.tologin("/pages/goback"))}),1e3))}))},goLink(e,a){var t=e.currentTarget.dataset.url,o=e.currentTarget.dataset.type,n=e.currentTarget.dataset.module;if(""==t)return"siteConfig"==I.module&&"0"==I.active&&I.$emit("totop"),!1;if("mp-weixin"!=I.platForm&&"mp-toutiao"!=I.platForm||(a=t.indexOf("/message/")<=-1&&t.indexOf("/pages/member/index/index/")<=-1&&"siteConfig"==n),"2"==o||t.indexOf("/message/")>-1||t.indexOf("fabuJoin_touch_popup")>-1){let e=N.globalData.userid;e?null==e||""==e?N.loginCheck(t):I.linkTo(t,a):N.loginCheck(t)}else I.linkTo(t,a)},cityChange(){if("waimai"==this.module||!this.needCity)return!1;let e;e=f("cityInfo"),e=e&&"string"==typeof e?JSON.parse(e):e,N.globalData.locationFn({type:"gcj02",success:a=>{N.getCityInfo(a.longitude||a.lng,a.latitude||a.lat,"gcj02ll",(function(a){var t=`service=siteConfig&action=verifyCity&region=${a.province}&city=${a.city}&town=${a.town}&district=${a.district}`,o=N.encodeUrl(t);I.$ajax.post({url:"include/ajax.php?"+o}).then((a=>{100==a.data.state&&(e?e.cityid!=a.data.info.cityid&&N.globalData.appConfig&&N.globalData.appConfig.site_city_auto_location&&(I.model=!0):(I.conArr[1].text="城市信息获取失败，是否切换到",console.log("跳转城市选择")),I.conArr[1].text=a.data.info.name,I.modelConfirm=function(){if(j("cityInfo",a.data.info),I.model=!1,console.log("重新加载"),"web"==x().uniPlatform)if(window.appBoolean)window.setupWebViewJavascriptBridge((function(e){e.callHandler("changeCity",JSON.stringify(a.data.info),(function(){location.href=a.data.info.url+"?currentPageOpen=1&appIndex=1&appFullScreen"}))}));else{let e=window.masterDomains?window.masterDomains.replace("http://","").replace("https://",""):window.location.host,t=e.split("."),o=e.replace(t[0]+".","");e.split("/")[0],o=o.split("/")[0],window.$.cookie("HN_siteCityInfo",JSON.stringify(a.data.info),{expires:7,domain:e,path:"/"}),window.$.cookie("HN_siteCityInfo",JSON.stringify(a.data.info),{expires:7,domain:o,path:"/"}),location.href=a.data.info.url+"?currentPageOpen=1"}else N.reloadFn()})}))}))}})},pageChangeVisible(e){e?this.needMessage&&Boolean(N.globalData.userid)&&(clearInterval(this.timerBottom),this.getMessage(),this.timerBottom=setInterval((e=>{this.getMessage(),console.log("前台重置")}),5e3),this.pageShowCheck(5)):clearInterval(this.timerBottom)},pageShowCheck(e){const a=this;let t=e,o=5;switch(e){case 5:t=10,o=10;break;case 10:t=20,o=20;break;case 20:t=30,o=30;break;case 30:t=60,o=60;break;case 60:t=0,o=0}setTimeout((()=>{clearInterval(a.timerBottom),e&&o&&(a.timerBottom=setInterval(this.getMessage,1e3*o)),t&&a.pageShowCheck(t)}),60*e*1e3)}},mounted(){I=this,this.handlePageShow(),w({key:"manualChange",fail:e=>{this.cityChange()}})},unmounted(){clearInterval(I.timerBottom)},watch:{pageHide(e,a){e?clearInterval(I.timerBottom):Boolean(N.globalData.userid)&&(clearInterval(I.timerBottom),I.timerBottom=setInterval((e=>{this.getMessage()}),5e3))},total(e,a){0==e&&(this.msgNum=0)}}},[["render",function(g,u,h,m,f,b){const k=_,y=d,j=z,x=v("show-model");return f.bottomNavArr.length?(e(),a(y,{key:0,class:D("bottomBox "+f.grayscale)},{default:t((()=>[(e(!0),n(l,null,s(f.bottomNavArr,((n,s)=>(e(),a(y,{class:D("li ficon "+(n.fabu?"fabu":"")),"data-module":h.module,"data-url":h.active!=s?"web"==f.platForm?n.url:n.miniPath||n.url:"",onClick:e=>b.goLink(e,Boolean(n.fabu)||n.url.includes("currentPageOpen")),"data-type":1,key:s},{default:t((()=>[o(k,{src:h.active==s||"message"==h.active&&n.message?n.icon_h:n.icon,class:"image"},null,8,["src"]),!n.message||0==f.msgNum&&0==h.total?p("",!0):(e(),a(y,{key:0,class:"msg"},{default:t((()=>[r(c(h.total||f.msgNum),1)])),_:1})),n.fabu?p("",!0):(e(),a(j,{key:1,class:"text",style:i(h.active==s&&h.activeColor?"color:"+h.activeColor+";":"")},{default:t((()=>[r(c(n.name),1)])),_:2},1032,["style"]))])),_:2},1032,["class","data-module","data-url","onClick"])))),128)),o(x,{onModels:u[0]||(u[0]=e=>f.model=!1),model:f.model,content:f.conArr,getConfirmFn:f.modelConfirm,getCancelFn:f.modelCancel},null,8,["model","content","getConfirmFn","getCancelFn"])])),_:1},8,["class"])):p("",!0)}],["__scopeId","data-v-742460d3"]]),A={web:{development:{index:"/pages/packages/job/index/index",job:"/pages/packages/job/job/job",joblist:"/pages/packages/job/jobList/jobList",company:"/pages/packages/job/company/company",companylist:"/pages/packages/job/companyList/companyList",searchlist:"/pages/packages/job/searchList/searchList",general:"/pages/packages/job/general/general",generalSearch:"/pages/packages/job/generalSearch/generalSearch",zgDetail:"/pages/packages/job/zgDetail/zgDetail",qzDetail:"/pages/packages/job/qzDetail/qzDetail?",zhaopinhui:"/pages/packages/job/zhaopinhui/zhaopinhui",zhaopinhuiDetail:"/pages/packages/job/zhaopinhuiDetail/zhaopinhuiDetail",zhaopinhuiSearch:"/pages/packages/job/zhaopinhuiSearch/zhaopinhuiSearch",news:"/pages/packages/job/news/news",searchNews:"/pages/packages/job/searchNews/searchNews",newsDetail:"/pages/packages/job/newsDetail/newsDetail",resume:"/pages/packages/job/resume/resume",choseAddr:"/pages/packages/job/choseAddr/choseAddr",talent:"/pages/packages/job/talent/talent"},production:{index:"/index",job:"/job",joblist:"/job-list",company:"/company",companylist:"/company-list",searchlist:"/search-list",general:"/general",generalSearch:"/general-search",zgDetail:"/general-detailzg",qzDetail:"/general-detailqz",zhaopinhui:"/zhaopinhui",zhaopinhuiDetail:"/zhaopinhui-detail",zhaopinhuiSearch:"/zhaopinhui-search",news:"/news",searchNews:"/search-news",newsDetail:"/news-detail",resume:"/resume",choseAddr:"/choseposi",talent:"/talent"}},mini:{index:"/pages/packages/job/index/index",job:"/pages/packages/job/job/job",joblist:"/pages/packages/job/jobList/jobList",company:"/pages/packages/job/company/company",companylist:"/pages/packages/job/companyList/companyList",searchlist:"/pages/packages/job/searchList/searchList",general:"/pages/packages/job/general/general",generalSearch:"/pages/packages/job/generalSearch/generalSearch",zgDetail:"/pages/packages/job/zgDetail/zgDetail",qzDetail:"/pages/packages/job/qzDetail/qzDetail?",zhaopinhui:"/pages/packages/job/zhaopinhui/zhaopinhui",zhaopinhuiDetail:"/pages/packages/job/zhaopinhuiDetail/zhaopinhuiDetail",zhaopinhuiSearch:"/pages/packages/job/zhaopinhuiSearch/zhaopinhuiSearch",news:"/pages/packages/job/news/news",searchNews:"/pages/packages/job/searchNews/searchNews",newsDetail:"/pages/packages/job/newsDetail/newsDetail",resume:"/pages/packages/job/resume/resume",choseAddr:"/pages/packages/job/choseAddr/choseAddr",talent:"/pages/packages/job/talent/talent"}};export{B as _,O as b,A as j,F as s};
