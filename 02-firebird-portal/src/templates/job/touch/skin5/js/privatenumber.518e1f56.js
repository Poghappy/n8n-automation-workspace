import{$ as a,a0 as e,H as t,o,a as n,w as r,b as l,C as s,d as i,t as d,e as p,g as c,i as u,f as m,I as h,h as f}from"./index-160de7c6.js";import{_ as b}from"./toast.b19c5451.js";import{r as v}from"./uni-app.es.bf317389.js";import{_ as w}from"./job.cbea1f04.js";const _=c();const g=w({emits:["topay","haspay","showhasPayNumber","showPrivateNumber"],data:()=>({showRewardPop:!1,masterDomain:_.globalData.masterDomain,imgPath:_.globalData.imgPath,imgVersion:_.globalData.imgVersion,cfg_payPhone:{payPhone_entrance:0,payPhone_price:1,wxmini:"adunit-078d0de41e6925bf"},currency:{short:"元",symbol:"￥"},rewardedVideoAd:"",uniPlatform:"",android:"web"==_.globalData.platForm&&window.Android,interval:null,globalData:_.globalData,clickTime:0}),props:{phoneData:{type:Object,default:{privateNumberPhone:"",privateNumberCountDown:0,showhasPayNumber:0,privateNumberPhoneTip:"",showPrivateNumber:0,privateNumberFrom:0,privateNumberDataSet:{module:"",temp:"",aid:""}}},payInfo:{type:Object,default:{order_amount:"",order_sn:"",ordernum:"",service:"",timeout:0}}},watch:{showRewardPop:function(a){const e=this;a&&(e.clickTime=parseInt((new Date).valueOf()/1e3),"web"==e.uniPlatform&&_.globalData.appBoolean&&window.Android||("mp-weixin"==e.uniPlatform?e.initRewardAdv():e.callByPay()))}},mounted(){const a=this;a.$nextTick((()=>{a.uniPlatform=_.globalData.platForm,setTimeout((()=>{_.globalData.appConfig&&(a.cfg_payPhone=_.globalData.appConfig.cfg_payPhone,a.currency=_.globalData.appConfig.currency)}),1500)}))},methods:{privatenumberClick(e){var t=e.currentTarget.dataset.type;if("close"==t)this.$emit("showPrivateNumber",0),this.$emit("showhasPayNumber",0);else if("call"==t){var o=e.currentTarget.dataset.phone;_.globalData.appBoolean&&"web"==_.globalData.platForm?window.location.href="tel:"+o:a({phoneNumber:o})}},callByPay(){const a=this;let e=parseInt((new Date).valueOf()/1e3)-a.clickTime;a.$emit("topay",e),a.showRewardPop=!1},callBgAdv(){const a=this;a.showRewardPop=!1,_.globalData.appBoolean&&window.Android?window.setupWebViewJavascriptBridge((function(e){e.callHandler("playRewardAd",{value:a.payInfo.ordernum},(function(e){"success"==e&&(a.interval=setInterval((()=>{a.getPhoneInfo()}),1e3))}))})):a.rewardedVideoAd.show().catch((()=>{a.rewardedVideoAd.load().then((()=>a.rewardedVideoAd.show())).catch((e=>{let t=a.cfg_payPhone.payPhone_entrance?"广告拉取失败，请支付后查看或者稍后重试":"广告拉取失败，请稍后重试";a.$refs.toasts.showToast(t)}))}))},initRewardAdv(){const a=this;if(a.rewardedVideoAd)return!1;wx.createRewardedVideoAd&&(a.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:a.cfg_payPhone.wxmini}),a.rewardedVideoAd.onLoad((()=>{console.log("onLoad event emit")})),a.rewardedVideoAd.onError((e=>{console.log("onError event emit",e),a.updatePlayState(2)})),a.rewardedVideoAd.onClose((e=>{console.log("onClose event emit",e),e&&e.isEnded&&(a.showRewardPop=!1,a.updatePlayState(1))})))},updatePlayState(a){const t=this;e({success:e=>{var o=e.code,n="service=siteConfig&action=wxminiAdRewardVideoNotify&ordernum="+t.payInfo.ordernum+"&code="+o+"&state="+a,r=_.encodeUrl(n);t.$ajax.post({url:"include/ajax.php?"+r}).then((e=>{1==a&&t.getPhoneInfo()}))}})},getPhoneInfo(){const a=this;var e="service=member&action=tradePayResult&order="+a.payInfo.ordernum,t=_.encodeUrl(e);a.$ajax.post({url:"include/ajax.php?"+t}).then((e=>{var t=e.data;100==t.state&&(a.interval&&clearInterval(a.interval),a.$emit("haspay",{detail:t,fromAdv:1}))}))}}},[["render",function(a,e,c,w,_,g){const y=v(t("toast"),b),P=u,C=m,D=h,k=f;return o(),n(P,{style:{height:"100%"}},{default:r((()=>[l(P,{style:{position:"relative","z-index":"9999999999"}},{default:r((()=>[l(y,{id:"toast",ref:"toasts"},null,512)])),_:1}),_.cfg_payPhone.wxmini&&"mp-weixin"==_.uniPlatform||"web"==_.uniPlatform&&_.android&&_.cfg_payPhone.tencentGDP_placement_id&&_.cfg_payPhone.tencentGDP_app_id?(o(),n(P,{key:0,class:s({rewardadvPop:!0,rewardadvShow:_.showRewardPop})},{default:r((()=>[l(P,{class:"rewardAdvContent"},{default:r((()=>[l(P,{class:"rewardAdvCon"},{default:r((()=>[l(P,{class:"rewardClose",onClick:e[0]||(e[0]=a=>_.showRewardPop=!1)},{default:r((()=>[i("×")])),_:1}),l(P,{class:"h3"},{default:r((()=>[i("看广告免费获取联系方式")])),_:1}),l(P,{class:"p"},{default:r((()=>[i(d(_.cfg_payPhone.payPhone_entrance?"观看广告免费获取对方联系电话":"观看广告，或直接付费获取对方联系电话"),1)])),_:1})])),_:1}),l(P,{class:"btns_group"},{default:r((()=>[_.cfg_payPhone.payPhone_entrance?p("",!0):(o(),n(P,{key:0,class:"btn_pay",onClick:g.callByPay},{default:r((()=>[l(P,{class:"txt"},{default:r((()=>[i("直接付费")])),_:1}),l(P,{class:"span"},{default:r((()=>[l(C,{class:"symbol"},{default:r((()=>[i(d(_.currency.symbol),1)])),_:1}),l(C,{class:"amount"},{default:r((()=>[i(d(c.payInfo.order_amount),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),l(P,{class:"btn_watch",onClick:g.callBgAdv},{default:r((()=>[l(P,{class:"txt"},{default:r((()=>[i("免费获取")])),_:1}),l(D,{class:"img",src:_.imgPath+"/payPop/video_icon.png?v="+_.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1},8,["onClick"])])),_:1})])),_:1}),l(P,{class:"rewardAdvMask","data-type":"close",onClick:e[1]||(e[1]=a=>_.showRewardPop=!1)})])),_:1},8,["class"])):p("",!0),l(P,{class:s("privatenumber-popup "+(c.phoneData.showPrivateNumber?"privatenumber-show":""))},{default:r((()=>[l(P,{class:"privatenumber-content"},{default:r((()=>[l(P,{class:"privatenumber-header"},{default:r((()=>[l(P,{class:"privatenumber-title"},{default:r((()=>[i("请使用"+d(c.phoneData.privateNumberFrom)+"拨打",1)])),_:1}),l(P,{class:"privatenumber-tips"},{default:r((()=>[l(C,null,{default:r((()=>[i("我们将为您使用虚拟号码拨出")])),_:1}),p("",!0)])),_:1}),l(k,{class:"privatenumber-close","data-type":"close",onClick:g.privatenumberClick},{default:r((()=>[i("×")])),_:1},8,["onClick"])])),_:1}),l(P,{class:"privatenumber-main"},{default:r((()=>[l(P,{class:"privatenumber-phone"},{default:r((()=>[i(d(c.phoneData.privateNumberPhone),1)])),_:1}),l(P,{class:"privatenumber-text"},{default:r((()=>[i(" 此号码将在 "),l(C,{class:"privatenumber-countdown"},{default:r((()=>[i(d(c.phoneData.privateNumberCountDown)+"秒",1)])),_:1}),i(" 后失效，请尽快拨打 ")])),_:1})])),_:1}),l(k,{class:"privatenumber-btn","data-type":"call","data-phone":c.phoneData.privateNumberPhone,onClick:g.privatenumberClick},{default:r((()=>[i("立即拨打")])),_:1},8,["data-phone","onClick"]),_.globalData.appConfig&&_.globalData.appConfig.cfg_shortname?(o(),n(P,{key:0,class:"concat_tip"},{default:r((()=>[i("联系我时，请说是在"),l(C,{class:"span"},{default:r((()=>[i(d(_.globalData.appConfig.cfg_shortname),1)])),_:1}),i("上看到的，谢谢！")])),_:1})):p("",!0)])),_:1}),l(P,{class:"privatenumber-mask","data-type":"close",onClick:g.privatenumberClick},null,8,["onClick"])])),_:1},8,["class"]),l(P,{class:s("privatenumber-popup "+(c.phoneData.showhasPayNumber?"privatenumber-show":""))},{default:r((()=>[l(P,{class:"privatenumber-content"},{default:r((()=>[l(P,{class:"privatenumber-header"},{default:r((()=>[l(P,{class:"privatenumber-title"},{default:r((()=>[i("已获取联系方式，请尽快拨打")])),_:1}),l(P,{class:"privatenumber-tips"},{default:r((()=>[l(C,null,{default:r((()=>[i("温馨提示，您可截图保存联系方式到相册")])),_:1})])),_:1}),l(k,{class:"privatenumber-close","data-type":"close",onClick:g.privatenumberClick},{default:r((()=>[i("×")])),_:1},8,["onClick"])])),_:1}),l(P,{class:"privatenumber-main"},{default:r((()=>[l(P,{class:"privatenumber-phone"},{default:r((()=>[i(d(c.phoneData.privateNumberPhone),1)])),_:1}),l(P,{class:"privatenumber-text"},{default:r((()=>[i(d(c.phoneData.privateNumberPhoneTip),1)])),_:1})])),_:1}),l(k,{class:"privatenumber-btn","data-type":"call","data-phone":c.phoneData.privateNumberPhone,onClick:g.privatenumberClick},{default:r((()=>[i("立即拨打")])),_:1},8,["data-phone","onClick"]),_.globalData.appConfig&&_.globalData.appConfig.cfg_shortname?(o(),n(P,{key:0,class:"concat_tip"},{default:r((()=>[i("联系我时，请说是在"),l(C,{class:"span"},{default:r((()=>[i(d(_.globalData.appConfig.cfg_shortname),1)])),_:1}),i("上看到的，谢谢！")])),_:1})):p("",!0)])),_:1}),l(P,{class:"privatenumber-mask","data-type":"close",onClick:g.privatenumberClick},null,8,["onClick"])])),_:1},8,["class"])])),_:1})}],["__scopeId","data-v-7855818f"]]);export{g as _};
