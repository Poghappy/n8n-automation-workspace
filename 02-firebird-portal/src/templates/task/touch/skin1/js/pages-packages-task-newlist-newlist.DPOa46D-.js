import{a as e,h as a,P as t,i as l,j as i,b as s,d as n,e as o,r,n as d,k as p,o as c,l as u,w as m,m as h,q as g,A as f,t as b,v as k,y as _,F as y,x as v,B as x,H as w,G as T,C,S as F,D as S,a4 as D,a5 as j,z as B}from"./index-cF6skFzP.js";import{r as P,_ as z}from"./uni-app.es.J1otcSEF.js";import{p as $}from"./task.9CwFAmAC.js";import{_ as U}from"./_plugin-vue_export-helper.BCo6x5W8.js";let J=h();var O;const I=U({data:()=>({wh:J.globalData.navTop+J.globalData.appFullWh,masterDomain:J.globalData.masterDomain,biasTop_88:J.globalData.biasTop_88,appBack:J.globalData.appBack,imgurl:J.globalData.imgPath+"/task/",ajaxb:!1,privateb:!1,popb:!1,popconb:!1,loadingb:!0,listdata:null,themedata:{},tabchange:[{id:1,title:"全部"},{id:2,title:"最新发布"},{id:3,title:"近7天内"},{id:4,title:"7天前"}],tabActive:0,page:1,pageSize:10,selTime:{startTime:[0,0,0],endTime:[0,0,0],startRank:""},selPre:{startTime:[0,0,0],endTime:[0,0,0],selitem:[]},stime:"",etime:"",orderby:0,imgVersion:"",headerh:"",month:[],day:[],pages:"",platForm:J.globalData.platForm,appBoolean:J.globalData.appBoolean,channelDomain:J.globalData.channelDomain,appFullScreen:J.globalData.appFullScreen}),onLoad(e){O=this,-1==J.globalData.wxprivate?J.watchG("wxprivate",(function(a){O.wxprivate=a,a?O.privateb=!0:O.onload(e)})):J.globalData.wxprivate?O.privateb=!0:O.onload(e)},onReady(){},onShow(){},onHide(){},onUnload(){},onPullDownRefresh(){J.reloadFn()},onReachBottom(){!this.ajaxb&&this.loadingb&&(e({title:"加载中",mask:!0,success:()=>{this.ajaxb=!0}}),this.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:++this.page,pageSize:this.pageSize,orderby:this.orderby,etime:this.etime,stime:this.stime,first:1}}).then((e=>{100==e.data.state&&(O.listdata=this.listdata.concat(e.data.info.list),O.loadingb=!(e.data.info.list.length<this.pageSize),O.ajaxb=!1),a()})))},onShareAppMessage(e){return{title:this.themedata.title+" 首发新单",imageUrl:this.themedata.sharePic}},onShareTimeline(){return{title:this.themedata.title+" 首发新单",imageUrl:this.themedata.sharePic}},methods:{onload(n){e({title:"加载中",mask:!0,success:()=>{t({key:"warnColor",success:e=>{t({key:"warnColor",success:e=>{O.themedata=e.data.themeDate,O.setBgColor(this.themedata.themeBackgroundColor),e.data.outtime<Date.parse(new Date)&&l({key:"warnColor",success:()=>{O.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((e=>{null!=e.data.info.themeBackgroundColor?(O.themedata=e.data.info,i({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),O.setBgColor(this.themedata.themeBackgroundColor),a()):(a(),s({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),a()},fail:e=>{O.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((e=>{null!=e.data.info.themeBackgroundColor?(O.themedata=e.data.info,i({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),O.setBgColor(this.themedata.themeBackgroundColor),a()):(a(),s({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),O.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:1,pageSize:this.pageSize,orderby:this.orderby,first:1,stime:this.stime,etime:this.etime}}).then((e=>{100==e.data.state?(O.listdata=e.data.info.list,O.loadingb=!(e.data.info.list.length<this.pageSize)):(O.listdata=null,O.loadingb=!1)})),this.selTime.startRank=this.timestampToTime(+new Date/1e3-2505600),this.selTime.selitem=this.seldateFn(-30),O.selTime=this.selTime,O.selPre=JSON.parse(JSON.stringify(this.selTime)),O.pages=J.pageFn($)},backFn(){if(O.appBoolean)return window.setupWebViewJavascriptBridge((function(e){e.callHandler("goBack",{},(function(e){}))})),!1;{let e=n();e&&e.length>1?o({delta:1}):"web"==O.platForm?location.href=`${O.masterDomain}${window.pathname}${O.pages.index}`:r({url:"/pages/packages/task/index/index"})}},linkTo(e){if(e)if("web"==O.platForm){if(window.appBoolean)return window.setupWebViewJavascriptBridge((function(a){a.callHandler("redirectNative",{name:"",code:"",link:e},(function(){}))})),!1;e.indexOf("http")>-1?location.href=e:d({url:e})}else{if(e.includes("tomini")){let a=e.split("?")[1].split("&");for(let t=0;t<a.length;t++)if(a[t].includes("tomini")){e=a[t].replace("tomini=",""),a.splice(t,1);break}e+=`?${a.join("&")}`}d({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e})}},setBgColor(e){"web"!=O.platForm&&uni.setBackgroundColor({backgroundColor:e,fail:e=>{console.log(e)}})},tabchangeFn(e){let a=e.currentTarget.dataset.index;switch(O.tabActive=a,O.page=1,O.loadingb=!0,O.listdata=null,a){case 0:O.etime="",O.stime="",O.orderby=0,O.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:1,pageSize:this.pageSize,orderby:0,first:1}}).then((e=>{100==e.data.state?(O.listdata=e.data.info.list,O.loadingb=!(e.data.info.list.length<this.pageSize)):(O.listdata=null,O.loadingb=!(e.data.info.list.length<this.pageSize))}));break;case 1:O.etime="",O.stime="",O.orderby=1,O.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:1,pageSize:this.pageSize,orderby:1,first:1}}).then((e=>{100==e.data.state?(O.listdata=e.data.info.list,O.loadingb=!(e.data.info.list.length<this.pageSize)):(O.listdata=null,O.loadingb=!1)}));break;case 2:{let e=parseInt((+new Date-5184e5)/1e3),a=J.transTimes(e,2),t=parseInt(+new Date/1e3),l=J.transTimes(t,2);O.stime=a,O.etime=l,O.orderby=0,O.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:1,pageSize:this.pageSize,orderby:0,first:1,stime:a,etime:l}}).then((e=>{100==e.data.state?(O.listdata=e.data.info.list,O.loadingb=!(e.data.info.list.length<this.pageSize)):(O.listdata=null,O.loadingb=!1)}));break}case 3:{let e=parseInt((+new Date-5184e5)/1e3),a=J.transTimes(e,2);O.stime="",O.etime=a,O.orderby=0,O.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:1,pageSize:this.pageSize,orderby:0,first:1,etime:a}}).then((e=>{100==e.data.state?(O.listdata=e.data.info.list,O.loadingb=!(e.data.info.list.length<this.pageSize)):(O.listdata=null,O.loadingb=!1)}));break}}},timestampToTime(e){const a=J.dateFormatter(e);return a.year+"年"+(a.month+"月")+(a.day+"日")},popFn(e){0==e.currentTarget.dataset.state?(O.popconb=!1,O.selPre=JSON.parse(JSON.stringify(this.selTime)),setTimeout((()=>{O.popb=!1}),500)):(O.popb=!0,setTimeout((()=>{O.popconb=!0}),0))},warningFn:()=>!0,dateFn(e,a,t,l){if(0==e.length)return[{value:a,month:[{value:t,day:[l]}]}];{let i=!1,s=!1,n=0,o=0;for(let t=0;t<e.length;t++)if(e[t].value==a){i=!0,n=t;break}if(!i){let i={value:a,month:[{value:t,day:[l]}]};return e.push(i),e}e:for(let a=n;a<e.length;a++)for(let l=0;l<e[a].month.length;l++)if(e[a].month[l].value==t){s=!0,o=l;break e}if(!s){let a={value:t,day:[l]};return e[n].month.push(a),e}return e[n].month[o].day.push(l),e}},seldateFn(e){let a=[];if(e>0)for(let t=1;t<=e;t++){const e=J.dateFormatter(parseInt((+new Date+864e5*t)/1e3)),l=e.year,i=e.month,s=e.day;a=this.dateFn(a,l,i,s)}else if(e<0)for(let t=0;e<t;t--){const e=J.dateFormatter(parseInt((+new Date+864e5*t)/1e3)),l=e.year,i=e.month,s=e.day;a=this.dateFn(a,l,i,s)}return a},selectFn(e){0==e.currentTarget.dataset.state?this.selPre.startTime=e.detail.value:this.selPre.endTime=e.detail.value,O.selPre=this.selPre},confirmFn(){O.selTime=JSON.parse(JSON.stringify(this.selPre));let e=this.selTime.startTime,a=this.selTime.selitem[e[0]].value+"-"+this.selTime.selitem[e[0]].month[e[1]].value+"-"+this.selTime.selitem[e[0]].month[e[1]].day[e[2]],t=this.selTime.endTime,l=this.selTime.selitem[t[0]].value+"-"+this.selTime.selitem[t[0]].month[t[1]].value+"-"+this.selTime.selitem[t[0]].month[t[1]].day[t[2]];O.popconb=!1,O.stime=a,O.etime=l,O.orderby=0,setTimeout((()=>{O.popb=!1}),500),O.$ajax.post({url:"include/ajax.php?"+J.encodeUrl("service=task&action=list"),data:{page:1,pageSize:this.pageSize,orderby:0,first:1,stime:a,etime:l}}).then((e=>{100==e.data.state?(O.listdata=e.data.info.list,O.loadingb=!(e.data.info.list.length<this.pageSize)):(O.listdata=null,O.loadingb=!1)}))}}},[["render",function(e,a,t,l,i,s){const n=g,o=C,r=F,d=S,h=D,$=j,U=P(p("private_tip"),z);return c(),u(n,{style:{height:"100%"}},{default:m((()=>[i.appBack?(c(),f(y,{key:0},[b(n,{style:k("height:"+i.wh+"px;background-color: "+i.themedata.themeBackgroundColor+";position: sticky;top: 0rpx;z-index: 99;padding-bottom: 88rpx;")},null,8,["style"]),b(n,{class:"rec-title",style:k("background-color: "+i.themedata.themeBackgroundColor+";top: "+(i.wh+i.biasTop_88)+"px;")},{default:m((()=>[b(o,{src:i.imgurl+"bl-arrow.png?v="+i.imgVersion,onClick:s.backFn,mode:"aspectFill"},null,8,["src","onClick"]),b(n,null,{default:m((()=>[_("首发新单")])),_:1})])),_:1},8,["style"])],64)):v("",!0),b(n,{class:"tabshell",style:k(i.appBack?`'top: calc(${i.wh}px + 88rpx);'`:"top:0rpx")},{default:m((()=>[b(n,{class:"tabchange"},{default:m((()=>[b(r,{"scroll-x":"",enhanced:!0,"show-scrollbar":!1},{default:m((()=>[(c(!0),f(y,null,x(i.tabchange,((e,a)=>(c(),u(n,{class:B(a==i.tabActive?"active":""),"data-index":a,onClick:s.tabchangeFn,key:a},{default:m((()=>[_(T(e.title),1)])),_:2},1032,["class","data-index","onClick"])))),128))])),_:1}),b(n,{class:"classify",onClick:s.popFn,"data-state":"1"},{default:m((()=>[b(o,{src:i.imgurl+"classify.png?v="+i.imgVersion,mode:"aspectFill"},null,8,["src"]),b(d,null,{default:m((()=>[_("筛选")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1},8,["style"]),(c(!0),f(y,null,x(i.listdata,((e,a)=>(c(),u(n,{class:"tabdetails",key:a},{default:m((()=>[b(n,{onClick:a=>s.linkTo(`${i.appBoolean?i.channelDomain:""}${i.pages.details}?id=${e.id}&number=${e.number}&${i.appFullScreen}`)},{default:m((()=>[b(n,{class:"td-title"},{default:m((()=>[b(n,{class:"left"},{default:m((()=>[_(T(e.floortime),1)])),_:2},1024),b(n,{class:"right"},{default:m((()=>[_(T(e.title),1)])),_:2},1024)])),_:2},1024),b(n,{style:{display:"flex"}},{default:m((()=>[b(n,{class:"td-headimg"},{default:m((()=>[b(o,{src:e.photo,mode:"aspectFill"},null,8,["src"])])),_:2},1024),b(n,{class:"td-right"},{default:m((()=>[b(n,{class:"title"},{default:m((()=>[b(n,{class:"left"},{default:m((()=>[_(T(e.title),1)])),_:2},1024),b(n,{style:{"max-width":"122rpx",overflow:"hidden","white-space":"nowrap"}},{default:m((()=>[b(o,{src:i.imgurl+"reward.png?v="+i.imgVersion,mode:"aspectFill"},null,8,["src"]),b(d,null,{default:m((()=>[_(T(e.price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),b(n,{class:"label"},{default:m((()=>[b(n,null,{default:m((()=>[_(T(e.typename),1)])),_:2},1024),b(n,null,{default:m((()=>[_(T(e.project),1)])),_:2},1024)])),_:2},1024),b(n,{class:"more"},{default:m((()=>[b(n,null,{default:m((()=>[_(" 已赚 "),b(d,null,{default:m((()=>[_(T(e.statistics.valid),1)])),_:2},1024),_(" 人 ")])),_:2},1024),b(n,null,{default:m((()=>[_(" 人均用 "),b(d,null,{default:m((()=>[_(T(e.statistics.avg_time),1)])),_:2},1024),_(" 分钟 ")])),_:2},1024),b(n,{style:{"margin-right":"0rpx"}},{default:m((()=>[_(" 平均审核 "),b(d,null,{default:m((()=>[_(T(e.statistics.avg_audit),1)])),_:2},1024),_(" 分钟 ")])),_:2},1024)])),_:2},1024),b(n,{class:"first"},{default:m((()=>[b(n,{class:"f-label"},{default:m((()=>[_("首发")])),_:1}),b(n,{class:"f-nickname"},{default:m((()=>[_("爆料人："+T(e.nickname),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024)))),128)),i.popb?(c(),u(n,{key:1,class:"popup",onClick:s.popFn,"data-state":"0"},{default:m((()=>[b(n,{class:"p-con",style:k("transform: translateY("+(i.popconb?"0%":"100%")+");")},{default:m((()=>[b(n,{class:"pc-btn",onClick:w(s.warningFn,["stop","prevent"])},{default:m((()=>[b(n,{class:"title"},{default:m((()=>[b(n,{class:"cancel",onClick:s.popFn,"data-state":"0"},{default:m((()=>[_("取消")])),_:1},8,["onClick"]),b(n,{class:"text"},{default:m((()=>[_("时间选择")])),_:1}),b(n,{class:"confirm",style:k("color: "+i.themedata.themeBackgroundColor+";"),onClick:s.confirmFn},{default:m((()=>[_("确定")])),_:1},8,["style","onClick"])])),_:1}),b(n,{class:"warning"},{default:m((()=>[_("可筛选时间范围："+T(i.selTime.startRank)+" 至 今天",1)])),_:1}),b(n,{class:"time"},{default:m((()=>[b(n,null,{default:m((()=>[_("开始时间")])),_:1}),b(d,null,{default:m((()=>[_("-")])),_:1}),b(n,null,{default:m((()=>[_("结束时间")])),_:1})])),_:1})])),_:1},8,["onClick"]),b(n,{class:"pc-time",onClick:w(s.warningFn,["stop","prevent"])},{default:m((()=>[b($,{value:i.selPre.startTime,onChange:s.selectFn,"data-state":"0"},{default:m((()=>[b(h,null,{default:m((()=>[(c(!0),f(y,null,x(i.selPre.selitem,((e,a)=>(c(),u(n,{key:a},{default:m((()=>[_(T(e.value),1)])),_:2},1024)))),128))])),_:1}),b(h,null,{default:m((()=>[(c(!0),f(y,null,x(i.selPre.selitem[i.selPre.startTime[0]].month,((e,a)=>(c(),u(n,{key:a},{default:m((()=>[_(T(e.value),1)])),_:2},1024)))),128))])),_:1}),b(h,null,{default:m((()=>[(c(!0),f(y,null,x(i.selPre.selitem[i.selPre.startTime[0]].month[i.selPre.startTime[1]].day,((e,a)=>(c(),u(n,{key:a},{default:m((()=>[_(T(e),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value","onChange"]),b($,{value:i.selPre.endTime,onChange:s.selectFn,"data-state":"1"},{default:m((()=>[b(h,null,{default:m((()=>[(c(!0),f(y,null,x(i.selPre.selitem,((e,a)=>(c(),u(n,{key:a},{default:m((()=>[_(T(e.value),1)])),_:2},1024)))),128))])),_:1}),b(h,null,{default:m((()=>[(c(!0),f(y,null,x(i.selPre.selitem[i.selPre.endTime[0]].month,((e,a)=>(c(),u(n,{key:a},{default:m((()=>[_(T(e.value),1)])),_:2},1024)))),128))])),_:1}),b(h,null,{default:m((()=>[(c(!0),f(y,null,x(i.selPre.selitem[i.selPre.endTime[0]].month[i.selPre.endTime[1]].day,((e,a)=>(c(),u(n,{key:a},{default:m((()=>[_(T(e),1)])),_:2},1024)))),128))])),_:1})])),_:1},8,["value","onChange"])])),_:1},8,["onClick"])])),_:1},8,["style"])])),_:1},8,["onClick"])):v("",!0),b(n,{class:"loadingtext"},{default:m((()=>[_(T(i.loadingb?"加载中...":"没有更多咯~"),1)])),_:1}),b(U,{privateShow:i.privateb},null,8,["privateShow"])])),_:1})}],["__scopeId","data-v-ec001d0c"]]);export{I as default};
