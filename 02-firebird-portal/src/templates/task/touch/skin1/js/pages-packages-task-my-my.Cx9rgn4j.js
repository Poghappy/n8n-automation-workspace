import{j as a,a as e,h as t,b as l,r as o,n,J as i,M as s,f as r,i as d,u,k as c,o as p,l as g,w as m,m as h,q as f,A as k,t as b,v as _,y as D,F as v,x as y,G as F,H as x,B as w,C,D as $,N as B,O as P,z as S}from"./index-cF6skFzP.js";import{r as T,_ as j}from"./uni-app.es.J1otcSEF.js";import{p as I}from"./task.9CwFAmAC.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";let U=h(),R=null;var V;const O=M({data:()=>({globalData:U.globalData,wh:U.globalData.navTop+U.globalData.appFullWh,userError:U.globalData.userError,masterDomain:U.globalData.masterDomain,imgsrc:U.globalData.imgStaticPath+"/noPhoto_100.jpg",biasTop_88:U.globalData.biasTop_88,appBack:U.globalData.appBack,helpurl:null,seturl:null,imgurl:U.globalData.imgPath+"/task/",loginb:!1,privateb:!1,tabbardata:null,userdata:{uid:null,level:[],withdraw:{},order:{},todo:{}},themedata:{},taskData:[{id:1,title:"待提交",src:U.globalData.imgPath+"/task/waitsub.png",state:0},{id:2,title:"审核中",src:U.globalData.imgPath+"/task/auditting.png",state:1},{id:3,title:"已通过",src:U.globalData.imgPath+"/task/agree.png",state:2},{id:4,title:"未通过",src:U.globalData.imgPath+"/task/noagree.png",state:3},{id:5,title:"举报中心",src:U.globalData.imgPath+"/task/complaintO.png",state:4}],otherDate:[{id:1,title:"会员中心",imgsrc:U.globalData.imgPath+"/task/centervip.png"},{id:2,title:"帮助与反馈",imgsrc:U.globalData.imgPath+"/task/help.png"},{id:3,title:"屏蔽管理",imgsrc:U.globalData.imgPath+"/task/shield.png"},{id:4,title:"黑名单中心",imgsrc:U.globalData.imgPath+"/task/blacklist.png"},{id:5,title:"联系客服",imgsrc:U.globalData.imgPath+"/task/kefu.png"},{id:6,title:"设置",imgsrc:U.globalData.imgPath+"/task/seetting.png"}],imgVersion:null,msgNum:0,urlname:"",bgcolor:"",fontcolor:"",name:"",receipt:!1,review:!1,state0:0,state3:0,report:0,needReload:!1,userid:U.globalData.userid,iosMiniHide:!1,pages:"",platForm:U.globalData.platForm,appBoolean:U.globalData.appBoolean,channelDomain:U.globalData.channelDomain,appFullScreen:U.globalData.appFullScreen,appConfig:""}),onLoad(a){(V=this).pages=U.pageFn(I),-1==U.globalData.wxprivate?U.watchG("wxprivate",(function(e){V.wxprivate=e,e?V.privateb=!0:V.onload(a)})):U.globalData.wxprivate?V.privateb=!0:V.onload(a)},onReady(){},onShow(){if(U.globalData.userid!=this.userid&&(V.needReload=!0),this.needReload)return void U.reloadFn();if(!U.globalData.userid)return!1;let a=this;a.getMessage(),R=setInterval((function(){a.getMessage()}),5e3)},onHide(){clearInterval(R)},onUnload(){clearInterval(R)},onPullDownRefresh(){U.reloadFn()},onReachBottom(){},onShareAppMessage(a){return{title:this.themedata.title+" 个人中心",imageUrl:this.themedata.sharePic}},onShareTimeline(){return{title:this.themedata.title+" 个人中心",imageUrl:this.themedata.sharePic}},methods:{onload(o){if(U.watchG("appConfig",(a=>{V.urlname=a.cfg_user_index,V.seturl=U.addUrlParam(a.cfg_user_index+"/setting.html")})),this.checkiOSMini(),o.access_token&&o.refresh_token){U.globalData.userid=o.userid,a({key:"access_token",data:o.access_token}),a({key:"refresh_token",data:o.refresh_token});var n=Date.parse(new Date)/1e3+7200-20;a({key:"token_expired",data:n}),a({key:"userid",data:o.userid})}V.helpurl=U.addUrlParam(V.masterDomain+"/help.html"),V.imgVersion=U.globalData.imgVersion,e({title:"加载中",mask:!0,success:()=>{V.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((a=>{null!=a.data.info.themeBackgroundColor?(V.themedata=a.data.info,t()):(t(),l({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}}),V.$ajax.post({url:"include/ajax.php?service=siteConfig&action=touchHomePageFooter&version=2.0&module=task"}).then((a=>{for(let e=0;e<a.data.info.length;e++)a.data.info[e].url&&(a.data.info[e].url=U.addUrlParam(a.data.info[e].url));V.tabbardata=a.data.info})),V.setBgColor("#F5F5F5");var i=U.globalData.userid;if(null==i||""==i)return U.loginCheck(V.pages.my),!1;V.$ajax.post({url:"include/ajax.php?"+U.encodeUrl("service=task&action=memberInfo")}).then((a=>{100==a.data.state&&(V.userdata=a.data.info)}))},linkTo(a,e=!1){if(a)if("web"==V.platForm){if(window.appBoolean)return window.setupWebViewJavascriptBridge((function(e){e.callHandler("redirectNative",{name:"",code:"",link:a},(function(){}))})),!1;a.indexOf("http")>-1?location.href=a:e?o({url:a}):n({url:a})}else{if(a.includes("tomini")){let e=a.split("?")[1].split("&");for(let t=0;t<e.length;t++)if(e[t].includes("tomini")){a=e[t].replace("tomini=",""),e.splice(t,1);break}a+=`?${e.join("&")}`}e?o({url:a.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(a):a}):n({url:a.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(a):a})}},setBgColor(a){"web"!=V.platForm&&uni.setBackgroundColor({backgroundColor:a,fail:a=>{console.log(a)}})},publishFn(){if(0==this.userdata.certifyState){let a=U.globalData.appConfig.cfg_user_index+"/security-shCertify.html";V.linkTo(U.addUrlParam(a))}else 0==this.userdata.surplusReleaseCount?i({title:"友情提示",content:"您的账户剩余发布任务数量不足，请结束正在进行中的任务或者升级会员等级后发布！",confirmText:"升级会员",success(a){a.confirm?V.linkTo(`${V.appBoolean?V.channelDomain:""}${V.pages.vip}?${V.appFullScreen}`):a.cancel&&console.log("用户点击取消")}}):V.linkTo(`${V.appBoolean?V.channelDomain:""}${V.pages.publish}?step=1&${V.appFullScreen}&clear=1`)},loginFn(){var a=U.globalData.userid;if(null==a||""==a)return V.needReload=!0,U.loginCheck(V.pages.my),!1},kefuFn(){Boolean(-1!=this.themedata.kefuLink.indexOf("weixin.qq.com")&&this.themedata.kefuId&&"mp-weixin"==this.platForm)?uni.openCustomerServiceChat({extInfo:{url:this.themedata.kefuLink},corpId:this.themedata.kefuId}):this.themedata.kefuLink.indexOf("tel:")>-1?s({phoneNumber:this.themedata.kefuLink.replace("tel:","")}):V.linkTo(U.addUrlParam(this.themedata.kefuLink))},getMessage(){if(r("access_token")){var e=U.encodeUrl("service=member&action=message&type=tongji&im=1");V.$ajax.post({url:"include/ajax.php?"+e}).then((e=>{var t=e.data;100==t.state?V.msgNum=t.info.pageInfo.total>99?"99+":t.info.pageInfo.total:"用户信息验证失败"==t.info&&setTimeout((function(){r("access_token")?u.unit(r("refresh_token"),V.masterDomain,(function(e){if(100==e.state){console.log("更新成功"),console.log(e.info);var t=e.info.access_token,l=e.info.refresh_token;a({key:"access_token",data:t}),a({key:"refresh_token",data:l});var o=Date.parse(new Date)/1e3+7200-20;a({key:"token_expired",data:o}),U.globalData.access_token=t,U.globalData.refresh_token=l,U.globalData.token_expired=o}else{d({key:"userid"}),d({key:"access_token"}),d({key:"refresh_token"}),d({key:"token_expired"}),U.globalData.userid=null,U.globalData.access_token=null,U.globalData.refresh_token=null,U.globalData.token_expired=null;var n=encodeURIComponent(V.masterDomain+"/logout.html?redirect="+V.masterDomain+"/login.html");V.linkTo(n)}})):(l({title:"账号状态异常，请重新登录！",icon:"none",duration:2e3}),d({key:"userid"}),d({key:"access_token"}),d({key:"refresh_token"}),d({key:"token_expired"}),U.globalData.userid=null,U.globalData.access_token=null,U.globalData.refresh_token=null,U.globalData.token_expired=null,V.needReload=!0,V.backFn())}),1e3)}))}else V.msgNum=0},tabbarFn(){console.log("占位：函数 tabbarFn 未声明")},checkiOSMini(){const a=this;a.iosMiniHide=U.globalData.iOSMiniPay_forbid,U.globalData.appConfig||U.essentialData((function(e){a.iosMiniHide=e.iOSMiniPay_forbid}))}}},[["render",function(a,e,t,l,o,n){const i=f,s=C,r=$,d=T(c("private_tip"),j);return p(),g(i,{style:{height:"100%"}},{default:m((()=>[o.appBack?(p(),k(v,{key:0},[b(i,{style:_("height:"+o.wh+"px;position: sticky;top: 0rpx;z-index: 99;background-color: #F5F5F5;padding-bottom: 88rpx;"),catchtouchmove:""},null,8,["style"]),b(i,{class:"rec-title",style:_("top: "+(o.wh+o.biasTop_88)+"px;")},{default:m((()=>[b(i,null,{default:m((()=>[D("我的")])),_:1})])),_:1},8,["style"])],64)):y("",!0),b(i,{class:"user-detail"},{default:m((()=>[b(i,{class:"ud-header",onClick:e[2]||(e[2]=a=>o.userdata.uid?"":n.loginFn())},{default:m((()=>[b(s,{src:o.userdata.photo||o.imgsrc,class:"udh-photo",mode:"aspectFill",onError:e[0]||(e[0]=a=>o.userdata.photo=o.imgsrc)},null,8,["src"]),b(i,{class:"udh-details",style:_(o.userdata.uid?"":"align-items:center;flex-direction:row")},{default:m((()=>[o.userdata.uid?(p(),g(i,{key:0,class:"title"},{default:m((()=>[b(r,{class:"name"},{default:m((()=>[D(F(o.userdata.nickname),1)])),_:1}),b(r,null,{default:m((()=>[D("ID："+F(o.userdata.uid),1)])),_:1})])),_:1})):y("",!0),o.iosMiniHide?y("",!0):(p(),k(v,{key:1},[0==o.userdata.level.length&&o.userdata.uid?(p(),g(i,{key:0,onClick:e[1]||(e[1]=a=>n.linkTo(`${o.appBoolean?o.channelDomain:""}${o.pages.vip}?index=0&${o.appFullScreen}`)),class:"label"},{default:m((()=>[D(" 非会员 "),b(s,{src:o.imgurl+"rw-arrow.png?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1})):y("",!0),0!=o.userdata.level.length&&o.userdata.uid?(p(),g(i,{key:1,class:"label vip",style:_("background: "+o.userdata.level.bgcolor+";color: "+o.userdata.level.fontcolor+";")},{default:m((()=>[D(F(o.userdata.level.name),1)])),_:1},8,["style"])):y("",!0)],64)),o.userdata.uid?y("",!0):(p(),g(i,{key:2,style:{color:"#4d515d","font-weight":"800","font-size":"32rpx"}},{default:m((()=>[D("登录/注册")])),_:1}))])),_:1},8,["style"])])),_:1}),b(i,{class:"ud-money",onClick:e[4]||(e[4]=a=>o.userdata.uid?"":n.loginFn()),style:_("background: url("+o.imgurl+"moneyCard.png?v="+o.imgVersion+") no-repeat;background-size: cover;background-color:"+o.themedata.themeBackgroundColor)},{default:m((()=>[b(i,{class:"udm-title"},{default:m((()=>[D("用户余额")])),_:1}),b(i,{class:"udm-money"},{default:m((()=>[b(i,null,{default:m((()=>[b(r,null,{default:m((()=>[D(F(o.userdata.money?o.userdata.money:"0.00"),1)])),_:1}),D(" "+F(o.globalData.appConfig.currency?o.globalData.appConfig.currency.short:"元"),1)])),_:1}),b(i,{class:"btn",onClick:e[3]||(e[3]=x((a=>o.userdata?n.linkTo(`${o.urlname}/withdraw.html`):n.loginFn()),["stop","prevent"]))},{default:m((()=>[D(" 提现 ")])),_:1})])),_:1}),b(i,{class:"udm-earn"},{default:m((()=>[b(i,null,{default:m((()=>[D("今日已到账："+F(o.userdata.withdraw.receipt?o.userdata.withdraw.receipt:"0.00")+F(o.globalData.appConfig.currency?o.globalData.appConfig.currency.short:"元"),1)])),_:1}),b(i,null,{default:m((()=>[D("待审核金额："+F(o.userdata.withdraw.review?o.userdata.withdraw.review:"0.00")+F(o.globalData.appConfig.currency?o.globalData.appConfig.currency.short:"元"),1)])),_:1})])),_:1})])),_:1},8,["style"]),b(i,{class:"ud-task"},{default:m((()=>[b(i,{class:"udt-title"},{default:m((()=>[b(i,{class:"left"},{default:m((()=>[D("我的任务")])),_:1}),b(i,{class:"right",onClick:e[5]||(e[5]=a=>o.userdata.uid?n.linkTo(`${o.appBoolean?o.channelDomain:""}${o.pages.browser}?${o.appFullScreen}`):n.loginFn())},{default:m((()=>[D(" 浏览记录 "),b(s,{src:o.imgurl+"r-arrow.png?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:1})])),_:1}),b(i,{class:"udt-order"},{default:m((()=>[(p(!0),k(v,null,w(o.taskData,((a,e)=>(p(),g(i,{class:"items",key:e},{default:m((()=>[b(i,{onClick:t=>o.userdata.uid?n.linkTo(o.userdata.uid&&4!=e?`${o.appBoolean?o.channelDomain:""}${o.pages.orderlist}?state=${a.state}&${o.appFullScreen}`:`${o.appBoolean?o.channelDomain:""}${o.pages.complainCenter}?state=0&${o.appFullScreen}`):n.loginFn()},{default:m((()=>[b(s,{src:a.src+"?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"]),b(i,null,{default:m((()=>[D(F(a.title),1)])),_:2},1024),1!=e&&2!=e&&(0==e&&0!=o.userdata.order.state0||3==e&&0!=o.userdata.order.state3||4==e&&0!=o.userdata.todo.report)&&o.userdata?(p(),g(i,{key:0,class:"propagation"},{default:m((()=>[D(F(0==e?o.userdata.order.state0:3==e?o.userdata.order.state3:o.userdata.todo.report),1)])),_:2},1024)):y("",!0)])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1})])),_:1}),b(i,{class:"ud-center"},{default:m((()=>[b(i,{class:"udc-title"},{default:m((()=>[D("商家中心")])),_:1}),b(i,{class:"udc-items"},{default:m((()=>[b(i,{class:"item",onClick:e[6]||(e[6]=a=>o.userdata.uid?n.publishFn():n.loginFn())},{default:m((()=>[b(s,{src:o.imgurl+"freepub.png?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"]),D(" 免费发布 ")])),_:1}),b(i,{class:"item",onClick:e[7]||(e[7]=a=>o.userdata.uid?n.linkTo(`${o.appBoolean?o.channelDomain:""}${o.pages.mercenter}?${o.appFullScreen}`):n.loginFn())},{default:m((()=>[b(s,{src:o.imgurl+"taskdo.png?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"]),D(" 任务管理 ")])),_:1})])),_:1})])),_:1}),b(i,{class:"ud-other"},{default:m((()=>[(p(!0),k(v,null,w(o.otherDate,((a,e)=>B((p(),g(i,{class:"udo-item",onClick:x((a=>4==e?n.kefuFn():n.linkTo(0==e?`${o.appBoolean?o.channelDomain:""}${o.pages.vip}?index=0&${o.appFullScreen}`:1==e?o.helpurl:2==e?`${o.appBoolean?o.channelDomain:""}${o.pages.shield}?${o.appFullScreen}`:3==e?`${o.appBoolean?o.channelDomain:""}${o.pages.blacklist}?${o.appFullScreen}`:4==e?"":o.seturl)),["stop","prevent"]),key:e},{default:m((()=>[b(i,{class:"left"},{default:m((()=>[b(s,{src:a.imgsrc+"?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"]),D(" "+F(a.title),1)])),_:2},1024),b(i,{class:"right"},{default:m((()=>[D(F(0==e?"专享特权":"")+" ",1),b(s,{src:o.imgurl+"r-arrow.png?v="+o.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:2},1024)])),_:2},1032,["onClick"])),[[P,!o.iosMiniHide||0!=e]]))),128))])),_:1})])),_:1}),b(i,{style:{height:"112rpx","padding-bottom":"calc(-10rpx + env(safe-area-inset-bottom))"}}),o.appBoolean?y("",!0):(p(),g(i,{key:1,class:"tabBar"},{default:m((()=>[(p(!0),k(v,null,w(o.tabbardata,((a,e)=>(p(),g(i,{class:S(4==e?"active":""),onClick:n.tabbarFn,"data-index":e,key:e},{default:m((()=>[b(i,{onClick:t=>4!=e?n.linkTo("web"==o.platForm?a.url:a.miniPath||a.url,!0):""},{default:m((()=>[b(s,{src:4!=e?a.icon:a.icon_h,mode:"aspectFill"},null,8,["src"]),a.message&&o.msgNum>0?(p(),g(i,{key:0,class:"msg"},{default:m((()=>[D(F(o.msgNum?o.msgNum:0),1)])),_:1})):y("",!0),b(r,null,{default:m((()=>[D(F(a.name),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1032,["class","onClick","data-index"])))),128))])),_:1})),b(d,{privateShow:o.privateb},null,8,["privateShow"])])),_:1})}],["__scopeId","data-v-9445fe83"]]);export{O as default};
