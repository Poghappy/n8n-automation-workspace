import{c as e,a as t,P as a,i as o,j as r,h as i,b as l,_ as s,d as n,e as d,r as p,n as c,R as u,k as g,o as f,l as k,w as b,m as v,q as _,A as y,t as w,v as C,y as x,F,x as D,G as T,H as B,B as $,C as j,D as S,z as V,W as M}from"./index-cF6skFzP.js";import{_ as U}from"./previewMedia.C3gYMXHd.js";import{r as I,_ as E}from"./uni-app.es.J1otcSEF.js";import{p as H}from"./task.9CwFAmAC.js";import{_ as P}from"./_plugin-vue_export-helper.BCo6x5W8.js";var R;let W=v();var G;const O=P({data:()=>({wh:W.globalData.navTop+W.globalData.appFullWh,masterDomain:W.globalData.masterDomain,biasTop_88:W.globalData.biasTop_88,appBack:W.globalData.appBack,headerh:0,userError:W.globalData.userError,imgurl:W.globalData.imgPath+"/task/",themedata:{},recordata:{video:{}},reportdata:{report:[]},moreb:!1,privateb:!1,popb:!1,merchantb:!1,firstb:!0,warningb:!1,previewb:!1,staticSrc:[],userid:null,uid:null,date:null,explain:null,state:null,imgVersion:null,tid:"",oid:"",info:"",popstate:0,timeout:{hour:"",minutes:"",seconds:""},winner:0,admin_time:"",note:"",pages:"",platForm:W.globalData.platForm,appBoolean:W.globalData.appBoolean,channelDomain:W.globalData.channelDomain,appFullScreen:W.globalData.appFullScreen}),onLoad(e){R=this,-1==W.globalData.wxprivate?W.watchG("wxprivate",(function(t){R.wxprivate=t,t?R.privateb=!0:R.onload(e)})):W.globalData.wxprivate?R.privateb=!0:R.onload(e)},onReady(){setTimeout((()=>{let t=e();t.select(".rec-title").boundingClientRect(),t.exec((e=>{e[0]&&(R.headerh=e[0].height)}))}),1e3)},onShow(){clearInterval(G),this.firstb?R.firstb=!1:W.reloadFn()},onHide(){clearInterval(G)},onUnload(){clearInterval(G)},onPullDownRefresh(){},onReachBottom(){},onShareAppMessage(e){return{title:this.themedata.title,imageUrl:this.themedata.sharePic,path:"/pages/packages/task/my/my"}},onShareTimeline(){return{title:this.themedata.title,imageUrl:this.themedata.sharePic,path:"/pages/packages/task/my/my"}},methods:{onload(e){e&&(R.explain=e.explain,R.date=e.date,R.state=e.state,R.imgVersion=W.globalData.imgVersion,R.tid=e.tid,R.oid=e.orderid,R.merchantb=1==e.merchant),t({title:"加载中",mask:!0,success:()=>{a({key:"warnColor",success:e=>{a({key:"warnColor",success:e=>{R.themedata=e.data.themeDate,R.setBgColor(this.themedata.themeBackgroundColor),e.data.outtime<Date.parse(new Date)&&o({key:"warnColor",success:()=>{R.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((e=>{null!=e.data.info.themeBackgroundColor?(R.themedata=e.data.info,r({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),R.setBgColor(this.themedata.themeBackgroundColor),i()):(i(),l({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}}),i()},fail:e=>{R.$ajax.post({url:"include/ajax.php?service=task&action=config"}).then((e=>{null!=e.data.info.themeBackgroundColor?(R.themedata=e.data.info,r({key:"warnColor",data:{themeDate:this.themedata,outtime:Date.parse(new Date)+36e5}}),R.setBgColor(this.themedata.themeBackgroundColor),i()):(i(),l({title:"服务器出错",icon:"error",mask:!0,duration:5e3}))}))}})}});var n="service=task&action=orderLog&id="+this.oid,d=W.encodeUrl(n);R.$ajax.post({url:"include/ajax.php?"+d}).then((e=>{if(100==e.data.state){if(e.data.info.map((e=>{e.date=this.timestampToTime(e.time)})),W.globalData.userid){for(let t=0;t<e.data.info.length;t++){if(e.data.info[t].value){e.data.info[t].value=e.data.info[t].value.split("||").filter((e=>e));let a=[];for(let o=0;o<e.data.info[t].value.length;o++){let r={};r.url=e.data.info[t].value[o];let i=e.data.info[t].value[o].split(".");r.type="mp4"==i[i.length-1]?"video":"image","video"==r.type?e.data.info[t].video=r:a.push(r)}e.data.info[t].value=a}e.data.info[t].uid!=W.globalData.userid&&(R.uid=e.data.info[t].uid)}R.recordata=e.data.info,R.userid=W.globalData.userid}}else l({icon:"error",title:e.data.info,success:e=>{setTimeout((e=>{s()}),2e3)}})}));n="service=task&action=detail&id="+this.tid+"&oid="+this.oid,d=W.encodeUrl(n);R.$ajax.post({url:"include/ajax.php?"+d}).then((e=>{if(100==e.data.state){let t=e.data.info.order_data;2==t.report.state?t.report.admin_time=this.timestampToTime(t.report.admin_time):3==t.report.state&&(this.merchantb?this.userid==t.report.mid&&0==t.report.admin_time?t.report.admin_time=this.timestampToTime(t.qx_time):0==t.report.admin_time?t.report.admin_time=this.timestampToTime(t.sh_time):t.report.admin_time=this.timestampToTime(t.report.admin_time):this.userid==t.report.mid?t.report.admin_time=this.timestampToTime(t.sh_time):t.report.admin_time=this.timestampToTime(t.qx_time)),t.report.uid&&0==t.report.state&&(R.timeout={time:t.report.expired_second,hour:"00",minutes:"00",seconds:"00"},G=setInterval((()=>{this.countdown()}),1e3)),R.reportdata=t,R.date=this.timestampToTime(e.data.info.order_data.sh_time)}})),R.pages=W.pageFn(H)},backFn(){if(R.appBoolean)return window.setupWebViewJavascriptBridge((function(e){e.callHandler("goBack",{},(function(e){}))})),!1;{let e=n();e&&e.length>1?d({delta:1}):"web"==R.platForm?location.href=`${R.masterDomain}${window.pathname}${R.pages.index}`:p({url:"/pages/packages/task/index/index"})}},linkTo(e){if(e)if("web"==R.platForm){if(window.appBoolean)return window.setupWebViewJavascriptBridge((function(t){t.callHandler("redirectNative",{name:"",code:"",link:e},(function(){}))})),!1;e.indexOf("http")>-1?location.href=e:c({url:e})}else{if(e.includes("tomini")){let t=e.split("?")[1].split("&");for(let a=0;a<t.length;a++)if(t[a].includes("tomini")){e=t[a].replace("tomini=",""),t.splice(a,1);break}e+=`?${t.join("&")}`}c({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e})}},setBgColor(e){"web"!=R.platForm&&uni.setBackgroundColor({backgroundColor:e,fail:e=>{console.log(e)}})},warningFn(){R.warningb=!this.warningb,setTimeout((()=>{R.warningb=!this.warningb}),2e3)},moreFn(){R.moreb=!this.moreb},timestampToTime(e){var t=new Date(1e3*e);let a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"月",o=t.getDate()+"日";return t.getHours(),t.getHours(),t.getMinutes(),t.getMinutes(),a+o+h+m},countdown(){R.timeout={time:--this.timeout.time,hour:this.timeout.hour,minutes:this.timeout.minutes,seconds:this.timeout.seconds};let e=this.timeout.time,t=e%60,a=Math.floor(e%3600/60),o=Math.floor(e/3600);t<0?clearInterval(G):(o/10<1&&(o="0"+o),a/10<1&&(a="0"+a),t/10<1&&(t="0"+t)),R.timeout={time:this.timeout.time,hour:o,minutes:a,seconds:t}},previewFn(e){if("mp-weixin"==R.platForm)uni.previewMedia({sources:e});else if(e[0].type.includes("image")){let t=[];for(let a=0;a<e.length;a++)t.push(e[a].url);u({urls:t})}else this.previewb=!0,this.staticSrc[0]={type:"video",value:e[0].url}},giveupFn(e){0==e.currentTarget.dataset.state?(R.popstate=0,R.popb=!0):(t({title:"加载中",mask:!0}),R.$ajax.post({url:"include/ajax.php?"+W.encodeUrl("service=task&action=cancelOrder"),data:{id:this.oid}}).then((e=>{i(),R.info=e.data.info,R.popb=!1,this.warningFn(),setTimeout((()=>{this.backFn()}),2e3)})))},recrossFn(e){0==e.currentTarget.dataset.state?(R.popstate=1,R.popb=!0):(t({title:"加载中",mask:!0}),R.$ajax.post({url:"include/ajax.php?"+W.encodeUrl("service=task&action=passOrder"),data:{id:this.oid}}).then((e=>{i(),R.info=e.data.info,R.popb=!1,this.warningFn(),setTimeout((()=>{this.backFn()}),2200)})))},popFn(){R.popb=!1},shieldFn(e){if(0==e.currentTarget.dataset.state)R.popstate=2,R.popb=!0;else{let e={type:0};e.ctype=this.merchantb?1:2,e.content=this.uid,R.$ajax.post({url:"include/ajax.php?"+W.encodeUrl("service=task&action=addShield"),data:e}).then((e=>{R.info=e.data.info,R.popb=!1,this.warningFn()}))}},timestampToTime(e){const t=W.dateFormatter(e);return t.year+"-"+(t.month+"-")+(t.day+" ")+(t.hour+":")+(t.minute+":")+t.second}}},[["render",function(e,t,a,o,r,i){const l=_,s=j,n=S,d=M,p=I(g("previewMedia"),U),c=I(g("private_tip"),E);return f(),k(l,{style:{height:"100%"}},{default:b((()=>[r.appBack?(f(),y(F,{key:0},[w(l,{style:C("height:"+r.wh+"px;background-color: "+r.themedata.themeBackgroundColor+";position: sticky;top: 0rpx;z-index: 99;padding-bottom: 88rpx;"),catchtouchmove:""},null,8,["style"]),w(l,{class:"rec-title",style:C("background-color: "+r.themedata.themeBackgroundColor+";top: "+(r.wh+r.biasTop_88)+"px;")},{default:b((()=>[w(s,{src:r.imgurl+"bl-arrow.png?v="+r.imgVersion,onClick:i.backFn,mode:"aspectFill"},null,8,["src","onClick"]),w(l,null,{default:b((()=>[x("订单提交记录")])),_:1})])),_:1},8,["style"])],64)):D("",!0),w(l,{class:"aud-title",style:C("top:calc("+r.wh+"px + "+r.headerh+"px)")},{default:b((()=>[0==r.reportdata.report.length?(f(),k(l,{key:0},{default:b((()=>[w(l,{class:"title"},{default:b((()=>[x(T(1==r.state?"审核中":3==r.state?"审核拒绝":r.explain),1)])),_:1}),1!=r.state&&4!=r.state?(f(),k(l,{key:0,class:"time"},{default:b((()=>[w(l,null,{default:b((()=>[x(T(3==r.state?"审核拒绝时间：":"审核通过时间：")+T(r.date),1)])),_:1}),w(s,{src:r.imgurl+"dotted.png?v="+r.imgVersion,mode:"aspectFill",onClick:i.moreFn},null,8,["src","onClick"]),w(l,{class:"pop",style:C("transform: scale("+(r.moreb?1:0)+");")},{default:b((()=>[w(l,{onClick:t[0]||(t[0]=e=>i.linkTo(`${r.appBoolean?r.channelDomain:""}${r.pages.orderDetail}?tid=${r.tid}&orderid=${r.oid}${r.merchantb?"&merchant=1":""}&${r.appFullScreen}`))},{default:b((()=>[w(s,{src:r.imgurl+"detailW.png?v="+r.imgVersion,mode:"aspectFill"},null,8,["src"]),w(n,null,{default:b((()=>[x("任务详情")])),_:1})])),_:1}),w(l,{onClick:B(i.shieldFn,["stop","prevent"]),"data-state":"0"},{default:b((()=>[w(s,{src:r.imgurl+"uforbidG.png?v="+r.imgVersion,mode:"aspectFill"},null,8,["src"]),w(n,null,{default:b((()=>[x("屏蔽"+T(r.merchantb?"用户":"商家"),1)])),_:1})])),_:1},8,["onClick"])])),_:1},8,["style"])])),_:1})):D("",!0),3==r.state&&r.merchantb?(f(),k(l,{key:1,class:"btn"},{default:b((()=>[w(l,{onClick:t[1]||(t[1]=e=>i.linkTo(`${r.appBoolean?r.channelDomain:""}${r.pages.complaint}?complaint=1&oid=${r.oid}&${r.appFullScreen}`)),class:"giveup",style:C("background-color: "+r.themedata.themeBackgroundColor+";")},{default:b((()=>[x(" 举报维权 ")])),_:1},8,["style"]),w(l,{class:"giveup",style:C("background-color: "+r.themedata.themeBackgroundColor+";"),onClick:B(i.recrossFn,["stop","prevent"]),"data-state":"0"},{default:b((()=>[x("重新通过")])),_:1},8,["style","onClick"])])),_:1})):D("",!0)])),_:1})):D("",!0),r.reportdata.report.uid?(f(),k(l,{key:1},{default:b((()=>[w(l,{class:"title"},{default:b((()=>[x(T(0==r.reportdata.report.state?r.reportdata.report.uid==r.userid?"等待对方辩诉":"等待我辩诉":1==r.reportdata.report.state?"等待平台判定":0==r.reportdata.report.winner?"对方胜诉":"您胜诉"),1)])),_:1}),w(l,{class:"time"},{default:b((()=>[r.reportdata.report.uid==r.userid&&0==r.reportdata.report.state?(f(),k(l,{key:0,class:"left"},{default:b((()=>[x(" 若"+T(r.merchantb?"用户":"商家")+"未在"+T(r.timeout.hour)+":"+T(r.timeout.minutes)+":"+T(r.timeout.seconds)+"提交证据将判您胜诉 ",1)])),_:1})):D("",!0),r.reportdata.report.uid!=r.userid&&0==r.reportdata.report.state?(f(),k(l,{key:1,class:"left"},{default:b((()=>[x(" 请您在 "),w(n,null,{default:b((()=>[x(T(r.timeout.hour)+":"+T(r.timeout.minutes)+":"+T(r.timeout.seconds),1)])),_:1}),x(" 内提交证据，逾期将判对方胜诉 ")])),_:1})):D("",!0),1==r.reportdata.report.state?(f(),k(l,{key:2,class:"left"},{default:b((()=>[x(T(r.reportdata.report.uid==r.userid?"对方":"您")+"已提供辩诉证据，平台将介入判定 ",1)])),_:1})):D("",!0),0!=r.reportdata.report.state&&1!=r.reportdata.report.state?(f(),k(l,{key:3,class:"left",style:{color:"#999999"}},{default:b((()=>[x(" 判定时间："+T(r.reportdata.report.admin_time),1)])),_:1})):D("",!0),w(s,{src:r.imgurl+"dotted.png?v="+r.imgVersion,mode:"aspectFill",onClick:i.moreFn},null,8,["src","onClick"]),w(l,{class:"pop",style:C("transform: scale("+(r.moreb?1:0)+");")},{default:b((()=>[w(l,{onClick:t[2]||(t[2]=e=>i.linkTo(`${r.appBoolean?r.channelDomain:""}${r.pages.orderDetail}?tid=${r.tid}&orderid=${r.oid}&merchant=${r.merchantb?1:0}&${r.appFullScreen}`))},{default:b((()=>[w(s,{src:r.imgurl+"detailW.png?v="+r.imgVersion,mode:"aspectFill"},null,8,["src"]),w(n,null,{default:b((()=>[x("任务详情")])),_:1})])),_:1}),w(l,{onClick:B(i.shieldFn,["stop","prevent"]),"data-state":"0"},{default:b((()=>[w(s,{src:r.imgurl+"uforbidG.png?v="+r.imgVersion,mode:"aspectFill"},null,8,["src"]),w(n,null,{default:b((()=>[x("屏蔽"+T(r.merchantb?"用户":"商家"),1)])),_:1})])),_:1},8,["onClick"])])),_:1},8,["style"])])),_:1}),0!=r.reportdata.report.state&&1!=r.reportdata.report.state?(f(),k(l,{key:0,class:"note"},{default:b((()=>[x(" 平台判断"+T(0==r.reportdata.report.winner?"对方胜诉":"您胜诉")+"，理由："+T(r.reportdata.report.note),1)])),_:1})):D("",!0),0==r.reportdata.report.state?(f(),k(l,{key:1,class:"btn"},{default:b((()=>[r.merchantb||r.reportdata.report.uid!=r.userid?D("",!0):(f(),k(l,{key:0,class:"giveup",style:C("background-color: "+r.themedata.themeBackgroundColor+";"),onClick:B(i.giveupFn,["stop","prevent"]),"data-state":"0"},{default:b((()=>[x(" 放弃举报 ")])),_:1},8,["style","onClick"])),r.reportdata.report.uid!=r.userid?(f(),k(l,{key:1,onClick:t[3]||(t[3]=e=>i.linkTo(`${r.appBoolean?r.channelDomain:""}${r.pages.complaint}?complaint=0&oid=${r.oid}&${r.appFullScreen}`)),class:"giveup",style:C("background-color: "+r.themedata.themeBackgroundColor+";")},{default:b((()=>[x(" 提交证据 ")])),_:1},8,["style"])):D("",!0),r.merchantb?(f(),k(l,{key:2,class:"giveup",style:C("background-color: "+r.themedata.themeBackgroundColor+";"),onClick:B(i.recrossFn,["stop","prevent"]),"data-state":"0"},{default:b((()=>[x(" 重新通过 ")])),_:1},8,["style","onClick"])):D("",!0)])),_:1})):D("",!0)])),_:1})):D("",!0)])),_:1},8,["style"]),w(l,{class:"his-record"},{default:b((()=>[(f(!0),y(F,null,$(r.recordata,((e,t)=>(f(),k(l,{class:V(r.userid!=e.uid?"his-right":"his-left"),key:t},{default:b((()=>[w(s,{src:e.photo||r.userError,mode:"aspectFill",class:"hisr-photo",onError:t=>e.photo=r.userError},null,8,["src","onError"]),w(l,{class:"hisr-content",style:C("background: "+(r.userid!=e.uid?"":r.themedata.themeBackgroundColor)+";")},{default:b((()=>[w(l,{class:"state",style:C("margin-bottom:"+(e.value?"26rpx":"0rpx"))},{default:b((()=>[x(T(e.date)+" ",1),w(n,null,{default:b((()=>[x("|")])),_:1}),x(" "+T(e.title),1)])),_:2},1032,["style"]),e.video?(f(),k(l,{key:0,class:"description",onClick:B((t=>i.previewFn([e.video])),["stop","prevent"]),style:{"margin-right":"10rpx"}},{default:b((()=>[w(d,{src:e.video.url,"data-index":t,controls:!1,"show-center-play-btn":!1},null,8,["src","data-index"]),w(s,{class:"pause",src:r.imgurl+"pause.png?v="+r.imgVersion,mode:"aspectFill"},null,8,["src"])])),_:2},1032,["onClick"])):D("",!0),e.value?(f(),k(l,{key:1,class:"description"},{default:b((()=>[w(s,{src:e.value[0].url,onClick:B((t=>i.previewFn(e.value)),["stop","prevent"]),"data-index":t,mode:"aspectFill",class:"desimg"},null,8,["src","onClick","data-index"]),w(l,null,{default:b((()=>[x("共"+T(e.value.length)+"张",1)])),_:2},1024)])),_:2},1024)):D("",!0),w(l,{class:"arrow",style:C("border-left: 10rpx solid "+r.themedata.themeBackgroundColor+";")},null,8,["style"])])),_:2},1032,["style"])])),_:2},1032,["class"])))),128))])),_:1}),r.popb?(f(),k(l,{key:1,class:"st-pop",onClick:i.popFn},{default:b((()=>[w(l,{class:"pop-content",catchtap:""},{default:b((()=>[2!=r.popstate?(f(),k(l,{key:0,class:"title"},{default:b((()=>[x("请确认是否"+T(0==r.popstate?"放弃举报":"重新通过"),1)])),_:1})):D("",!0),2==r.popstate?(f(),k(l,{key:1,class:"refuse"},{default:b((()=>[w(l,{class:"r-title"},{default:b((()=>[x("确定屏蔽该"+T(r.merchantb?"用户":"商家")+"吗",1)])),_:1}),w(l,{class:"r-text"},{default:b((()=>[x("屏蔽后该"+T(r.merchantb?"用户":"商家")+"不可再接我的任务",1)])),_:1})])),_:1})):D("",!0),w(l,{class:"btn"},{default:b((()=>[w(l,{class:"cancel",onClick:B(i.popFn,["stop","prevent"])},{default:b((()=>[x("取消")])),_:1},8,["onClick"]),w(l,{class:"confirm",style:C("background: "+r.themedata.themeBackgroundColor+";"),onClick:t[4]||(t[4]=B((e=>0==r.popstate?i.giveupFn(e):1==r.popstate?i.recrossFn(e):i.shieldFn(e)),["stop","prevent"])),"data-state":"1"},{default:b((()=>[x(" 确认"+T(0==r.popstate?"放弃":1==r.popstate?"通过":"屏蔽"),1)])),_:1},8,["style"])])),_:1})])),_:1})])),_:1},8,["onClick"])):D("",!0),w(l,{class:"pop-warning",style:C(r.warningb?"transform:scale(1);":"transform:scale(0);z-index:-1;")},{default:b((()=>[w(l,{class:"text",style:{transform:"translate(-50%, -50%)"}},{default:b((()=>[x(T(r.info),1)])),_:1})])),_:1},8,["style"]),w(p,{previewb:r.previewb,staticSrc:r.staticSrc,onPreviewClose:t[5]||(t[5]=e=>r.previewb=!1)},null,8,["previewb","staticSrc"]),w(c,{privateShow:r.privateb},null,8,["privateShow"])])),_:1})}],["__scopeId","data-v-fcc1b2e4"]]);export{O as default};
