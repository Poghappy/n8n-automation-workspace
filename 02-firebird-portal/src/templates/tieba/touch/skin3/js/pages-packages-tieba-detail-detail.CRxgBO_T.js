import{g as t,k as e,K as i,L as a,M as n,o,c as s,w as r,a as l,n as c,e as d,t as h,f as u,d as p,F as f,r as m,b as g,x as b,N as y,O as v,y as x,z as w,i as _,A as k,E as I,P as S,Q as C,R as F,p as $,B as P,T as z,U as D,V as T,W as M,X as B,Y as W,Z as O,D as j,C as L,h as A,_ as R,m as E,$ as V,a0 as H}from"./index-VDmuvODd.js";import{_ as U,r as N,b as q,p as Y,d as J,a as G,c as X}from"./tieba.Bhdfcttv.js";var Q,Z;const K=x();const et=U({name:"pay",props:{payInfo:{type:Object,default:{}},paypopb:{type:Boolean,default:!1},service:{type:String,default:""},action:{type:String,default:""},apply:{type:String,default:""},loginCheck:{type:Boolean,default:!0},extraData:{type:Object,default:{}}},data:()=>({globalData:K.globalData,imgstatic:`${K.globalData.masterDomain}/static/images/miniprograme/payPop/`,imgVersion:K.globalData.imgVersion,payMethods:[{id:0,pay_code:"balance",pay_icon:`${K.globalData.masterDomain}/static/images/miniprograme/payPop/balance.png`,pay_name:"余额"}],userInfo:{},activeIndex:0,formdata:"",timeout:"00:00:00",password:"",popb:!1,popConb:!1,closeb:!1,passwordb:!1,passwordConb:!1,ajaxb:!1,firstb:!0,paySuccessb:!1,platForm:K.globalData.platForm}),mounted(){},methods:{linkTo(e){e&&("web"==K.globalData.platForm?e.indexOf("http")>-1||window.appBoolean?location.href=e:t({url:e}):t({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e}))},async payMethodData(){const t=this;let e=await t.$ajax.post({url:K.encodeUrl("include/ajax.php?"),data:{action:"payment",service:"siteConfig"}});console.log(e.data.info),100==e.data.state?t.userInfo.userid?(t.payMethods=t.payMethods.concat(e.data.info),t.userInfo.money<t.payInfo.order_amount&&(t.activeIndex=1)):t.payMethods=e.data.info:t.$emit("payError",e.data.info)},selectMethod(t,e){const i=this;if("balance"==t.pay_code){if(i.userInfo.money<i.payInfo.order_amount)return!1}else if("huoniao_bonus"==t.pay_code&&i.userInfo.bonus<i.payInfo.order_amount)return!1;i.formdata=t,i.activeIndex=e},closeFn(t){const e=this;e.closeb=!1,e.popConb=!1,setTimeout((t=>{e.popb=!1}),300),e.$emit("paypopb",!1),e.$emit("giveUp",t),clearTimeout(Q),clearInterval(Z),e.ajaxb||e.paySuccessb||e.certificatePayFn(),e.$emit("failpayFn")},countdown(t){const e=this;let i;10==`${t}`.length&&(i=1e3*t),i=(i-+new Date)/1e3;let a=Math.floor(i%60),n=Math.floor(i%3600/60),o=Math.floor(i/3600);return(a>0||n>0||o>0)&&(o/10<1&&(o="0"+o),n/10<1&&(n="0"+n),a/10<1&&(a="0"+a),Q=setTimeout((i=>{e.timeout=e.countdown(t)}),1e3)),o+":"+n+":"+a},payFn(t){const e=this;"balance"==e.payMethods[t].pay_code?(e.passwordb=!0,setTimeout((t=>{e.passwordConb=!0}),0)):e.checkPasswordFn()},closeCodeFn(){const t=this;t.passwordConb=!1,setTimeout((e=>{t.passwordb=!1}),300)},inputCodeFn(t){const e=this;e.password+=t,6==e.password.length&&1==e.userInfo.paypwdCheck&&e.checkPasswordFn()},async setAndPayFn(){const t=this;let e={service:"member",action:"updateAccount",do:"paypwdAdd",pay1:t.password,pay2:t.password};100==(await t.$ajax.post({url:K.encodeUrl("include/ajax.php?"),data:e})).data.state&&(await K.memberInfo(t.userInfo.userid),t.checkPasswordFn()),t.$emit("payError",res.data.info)},certificatePayFn(){const t=this;let e=t.payInfo.ordernum.split(",").length>1?1:"";t.$ajax.post({url:K.encodeUrl(`include/ajax.php?service=member&action=tradePayResult&order=${t.payInfo.ordernum}&type=${e}`)}).then((e=>{100==e.data.state&&(t.paySuccessb=!0,e.data.phone?t.$emit("paySuccess",e.data):t.$emit("paySuccess",e.data.info),clearInterval(Z),K.memberInfo(t.userInfo.userid,(function(e){t.userInfo=e}))),t.ajaxb=!1}))},checkPasswordFn(){const i=this;let a=i.activeIndex,n=i.payMethods[a],o=!1,s={service:i.service,action:i.action,ordernum:i.payInfo.ordernum,paytype:n.pay_code,...i.extraData};if("alipay"==s.paytype||"wxpay"==s.paytype){let a="";for(let t in s)a+=`&${t}=${s[t]}`;if(a=a.slice(1),"web"==i.platForm)window.appBoolean?(o=!0,s.app=1,i.payRequest(s,o)):location.href=`${i.globalData.masterDomain}/include/ajax.php?${a}`;else if("mp-toutiao"==i.platForm){let e=encodeURIComponent(`${i.globalData.masterDomain}/include/ajax.php?${a}`);t({url:`/pages/redirect/index?url=${e}&title=${n.pay_name}`})}else e({title:"支付中",icon:"loading",mask:!0}),i.payRequest(s,o,(function(t){uni.requestPayment({timeStamp:t.data.info.timeStamp,nonceStr:t.data.info.nonceStr,package:t.data.info.package,signType:t.data.info.signType,paySign:decodeURIComponent(t.data.info.paySign),success:t=>{i.certificatePayFn()},fail:t=>{i.$emit("payError","支付失败")}})}))}else"balance"==n.pay_code?(s.useBalance=1,s.balance=i.payInfo.order_amount,s.paypwd=i.password,e({title:"支付中",icon:"loading",mask:!0}),i.payRequest(s,o)):(s.useBalance=0,e({title:"支付中",icon:"loading",mask:!0}),i.payRequest(s,o))},payRequest(t,e,a=function(){}){const n=this;let o=n.activeIndex,s=n.payMethods[o];n.$ajax.post({url:K.encodeUrl("include/ajax.php?"),data:t}).then((t=>{i(),100==t.data.state?(n.closeCodeFn(),n.closeFn(!1),e?window.setupWebViewJavascriptBridge((function(e){e.callHandler("wxpay"==s.pay_code?"wechatPay":"aliPay",{orderInfo:t.data.info},(function(t){}))})):"sponsor"!=n.apply&&n.$emit("payError","支付成功"),a(t)):n.$emit("payError",t.data.info||t.data),n.password=""}))}},watch:{paypopb(t,i){const o=this;if(["{}",'""',"null","undefined"].includes(JSON.stringify(o.payInfo)))return e({title:"订单信息丢失",icon:"error",duration:1500}),!1;if(t){let t=function(){o.popb=!0,setTimeout((()=>{o.popConb=!0})),Z=setInterval((t=>{o.ajaxb||(o.ajaxb=!0,o.certificatePayFn())}),1e3)},e=K.globalData.userid;if(o.loginCheck&&!e)return K.tologin(),!1;if(o.firstb?e?(a({title:"用户信息获取中..."}),K.memberInfo(e,(function(e){o.userInfo=e,o.$nextTick((e=>{t()})),n(),o.payMethodData()}))):(o.payMethodData(),o.$nextTick((e=>{t()}))):o.$nextTick((e=>{t()})),o.firstb=!1,o.payInfo.timeout>0){let t=parseInt((new Date).valueOf()/1e3)+1800;o.timeout=o.countdown(t)}}}}},[["render",function(t,e,i,a,n,x){const I=w,S=_,C=k;return n.popb?(o(),s(S,{key:0,class:"payComponents"},{default:r((()=>[l(S,{class:"payContent",style:c(`transform: translateY(${n.popConb?0:"100%"});`)},{default:r((()=>[l(I,{src:`${n.imgstatic}close.png?v=${n.imgVersion}`,mode:"aspectFill",class:"pc-close",onClick:e[0]||(e[0]=t=>n.closeb=!0)},null,8,["src"]),l(S,{style:{position:"relative"}},{default:r((()=>[l(S,{class:"payItemTitle"},{default:r((()=>[d(h(i.payInfo.subject)+"需支付",1)])),_:1}),l(S,{class:"moneyTitle"},{default:r((()=>[l(S,{class:"title"},{default:r((()=>[l(C,null,{default:r((()=>[d(h(n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"),1)])),_:1}),d(h(i.payInfo.order_amount),1)])),_:1}),i.payInfo.timeout>0?(o(),s(S,{key:0,class:"time"},{default:r((()=>[d("支付剩余时间："+h(n.timeout),1)])),_:1})):u("",!0)])),_:1}),l(S,{class:"payMethod"},{default:r((()=>[(o(!0),p(f,null,m(n.payMethods,((t,e)=>(o(),s(S,{class:"item",key:e,onClick:g((i=>x.selectMethod(t,e)),["stop"])},{default:r((()=>[l(S,{class:"methodName"},{default:r((()=>[l(I,{src:t.pay_icon,mode:"aspectFill"},null,8,["src"]),l(S,null,{default:r((()=>[l(C,null,{default:r((()=>[d(h(t.pay_name),1)])),_:2},1024),"balance"==t.pay_code?(o(),s(C,{key:0,style:c("opacity:"+(n.userInfo.money>=i.payInfo.order_amount?1:.6))},{default:r((()=>[d(h(n.userInfo.money>=i.payInfo.order_amount?`（可用：${n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"}${n.userInfo.money||0}）`:`（余额不足，可用余额${n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"}${n.userInfo.money||0}）`),1)])),_:1},8,["style"])):u("",!0),"huoniao_bonus"==t.pay_code?(o(),s(C,{key:1,style:c("opacity:"+(n.userInfo.bonus>=i.payInfo.order_amount?1:.6))},{default:r((()=>[d(h(n.userInfo.bonus>=i.payInfo.order_amount?`（可用：${n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"}${n.userInfo.bonus||0}）`:`（余额不足，可用余额${n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"}${n.userInfo.bonus||0}）`),1)])),_:1},8,["style"])):u("",!0)])),_:2},1024)])),_:2},1024),"balance"==t.pay_code&&n.userInfo.money<i.payInfo.order_amount||"huoniao_bonus"==t.pay_code&&n.userInfo.bonus<i.payInfo.order_amount?(o(),s(S,{key:0,class:"recharge",onClick:e=>x.linkTo(`${n.globalData.appConfig.cfg_user_index}/${"balance"==t.pay_code?"deposit":"recharge"}.html?paytype=deposit`)},{default:r((()=>[d(" 充值 ")])),_:2},1032,["onClick"])):(o(),s(S,{key:1,class:b("selectDot"+(n.activeIndex==e?" active":""))},null,8,["class"]))])),_:2},1032,["onClick"])))),128))])),_:1}),l(S,{class:"payNow"},{default:r((()=>[l(S,{onClick:e[1]||(e[1]=t=>x.payFn(n.activeIndex))},{default:r((()=>[d("立即付款")])),_:1})])),_:1})])),_:1})])),_:1},8,["style"]),y(l(S,{class:"closeWarn"},{default:r((()=>[l(S,{class:"cw-content"},{default:r((()=>[l(S,{class:"cwc-title"},{default:r((()=>[d("确定放弃本次付款？")])),_:1}),i.payInfo.timeout>0?(o(),s(S,{key:0,class:"cwc-time"},{default:r((()=>[d(" 您的订单在"+h(n.timeout)+"内未支付将被取消，请尽快完成支付 ",1)])),_:1})):u("",!0),l(S,{class:"cwc-btn"},{default:r((()=>[l(S,{class:"cancel",onClick:e[2]||(e[2]=t=>x.closeFn(!0))},{default:r((()=>[d("放弃")])),_:1}),l(S,{class:"continue",onClick:e[3]||(e[3]=t=>n.closeb=!1)},{default:r((()=>[d("继续支付")])),_:1})])),_:1})])),_:1})])),_:1},512),[[v,n.closeb]]),n.passwordb?(o(),s(S,{key:0,class:"passwordPop"},{default:r((()=>[l(S,{class:"codeAndkey"},{default:r((()=>[l(S,{class:"passwordInput",style:c(`transform: translateY(${n.passwordConb?0:"100%"});${1==n.userInfo.paypwdCheck?"min-height: 880rpx;":"min-height:1040rpx;"}`)},{default:r((()=>[l(I,{src:`${n.imgstatic}arr_back.png?v=${n.imgVersion}`,mode:"aspectFill",class:"cancelPay",onClick:x.closeCodeFn},null,8,["src","onClick"]),l(S,{class:"title"},{default:r((()=>[d("输入支付密码")])),_:1}),l(S,{class:"payInput"},{default:r((()=>[l(S,{class:"text"},{default:r((()=>[d("请"+h(1==n.userInfo.paypwdCheck?"输入":"设置")+"6位数字密码确认支付",1)])),_:1}),l(S,{class:"password"},{default:r((()=>[(o(),p(f,null,m(6,(t=>l(S,{key:t,class:b(t<=n.password.length?"active":"")},{default:r((()=>[l(C,null,{default:r((()=>[d("•")])),_:1})])),_:2},1032,["class"]))),64))])),_:1}),1!=n.userInfo.paypwdCheck?(o(),s(S,{key:0,class:"setCode"},{default:r((()=>[l(S,null,{default:r((()=>[d("·避免使用连续或重复数字，类似“123456”“112233”")])),_:1}),l(S,null,{default:r((()=>[d("·避免使用手机号、证件号中的连续数字")])),_:1})])),_:1})):u("",!0),1==n.userInfo.paypwdCheck?(o(),s(S,{key:1,class:"forgetCode",onClick:e[4]||(e[4]=t=>x.linkTo(`${n.globalData.appConfig.cfg_user_index}/security-paypwdEdit.html?step=2&title=修改支付密码`))},{default:r((()=>[d("忘记密码?")])),_:1})):u("",!0)])),_:1}),1!=n.userInfo.paypwdCheck?(o(),p("div",{key:0,class:"confirmPay",onClick:e[5]||(e[5]=(...t)=>x.setAndPayFn&&x.setAndPayFn(...t))},"确定并支付")):u("",!0)])),_:1},8,["style"]),l(S,{class:"keyboard",style:c(`transform: translateY(${n.passwordConb?0:"100%"});`)},{default:r((()=>[l(S,null,{default:r((()=>[l(C,{onClick:e[6]||(e[6]=t=>x.inputCodeFn(1))},{default:r((()=>[d("1")])),_:1}),l(C,{onClick:e[7]||(e[7]=t=>x.inputCodeFn(2))},{default:r((()=>[d("2")])),_:1}),l(C,{onClick:e[8]||(e[8]=t=>x.inputCodeFn(3))},{default:r((()=>[d("3")])),_:1}),l(C,{onClick:e[9]||(e[9]=t=>x.inputCodeFn(4))},{default:r((()=>[d("4")])),_:1}),l(C,{onClick:e[10]||(e[10]=t=>x.inputCodeFn(5))},{default:r((()=>[d("5")])),_:1}),l(C,{onClick:e[11]||(e[11]=t=>x.inputCodeFn(6))},{default:r((()=>[d("6")])),_:1}),l(C,{onClick:e[12]||(e[12]=t=>x.inputCodeFn(7))},{default:r((()=>[d("7")])),_:1}),l(C,{onClick:e[13]||(e[13]=t=>x.inputCodeFn(8))},{default:r((()=>[d("8")])),_:1}),l(C,{onClick:e[14]||(e[14]=t=>x.inputCodeFn(9))},{default:r((()=>[d("9")])),_:1}),l(C,{class:"none"}),l(C,{onClick:e[15]||(e[15]=t=>x.inputCodeFn(0))},{default:r((()=>[d("0")])),_:1}),l(C,{class:"backSpace",style:c(`background: url(${n.imgstatic}del_num.png) no-repeat 50%/60rpx;`),onClick:e[16]||(e[16]=t=>n.password=n.password.slice(0,-1))},null,8,["style"])])),_:1})])),_:1},8,["style"])])),_:1})])),_:1})):u("",!0)])),_:1})):u("",!0)}],["__scopeId","data-v-e72ebd96"]]),it={web:{development:{payreturn:"/pages/payreturn/index"},production:{payreturn:"/payreturn"}},mini:{payreturn:"/pages/payreturn/index"}};var at,nt=x();const ot=U({name:"sponsor",props:{service:{type:String,default:""},popb:{type:Boolean,default:!1},aid:{type:[Number,String],default:0},sponsorMoney:{type:Array,default:[6.6,8.8,68]},sponsorMax:{type:Number,default:2e3},successFn:{type:Function,default:t=>1}},data:()=>({globalData:nt.globalData,sponsorAmount:0,preAmount:0,appConfig:"",selfSponsorb:!1,sponsorFocusb:!1,sponsorSuccessb:!1,popconb:!1,imgVersion:nt.globalData.imgVersion,imgurl:nt.globalData.imgPath+"/article/",paypopb:!1,payInfo:{},pages:{},platForm:nt.globalData.platForm,paddTop:"0rpx"}),mounted(){at=this,nt.globalData.appConfig?at.appConfig=nt.globalData.appConfig:nt.watchG("appConfig",(function(t){at.appConfig=t})),"web"==at.platForm?at.paddTop="20rpx":"mp-toutiao"==at.platForm?at.paddTop="14rpx":at.paddTop="10rpx",at.pages=nt.pageFn(it)},methods:{linkTo(e){e&&("web"==this.platForm?e.indexOf("http")>-1||window.appBoolean?location.href=e:t({url:e}):t({url:e.indexOf("http")>-1?"/pages/redirect/index?url="+encodeURIComponent(e):e}))},sponsorFn(t){if("web"!=at.platForm&&!nt.loginCheck())return!1;t?(at.sponsorAmount=t,at.selfSponsorb=!1,at.sponsorFocusb=!1,at.submitSponsorFn()):(at.sponsorAmount=1,at.selfSponsorb=!0,at.sponsorFocusb=!0)},selfCheckFn(t){let e=t.detail.value;if(/^(\d*|\d*[.]|\d*[.]\d{1,2})$/.test(e)||""==e)if(e>at.sponsorMax){let t;t=setTimeout((e=>{clearTimeout(t),at.sponsorAmount=at.sponsorMax}),100),at.preAmount=at.sponsorMax}else at.preAmount=e;else{let t;t=setTimeout((e=>{clearTimeout(t),at.sponsorAmount=at.preAmount}),100)}},submitSponsorFn(){let t={service:at.service,action:"reward",aid:at.aid,amount:at.sponsorAmount};at.$ajax.post({url:nt.encodeUrl("include/ajax.php?"),data:t}).then((t=>{100==t.data.state?"web"==nt.globalData.platForm&&window.Android&&window.appBoolean?window.setupWebViewJavascriptBridge((function(e){e.callHandler("cashier",{service:at.service,module:at.service,type:"",orderinfo:t.data.info,ordertype:"action=pay"},(function(t){"ok"==t?e.callHandler("pageReload",{},(function(t){})):"end_countdown"==t&&alert("支付超时！")}))})):(at.payInfo=t.data.info,at.paypopb=!0):at.info=t.data.info}))},closeFn(){at.$emit("closeFn",!1)},paySuccess(t){if(2==at.successFn(at.payInfo))return e(),!1;function e(){at.closeFn(),at.sponsorAmount="",at.preAmount="",at.selfSponsorb=!1,at.sponsorFocusb=!1,at.sponsorSuccessb=!1,at.paypopb=!1}at.sponsorSuccessb=!0,setTimeout((t=>{e()}),3e3)},payError(t){e({title:t,icon:"none",success:t=>{setTimeout((t=>{i()}),3e3)}})}},watch:{popb(t,e){t?setTimeout((t=>{at.popconb=!0}),0):at.popconb=!1}}},[["render",function(t,e,i,a,n,g){const y=w,v=_,x=k,C=S,F=N(I("payBottom"),et);return o(),s(v,null,{default:r((()=>[i.popb?(o(),s(v,{key:0,class:"sponsorPop"},{default:r((()=>[l(v,{class:"sp-content",style:c(`transform:scale(${n.popconb?1:0})`)},{default:r((()=>[n.sponsorSuccessb?(o(),s(v,{key:1,class:"success"},{default:r((()=>[l(y,{src:`${n.imgurl}coin.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(v,{class:"right"},{default:r((()=>[l(v,{class:"tip"},{default:r((()=>[d("打赏成功！")])),_:1}),l(v,{class:"text"},{default:r((()=>[d("感谢您的支持~")])),_:1})])),_:1})])),_:1})):(o(),p(f,{key:0},[l(v,{class:"content"},{default:r((()=>[l(y,{src:`${n.imgurl}sponsor_bgi.png?v=${n.imgVersion}`,mode:"aspectFit",class:"bgi_1"},null,8,["src"]),l(y,{src:`${n.imgurl}sponsor.png?v=${n.imgVersion}`,mode:"aspectFit",class:"bgi_2"},null,8,["src"]),l(v,{class:"title"},{default:r((()=>[l(v,null,{default:r((()=>[d("打赏支持")])),_:1}),l(x,null,{default:r((()=>[d("喜欢就打赏支持一下"+h("tieba"==i.service?"":"小编")+"吧",1)])),_:1})])),_:1}),l(v,{class:"sponsor"},{default:r((()=>[l(v,{class:"text"},{default:r((()=>[l(x,{class:"left"},{default:r((()=>[d("打赏金额")])),_:1}),l(v,{class:"right"},{default:r((()=>[n.selfSponsorb?(o(),s(x,{key:0},{default:r((()=>[d(h(n.sponsorAmount<i.sponsorMax?"请输入你想打赏的金额，":`最多打赏${i.sponsorMax}${n.globalData.appConfig.currency?n.globalData.appConfig.currency.short:"元"}哦，`),1)])),_:1})):u("",!0),l(x,{class:"tip",onClick:e[0]||(e[0]=t=>g.linkTo(n.appConfig.protocol["打赏须知"]))},{default:r((()=>[d("打赏须知")])),_:1})])),_:1})])),_:1}),l(v,{class:"list"},{default:r((()=>[(o(!0),p(f,null,m(i.sponsorMoney.slice(0,3),((t,e)=>(o(),s(v,{class:b(["item",{active:t==n.sponsorAmount&&!n.selfSponsorb}]),key:e,onClick:e=>g.sponsorFn(t)},{default:r((()=>[l(v,{class:"txt"},{default:r((()=>[d("打赏")])),_:1}),l(v,{class:"money"},{default:r((()=>[l(x,null,{default:r((()=>[d(h(n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"),1)])),_:1}),d(h(t),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128)),n.selfSponsorb?(o(),s(v,{key:1,class:"item active"},{default:r((()=>[l(v,{class:"money",style:{display:"flex"}},{default:r((()=>[l(x,{style:c(`padding-top:${n.paddTop};`)},{default:r((()=>[d(h(n.globalData.appConfig.currency?n.globalData.appConfig.currency.symbol:"￥"),1)])),_:1},8,["style"]),l(C,{type:"digit",style:{"font-size":"44rpx"},modelValue:n.sponsorAmount,"onUpdate:modelValue":e[2]||(e[2]=t=>n.sponsorAmount=t),onInput:g.selfCheckFn,focus:n.sponsorFocusb,onConfirm:g.submitSponsorFn},null,8,["modelValue","onInput","focus","onConfirm"])])),_:1})])),_:1})):(o(),s(v,{key:0,class:"item",onClick:e[1]||(e[1]=t=>g.sponsorFn())},{default:r((()=>[l(v,{class:"txt"},{default:r((()=>[d("打赏")])),_:1}),l(v,{class:"money"},{default:r((()=>[l(x,null,{default:r((()=>[d("其他金额")])),_:1})])),_:1})])),_:1}))])),_:1})])),_:1})])),_:1}),l(v,{class:"close",onClick:g.closeFn},{default:r((()=>[l(y,{src:`${n.imgurl}sponsor_close.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"])],64))])),_:1},8,["style"])])),_:1})):u("",!0),l(F,{service:i.service,action:"pay",payInfo:n.payInfo,paypopb:n.paypopb,loginCheck:!1,apply:"sponsor",onPaypopb:e[3]||(e[3]=t=>n.paypopb=!1),onPayError:g.payError,onPaySuccess:g.paySuccess},null,8,["service","payInfo","paypopb","onPayError","onPaySuccess"])])),_:1})}],["__scopeId","data-v-b4872716"]]);var st,rt,lt=x();const ct=U({name:"complain",props:{showPop:{type:Boolean,default:!1},complainList:{type:Array,default:["理由1","理由2"]},infoDetail:{type:Object,default:{service:"member",template:"complain",module:"article",dopost:"detail",aid:-1}}},components:{popWarn:q},data:()=>({imgPath:lt.globalData.imgStaticPath,imgVersion:lt.globalData.imgVersion,phoneArea:[],activeIndex:0,phone:"",description:"",areaCode:86,complainb:!1,complainConb:!1,phoneb:!1,phoneConb:!1,warningb:!1,info:"",ajaxb:!1}),mounted(){st=this},methods:{warnFn(t=2e3){st.warningb=!0,clearTimeout(rt),rt=setTimeout((t=>{st.warningb=!1}),t)},popFn(t){t?(st.complainb=!0,setTimeout((t=>{st.complainConb=!0}),0)):(st.complainConb=!1,setTimeout((t=>{st.complainb=!1}),220),st.$emit("hideFn",!1))},secPopFn(t){t?(st.phoneb=!0,setTimeout((t=>{st.phoneConb=!0}),0)):(st.phoneConb=!1,setTimeout((t=>{st.phoneb=!1}),220))},phoneAreaData(){if(0==st.phoneArea.length){let t={service:"siteConfig",action:"internationalPhoneSection"};st.$ajax.post({url:"include/ajax.php?",data:t}).then((t=>{100==t.data.state&&(st.phoneArea=t.data.info)}))}},submitFn(){let t=st.infoDetail;if(t.areaCode=st.areaCode,t.type=st.complainList[st.activeIndex],t.desc=st.description,t.phone=st.phone,"86"==st.areaCode){/^[1-9]\d{10}$/.test(st.phone)?st.ajaxb||(st.ajaxb=!0,st.$ajax.post({url:lt.encodeUrl("include/ajax.php?"),data:t}).then((t=>{100==t.data.state&&setTimeout((t=>{st.popFn(0)}),2200),st.info=t.data.info,st.ajaxb=!1}))):st.info="请检查手机号格式"}else""==st.phone?st.info="手机号不能为空":st.ajaxb||(st.ajaxb=!0,st.$ajax.post({url:lt.encodeUrl("include/ajax.php?"),data:t}).then((t=>{100==t.data.state&&setTimeout((t=>{st.popFn(0)}),2200),st.info=t.data.info,st.ajaxb=!1})))}},watch:{info(t,e){""!=t&&(st.warnFn(),setTimeout((t=>{st.info=""}),2200))},showPop(t,e){t&&st.popFn(1)}}},[["render",function(t,e,i,a,n,y){const v=k,x=w,F=_,$=S,P=C,z=N(I("popWarn"),q);return n.complainb?(o(),s(F,{key:0,class:"complain",onClick:e[9]||(e[9]=t=>y.popFn(0))},{default:r((()=>[l(F,{class:"c-content",style:c(`transform:translateY(${n.complainConb?"0%":"100%"})`),onClick:e[4]||(e[4]=g((()=>{}),["stop"]))},{default:r((()=>[l(F,{class:"cc-title"},{default:r((()=>[l(v,null,{default:r((()=>[d("举报内容")])),_:1}),l(x,{src:`${n.imgPath}/close_2.png?v=${n.imgVersion}`,mode:"aspectFit",onClick:e[0]||(e[0]=t=>y.popFn(0))},null,8,["src"])])),_:1}),l(F,{class:"cc-list"},{default:r((()=>[l(F,{class:"title"},{default:r((()=>[d("选择举报理由")])),_:1}),l(F,{class:"list"},{default:r((()=>[(o(!0),p(f,null,m(i.complainList,((t,e)=>(o(),s(F,{class:b(["item",{active:n.activeIndex==e}]),key:e,onClick:t=>n.activeIndex=e},{default:r((()=>[d(h(t),1)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),l(F,{class:"cc-phone"},{default:r((()=>[l(F,{class:"title"},{default:r((()=>[d("联系方式")])),_:1}),l(F,{class:"phone"},{default:r((()=>[l(F,{class:"select",onClick:e[1]||(e[1]=t=>y.secPopFn(1))},{default:r((()=>[l(v,null,{default:r((()=>[d("+"+h(n.areaCode),1)])),_:1}),l(x,{src:`${n.imgPath}/d_arr.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1}),l($,{type:"tel",placeholder:"输入手机号","placeholder-style":"opacity:.3;font-wei:500",modelValue:n.phone,"onUpdate:modelValue":e[2]||(e[2]=t=>n.phone=t)},null,8,["modelValue"])])),_:1})])),_:1}),l(F,{class:"cc-description"},{default:r((()=>[l(F,{class:"title"},{default:r((()=>[d("举报描述")])),_:1}),l(F,{class:"input"},{default:r((()=>[l(P,{placeholder:"可简述理由，以便快速处理举报","placeholder-style":"opacity:.3",maxlength:"100","auto-height":"",modelValue:n.description,"onUpdate:modelValue":e[3]||(e[3]=t=>n.description=t)},null,8,["modelValue"]),l(F,{class:"number"},{default:r((()=>[d(h(n.description.length)+"/100",1)])),_:1})])),_:1})])),_:1}),l(F,{class:"cc-btn",style:c("background:"+(n.phone?"linear-gradient(-90deg, #F6252F 0%, #FF4621 100%);":"#FFBABA")),onClick:y.submitFn},{default:r((()=>[d("提交")])),_:1},8,["style","onClick"])])),_:1},8,["style"]),n.phoneb?(o(),s(F,{key:0,class:"c-pop",onClick:e[7]||(e[7]=g((t=>y.secPopFn(0)),["stop"]))},{default:r((()=>[l(F,{class:"cp-content",style:c(`transform:translateY(${n.phoneConb?"0%":"100%"})`),onClick:e[6]||(e[6]=g((()=>{}),["stop"]))},{default:r((()=>[l(F,{class:"title"},{default:r((()=>[l(F,{class:"back",onClick:e[5]||(e[5]=t=>y.secPopFn(0))},{default:r((()=>[d("返回")])),_:1}),l(v,null,{default:r((()=>[d("选择地区")])),_:1})])),_:1}),l(F,{class:"list"},{default:r((()=>[(o(!0),p(f,null,m(n.phoneArea,((t,e)=>(o(),s(F,{class:"item",key:e,onClick:e=>{n.areaCode=t.code,y.secPopFn(0)}},{default:r((()=>[l(F,{class:"area"},{default:r((()=>[d(h(t.name),1)])),_:2},1024),l(F,{class:"num"},{default:r((()=>[d("+"+h(t.code),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1},8,["style"])])),_:1})):u("",!0),l(z,{info:n.info,warningb:n.warningb,onClick:e[8]||(e[8]=g((()=>{}),["stop"]))},null,8,["info","warningb"])])),_:1})):u("",!0)}],["__scopeId","data-v-ff8601ed"]]),dt=(t="")=>t.split(";").filter((t=>t&&!/^[\n\s]+$/.test(t))).map((t=>{const e=t.slice(0,t.indexOf(":")),i=t.slice(t.indexOf(":")+1);return{[e.replace(/-([a-z])/g,(function(){return arguments[1].toUpperCase()})).replace(/\s+/g,"")]:i.replace(/^\s+/,"").replace(/\s+$/,"")||""}}));function ht(t){return{provide(){return{[t]:this}},data:()=>({el:{id:null,css:{},views:[]}}),watch:{css:{handler(t){this.canvasId&&(this.el.css=("object"==typeof t?t:t&&Object.assign(...dt(t)))||{},this.canvasWidth=this.el.css&&this.el.css.width||this.canvasWidth,this.canvasHeight=this.el.css&&this.el.css.height||this.canvasHeight)},immediate:!0}}}}function ut(t,e={}){return e.indexKey,{inject:{[t]:{default:null}},watch:{el:{handler(t,e){JSON.stringify(t)!=JSON.stringify(e)&&this.bindRelation()},deep:!0,immediate:!0},src:{handler(t,e){t!=e&&this.bindRelation()},immediate:!0},text:{handler(t,e){t!=e&&this.bindRelation()},immediate:!0},css:{handler(t,e){t!=e&&(this.el.css=("object"==typeof t?t:t&&Object.assign(...dt(t)))||{})},immediate:!0},replace:{handler(t,e){JSON.stringify(t)!=JSON.stringify(e)&&this.bindRelation()},deep:!0,immediate:!0}},created(){this._uid||(this._uid=this._.uid),Object.defineProperty(this,"parent",{get:()=>this[t]||[]}),Object.defineProperty(this,"index",{get:()=>{this.bindRelation();const{parent:{el:{views:t=[]}={}}={}}=this;return t.indexOf(this.el)}}),this.el.type=this.type,this.uid&&(this.el.uid=this.uid),this.bindRelation()},beforeUnmount(){this.removeEl()},methods:{removeEl(){this.parent&&(this.parent.el.views=this.parent.el.views.filter((t=>t._uid!==this._uid)))},bindRelation(){if(this.el._uid||(this.el._uid=this._uid),["text","qrcode"].includes(this.type)&&(this.el.text=this.$slots&&this.$slots.default&&this.$slots.default[0].text||`${this.text||""}`.replace(/\\n/g,"\n")),"image"==this.type&&(this.el.src=this.src),!this.parent)return;let t=this.parent.el.views||[];-1!==t.indexOf(this.el)?this.parent.el.views=t.map((t=>t._uid==this._uid?this.el:t)):this.parent.el.views=[...t,this.el]}},mounted(){}}}const pt=U({name:"lime-painter-image",mixins:[ut("painter")],props:{id:String,css:[String,Object],src:String},data:()=>({type:"image",el:{css:{},src:null}})},[["render",function(t,e,i,a,n,o){return null}]]);const ft=U({name:"lime-painter-text",mixins:[ut("painter")],props:{uid:String,css:[String,Object],text:[String,Number],replace:Object},data:()=>({type:"text",el:{css:{},text:null}})},[["render",function(t,e,i,a,n,l){const c=k;return o(),s(c,{style:{opacity:"0",height:"0"}},{default:r((()=>[F(t.$slots,"default")])),_:3})}]]);const mt=U({name:"lime-painter-view",mixins:[ut("painter"),ht("painter")],props:{id:String,css:[String,Object]},data:()=>({type:"view",el:{css:{},views:[]}}),mounted(){}},[["render",function(t,e,i,a,n,l){const c=_;return o(),s(c,null,{default:r((()=>[F(t.$slots,"default")])),_:3})}]]);const gt=U({name:"lime-painter-qrcode",mixins:[ut("painter")],props:{id:String,css:[String,Object],text:String},data:()=>({type:"qrcode",el:{css:{},text:null}})},[["render",function(t,e,i,a,n,o){return null}]]),bt={props:{board:Object,pathType:String,fileType:{type:String,default:"png"},hidden:Boolean,quality:{type:Number,default:1},css:[String,Object],width:[Number,String],height:[Number,String],pixelRatio:Number,customStyle:String,isCanvasToTempFilePath:Boolean,sleep:{type:Number,default:1e3/30},beforeDelay:{type:Number,default:100},afterDelay:{type:Number,default:100},performance:Boolean,useCORS:Boolean,hidpi:{type:Boolean,default:!0}}},yt=t=>/^data:image\/(\w+);base64/.test(t);function vt(t){return new Promise((e=>setTimeout(e,t)))}let{platform:xt,SDKVersion:wt}=$();const _t=/windows|mac/.test(xt);let kt={};function It(t,e,i=!1){if("number"==typeof t)return t;if(function(t){return/^-?\d+(\.\d+)?$/.test(t)}(t))return 1*t;if("string"==typeof t){const a=/^-?([0-9]+)?([.]{1}[0-9]+){0,1}(em|rpx|px|%)$/g.exec(t);if(!t||!a)return 0;const n=a[3];t=parseFloat(t);let o=0;return"rpx"===n?o=P(t):"px"===n?o=1*t:"%"===n?o=t*It(e)/100:"em"===n&&(o=t*It(e||14)),i?1*o.toFixed(2):Math.round(o)}return 0}function St(t){return/^data:/.test(t)?t:new Promise(((e,i)=>{let a=new Image;a.setAttribute("crossOrigin","Anonymous"),a.onload=function(){let t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight,t.getContext("2d").drawImage(a,0,0);let i=t.toDataURL("image/png");e(i),t.height=t.width=0},a.src=t+"?v="+Math.random(),a.onerror=t=>{i(t)}}))}function Ct(t,e){const i=this&&this.canvas&&this.canvas.createImage;return new Promise((async(a,n)=>{let o=t.replace(/^@\//,"/");if(kt[t]&&kt[t].errMsg)a(kt[t]);else{try{e&&(o=await St(t))}catch(s){n({...s,src:o})}if(i&&!_t){const e=this.canvas.createImage();return e.onload=function(){const i={path:e,width:e.width,height:e.height};kt[t]=i,a(kt[t])},e.onerror=function(e){n({err:e,path:t})},void(e.src=o)}z({src:o,success:e=>{if(i){const i=this.canvas.createImage();return i.onload=function(){e.path=i,kt[t]=e,a(kt[t])},i.onerror=function(e){n({err:e,path:t})},void(i.src=o)}kt[t]=e,a(kt[t])},fail(e){console.error({err:e,path:t}),n({err:e,path:t})}})}}))}var Ft=function(){return(Ft=Object.assign||function(t){for(var e,i=1,a=arguments.length;i<a;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function $t(t,e,i,a){return new(i||(i=Promise))((function(n,o){function s(t){try{l(a.next(t))}catch(e){o(e)}}function r(t){try{l(a.throw(t))}catch(e){o(e)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,r)}l((a=a.apply(t,e||[])).next())}))}function Pt(t,e){var i,a,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function r(o){return function(r){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(r){o=[6,r],a=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,r])}}}var zt={MP_WEIXIN:"mp-weixin",MP_QQ:"mp-qq",MP_ALIPAY:"mp-alipay",MP_BAIDU:"mp-baidu",MP_TOUTIAO:"mp-toutiao",MP_DINGDING:"mp-dingding",H5:"h5",WEB:"web",PLUS:"plus"},Dt="width",Tt=["Top","Right","Bottom","Left"],Mt="right",Bt="bottom",Wt=["contentSize","clientSize","borderSize","offsetSize"],Ot={TOP:"top",MIDDLE:"middle",BOTTOM:Bt},jt={LEFT:"left",CENTER:"center",RIGHT:Mt},Lt="view",At="text",Rt="image",Et="qrcode",Vt="block",Ht="absolute",Ut="fixed",Nt={display:Vt,color:"#000000",lineHeight:"1.4em",fontSize:14,fontWeight:400,fontFamily:"sans-serif",lineCap:"butt",flexDirection:"row",flexWrap:"nowrap",textAlign:"left",alignItems:"flex-start",justifyContent:"flex-start",position:"static",transformOrigin:"center center"},qt={upx2px:function(t){return window.innerWidth/750*t},getSystemInfoSync:function(){return{screenWidth:window.innerWidth,screenHeight:window.innerHeight}},getImageInfo:function(t){var e=t.src,i=t.success,a=t.fail,n=new Image;n.onload=function(){i({width:n.naturalWidth,height:n.naturalHeight,path:n.src,src:e})},n.onerror=a,n.src=e}},Yt="object"==typeof window?"undefined"==typeof uni||"undefined"!=typeof uni&&!T?zt.WEB:zt.H5:"object"==typeof swan?zt.MP_BAIDU:"object"==typeof tt?zt.MP_TOUTIAO:"object"==typeof plus?zt.PLUS:"object"==typeof wx?zt.MP_WEIXIN:void 0,Jt=Yt==zt.MP_WEIXIN?wx:"undefined"!=typeof uni?z?{upx2px:function(t){return P(t)},getSystemInfoSync:function(){return $()},getImageInfo:function(t){return z(t)},downloadFile:function(t){return D(t)}}:Object.assign(uni,qt):"undefined"!=typeof window?qt:uni;if(!Jt.upx2px){var Gt=((Jt.getSystemInfoSync&&Jt.getSystemInfoSync()).screenWidth||375)/750;Jt.upx2px=function(t){return Gt*t}}function Xt(t){return/^-?\d+(\.\d+)?$/.test(t)}function Qt(t,e,i){if(Xt(t))return 1*t;if("string"==typeof t){var a=/^-?([0-9]+)?([.]{1}[0-9]+){0,1}(em|rpx|vw|vh|px|%)$/g.exec(t);if(!t||!a)return 0;var n=a[3];t=parseFloat(t);var o=0;if("rpx"===n)o=Jt.upx2px(t);else if("px"===n)o=1*t;else if("%"===n&&e)o=t*Qt(e)/100;else if("em"===n&&e)o=t*Qt(e||14);else if(["vw","vh"].includes(n)){var s=Jt.getSystemInfoSync(),r=s.screenWidth,l=s.screenHeight;o=t*("vw"==n?r:l)/100}return 1*o.toFixed(2)}return 0}function Zt(t){return/%$/.test(t)}function Kt(t){for(var e=[],i=[],a=0,n=t.substring(0,t.length-1).split("%,");a<n.length;a++){var o=n[a];e.push(o.substring(0,o.lastIndexOf(" ")).trim()),i.push(o.substring(o.lastIndexOf(" "),o.length)/100)}return{colors:e,percents:i}}function te(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ee(){return(ee=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])}return t}).apply(this,arguments)}function ie(t,e){return(ie=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ae(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function ne(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return ae(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ae(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var a=0;return function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oe(t){return"number"==typeof t}function se(t){return"auto"===t||null===t}function re(t){return/%$/.test(t)}var le=Rt,ce=At,de=Et,he=Ht,ue=Ut;function pe(t){return t.replace(/-([a-z])/g,(function(t,e){return e.toUpperCase()}))}function fe(t){t=t.trim();for(var e=new Array,i="+",a="",n=t.length,o=0;o<n;++o){if("."===t[o]||!isNaN(Number(t[o]))&&" "!==t[o])a+=t[o];else if("("===t[o]){for(var s=1,r=o;s>0;)"("===t[r+=1]&&(s+=1),")"===t[r]&&(s-=1);a=""+fe(t.slice(o+1,r)),o=r}if(isNaN(Number(t[o]))&&"."!==t[o]||o===n-1){var l=parseFloat(a);switch(i){case"+":e.push(l);break;case"-":e.push(-l);break;case"*":e.push(e.pop()*l);break;case"/":e.push(e.pop()/l)}i=t[o],a=""}}for(var c=0;e.length;)c+=e.pop();return c}var me,ge=0,be=function(){function t(){te(this,"elements",[]),te(this,"afterElements",[]),te(this,"beforeElements",[]),te(this,"ids",[]),te(this,"width",0),te(this,"height",0),te(this,"top",0),te(this,"left",0),te(this,"pre",null),te(this,"offsetX",0),te(this,"offsetY",0),ge++,this.id=ge}var e=t.prototype;return e.fixedBind=function(t,e){void 0===e&&(e=0),this.container=e?t.parent:t.root,this.container.fixedLine=this,this.fixedAdd(t)},e.fixedAdd=function(t){if(!this.ids.includes(t.id)){this.ids.push(t.id),this.elements.push(t);var e=t.computedStyle.zIndex;(void 0===e?0:e)>=0?this.afterElements.push(t):this.beforeElements.push(t),this.refreshLayout()}},e.bind=function(t){this.container=t.parent,this.container.line=null,this.container.lines?(this.container.lines.push(this),this.pre=this.getPreLine(),this.top=this.pre.top+this.pre.height,this.left=this.container.contentSize.left):(this.top=this.container.contentSize.top,this.left=this.container.contentSize.left,this.container.lines=[this]),this.isInline=t.isInline(),this.container.line=this,this.outerWidth=t.parent&&t.parent.contentSize.width?t.parent.contentSize.width:1/0,this.add(t)},e.getPreLine=function(){return this.container.lines[this.container.lines.length-2]},e.canIEnter=function(t){return!((100*t.offsetSize.width+100*this.width)/100>this.outerWidth&&(this.closeLine(),1))},e.closeLine=function(){delete this.container.line},e.add=function(t){this.ids.includes(t.id)||(this.ids.push(t.id),this.elements.push(t),this.refreshWidthHeight(t))},e.refreshWidthHeight=function(t){t.offsetSize.height>this.height&&(this.height=t.offsetSize.height),this.width+=t.offsetSize.width||0,(this.container.lineMaxWidth||0)<this.width&&(this.container.lineMaxWidth=this.width)},e.refreshXAlign=function(){if(this.isInline){var t=this.container.contentSize.width-this.width,e=this.container.style.textAlign;"center"===e?t/=2:"left"===e&&(t=0),this.offsetX=t}},e.getOffsetY=function(t){if(!t||!t.style)return 0;var e=(t.style||{}).verticalAlign;return e===Bt?this.height-t.contentSize.height:"middle"===e?(this.height-t.contentSize.height)/2:0},e.setIndent=function(t){var e=t.style.textIndent;if(e&&/^calc/.test(e)){var i=/^calc\((.+)\)$/.exec(e);if(i&&i[1]){var a=fe(i[1].replace(/([^\s\(\+\-\*\/]+)\.(left|right|bottom|top|width|height)/g,(function(e){var i=e.split("."),a=i[0],n=i[1],o=t.parent.querySelector(a);if(o&&o.offsetSize){var s={right:o.offsetSize.left+o.offsetSize.width,bottom:o.offsetSize.top+o.offsetSize.height};return o.offsetSize[n]||s[n]||0}})).replace(new RegExp(/-?[0-9]+(\.[0-9]+)?(rpx|px|%)/,"g"),Qt));t.style.textIndent=a}}},e.layout=function(t,e){var i=this;this.refreshXAlign(),this.pre?(this.top=this.pre.top+this.pre.height+this.offsetY,this.left=e+this.offsetX):(this.top=Math.max(this.top,this.container.contentSize.top,t)+this.offsetY,this.left=Math.max(this.left,this.container.contentSize.left,e)+this.offsetX),this.elements.forEach((function(t,e){i.setIndent(t);var a=i.elements[e-1],n=i.getOffsetY(t);t.style.top=i.top+n,t.style.left=a?a.offsetSize.left+a.offsetSize.width:i.left,t.getBoxPosition()}))},e.refreshLayout=function(){this.afterElements=this.afterElements.sort((function(t,e){return t.computedStyle.zIndex-e.computedStyle.zIndex})),this.beforeElements=this.beforeElements.sort((function(t,e){return t.computedStyle.zIndex-e.computedStyle.zIndex}))},t}(),ye=((me={}).row={width:Dt,contentWidth:Dt,lineMaxWidth:"lineMaxWidth",left:"left",top:"top",height:"height",lineMaxHeight:"lineMaxHeight",marginLeft:"marginLeft"},me.column={width:"height",contentWidth:"height",lineMaxWidth:"lineMaxWidth",left:"top",top:"left",height:Dt,lineMaxHeight:"lineMaxHeight",marginLeft:"marginTop"},me),ve=function(t){var e,i;function a(){var e;return te(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(e=t.call(this)||this),"outerWidth",0),e.exactValue=0,e.flexTotal=0,e.width=0,e.key=null,e.flexDirection="row",e}i=t,(e=a).prototype=Object.create(i.prototype),e.prototype.constructor=e,ie(e,i);var n=a.prototype;return n.bind=function(t){this.container=t.parent,this.container.line=this,this.container.lines?(this.container.lines.push(this),this.pre=this.getPreLine(),this.top=this.pre.top+this.pre.height,this.left=this.container.contentSize.left):(this.top=this.container.contentSize.top,this.left=this.container.contentSize.left,this.container.lines=[this]),t.parent&&(this.flexDirection=t.parent.style.flexDirection,this.key=ye[this.flexDirection]),this.initHeight(t),this.outerWidth=t.parent&&t.parent.contentSize[this.key.contentWidth]?t.parent.contentSize[this.key.contentWidth]:1/0,this.add(t)},n.add=function(t){this.ids.push(t.id);var e=t.style.flex;oe(e)?this.flexTotal+=e:oe(this.getWidth(t.style))&&(this.exactValue+=this.getWidth(t.offsetSize)),this.elements.push(t),this.refreshWidthHeight(t),t.next||this.closeLine()},n.closeLine=function(){this.calcFlex()},n.initHeight=function(t){this[this.key.height]=0},n.getWidth=function(t){return t[this.key.width]||0},n.getHeight=function(t){return t[this.key.height]||0},n.setWidth=function(t,e){t[this.key.width]=e},n.setHeight=function(t,e){t[this.key.height]=e},n.calcFlex=function(){var t=this,e=this.container.contentSize[this.key.contentWidth],i=0;this.elements.forEach((function(a){var n=a.style,o=a.contentSize,s=t.getWidth(n)||t.getWidth(o);oe(n.flex)&&(s=n.flex/t.flexTotal*(e-t.exactValue)),t.setWidth(a.computedStyle,s),a.isFlexCalc=!0,delete a.line,delete a.lines,delete a.lineMaxWidth,a.getBoxWidthHeight(),i=Math.max(i,t.getHeight(a.offsetSize))})),this.setHeight(this,i)},n.refreshWidthHeight=function(t){var e=this.container.style.alignItems;e&&!t.style.alignSelf&&(t.style.alignSelf=e);var i=this.getHeight(t.offsetSize);i>this[this.key.height]&&(this.container[this.key.lineMaxHeight]=this[this.key.height]=i),this[this.key.width]+=this.getWidth(t.offsetSize);var a=Math.min(this.getWidth(this),!this.getWidth(this.container.contentSize)&&1/0);(this.container[this.key.lineMaxWidth]||0)<a&&(this.container[this.key.lineMaxWidth]=a)},n.refreshXAlign=function(){var t,e,i=this,a=this.elements.reduce((function(t,e){return t+i.getWidth(e.offsetSize)}),0),n=(this.outerWidth==1/0?0:this.outerWidth-a)||0,o=this.container.style.justifyContent;"center"===o?n/=2:"flex-start"===o?n=0:["space-between","space-around"].includes(o)&&(t="space-between"==o,void 0===(e=n)&&(e=0),e/=i.elements.length+(t?-1:1),i.elements.forEach((function(a,n){var o;t&&!n||(a.style.margin?a.style.margin[i.key.marginLeft]+=e:a.style.margin=((o={})[i.key.marginLeft]=e,o),a.getBoxPosition())})),e=0,n=0),this.offsetX=n||0,this.refreshYAlign()},n.refreshYAlign=function(){var t=this;if(1==this.container.lines.length)return 0;var e=this.container.lines.reduce((function(e,i){return e+t.getHeight(i)}),0),i=this.container.style.alignItems,a=this.getHeight(this.container.contentSize);if("center"===i){var n=(a-e)/(this.container.lines.length+1);this.container.lines.forEach((function(t){t.offsetY=n}))}if("flex-end"===i){var o=a-e;this.container.lines[0].offsetY=o}},n.getOffsetY=function(t){if(this.container.lines.length>1)return 0;var e=t.style.alignSelf,i=this.getHeight(this.container.contentSize),a=i-this.getHeight(t.offsetSize);return"flex-end"===e?a:"center"===e?a/2:"stretch"===e?(a&&t.name==Lt&&(t.style[this.key.width]=this.getWidth(t.offsetSize),t.style[this.key.height]=i,delete t.line,delete t.lines,t.getBoxWidthHeight()),0):0},n.layout=function(t,e){var i=this;this.refreshXAlign(),this.pre?(this.top=this.pre.top+this.pre.height+this.offsetY,this.left=e+this.offsetX):(this.top=Math.max(this.top,this.container.contentSize.top,t)+this.offsetY,this.left=Math.max(this.left,this.container.contentSize.left,e)+this.offsetX),this.elements.forEach((function(t,e){i.setIndent(t);var a=i.elements[e-1],n=i.getOffsetY(t);t.style[i.key.top]=i[i.key.top]+n,t.style[i.key.left]=a?a.offsetSize[i.key.left]+i.getWidth(a.offsetSize):i[i.key.left],t.getBoxPosition()}))},a}(be),xe=At,we=Lt,_e=Ht,ke=0,Ie={left:null,top:null,width:null,height:null},Se=new Map,Ce=function(){function t(t,e,i,a){var n=this;te(this,"id",ke++),te(this,"style",{left:null,top:null,width:null,height:null}),te(this,"computedStyle",{}),te(this,"originStyle",{}),te(this,"children",{}),te(this,"layoutBox",ee({},Ie)),te(this,"contentSize",ee({},Ie)),te(this,"clientSize",ee({},Ie)),te(this,"borderSize",ee({},Ie)),te(this,"offsetSize",ee({},Ie)),this.ctx=a,this.root=i,e&&(this.parent=e),this.name=t.type||t.name,this.attributes=this.getAttributes(t);var o=function(t,e){var i,a=["color","fontSize","lineHeight","verticalAlign","fontWeight","textAlign"],n=t.type,o=void 0===n?"view":n,s=t.styles,r=void 0===s?{}:s,l=(e||{}).computedStyle,c=Object.assign({},Nt);if([ce,le,de].includes(o)&&!r.display&&(c.display="inline-block"),l)for(var d=0;d<a.length;d++){var h=a[d];(r[h]||l[h])&&(r[h]=r[(i=h,i.replace(/([A-Z])/g,"-$1").toLowerCase())]||r[h]||l[h])}for(var u=function(t){var e,i,a,n,s=r[t];if(/-/.test(t)&&(t=pe(t),c[t]=s),/^(box|text)?shadow$/i.test(t)){var l=[];return s.replace(/((-?\d+(rpx|px|vw|vh)?\s+?){3})(.+)/,(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];l=t[1].match(/-?\d+(rpx|px|vw|vh)?/g).map((function(t){return Qt(t)})).concat(t[4])})),/^text/.test(t)?c.textShadow=l:c.boxShadow=l,"continue"}if(/^border/i.test(t)&&!/radius$/i.test(t)){var d=t.match(/^border([BTRLa-z]+)?/)[0],h=t.match(/[W|S|C][a-z]+/),u=s.replace(/([\(,])\s+|\s+([\),])/g,"$1$2").split(" ").map((function(t){return/^\d/.test(t)?Qt(t,""):t}));return c[d]||(c[d]={}),1==u.length&&h?c[d][d+h[0]]=u[0]:c[d]=((e={})[d+Dt]=Xt(u[0])?u[0]:0,e[d+"Style"]=u[1]||"solid",e[d+"Color"]=u[2]||"black",e),"continue"}if(/^background(color)?$/i.test(t))return c.backgroundColor=s,"continue";if(/^objectPosition$/i.test(t))return c[t]=s.split(" "),"continue";if(/padding|margin|radius/i.test(t)){var p=/radius$/i.test(t),f="borderRadius",m=p?f:t.match(/[a-z]+/)[0],g=function(t,e){return"border"+t+e+"Radius"},b=[0,0,0,0].map((function(t,e){return p?[g(Tt[0],Tt[3]),g(Tt[0],Tt[1]),g(Tt[2],Tt[1]),g(Tt[2],Tt[3])][e]:m+Tt[e]}));if("padding"===t||"margin"===t||/^(border)?radius$/i.test(t)){u=(""+s).split(" ").map((function(e){return/^-?\d+(rpx|px|vh|vw)?$/.test(e)?Qt(e):"margin"!=t&&/auto/.test(e)?0:e}),[])||[0];var y=p?f:t,v=u[0],x=u[1],w=u[2],_=u[3];c[y]=((i={})[b[0]]=se(v)?0:v,i[b[1]]=Xt(x)||se(x)?x:v,i[b[2]]=se(Xt(w)?w:v)?0:Xt(w)?w:v,i[b[3]]=Xt(_)?_:x||v,i)}else"object"==typeof c[m]||(c[m]=((a={})[b[0]]=c[m]||0,a[b[1]]=c[m]||0,a[b[2]]=c[m]||0,a[b[3]]=c[m]||0,a)),c[m][t]="margin"==m&&se(s)||re(s)?s:Qt(s);return"continue"}if(/^transform$/i.test(t))return c[t]={},s.replace(/([a-zA-Z]+)\(([0-9,-\.%rpxdeg\s]+)\)/g,(function(e,i,a){var n=a.split(",").map((function(t){return t.replace(/(^\s*)|(\s*$)/g,"")})),o=function(t,e){return t.includes("deg")?1*t:e&&!re(e)?Qt(t,e):t};i.includes("matrix")?c[t][i]=n.map((function(t){return 1*t})):i.includes("rotate")?c[t][i]=1*a.match(/^-?\d+(\.\d+)?/)[0]:/[X, Y]/.test(i)?c[t][i]=/[X]/.test(i)?o(n[0],r.width):o(n[0],r.height):(c[t][i+"X"]=o(n[0],r.width),c[t][i+"Y"]=o(n[1]||n[0],r.height))})),"continue";if(/^font$/i.test(t)&&console.warn("font 不支持简写"),/^textindent/i.test(t)&&(c[t]=/^calc/.test(s)?s:Qt(s)),/^textstroke/i.test(t)){var k=t.match(/color|width|type$/i),I=(d="textStroke",s.split(" ").map((function(t){return/^\d+(rpx|px|vh|vw)?$/.test(t)?Qt(t):t})));return k?c[d]?c[d][k[0]]=I[0]:c[d]=((n={})[k[0]]=I[0],n):c[d]={width:I[0],color:I[1],type:I[2]},"continue"}/^left|top$/i.test(t)&&![he,ue].includes(r.position)?c[t]=0:c[t]=/^-?[\d\.]+(px|rpx|vw|vh)?$/.test(s)?Qt(s):/em$/.test(s)&&o==ce?Qt(s,r.fontSize):s},p=0,f=Object.keys(r);p<f.length;p++)u(f[p]);return c}(t,e);this.isAbsolute=o.position==_e,this.isFixed="fixed"==o.position,this.originStyle=o,Object.keys(o).forEach((function(t){Object.defineProperty(n.style,t,{configurable:!0,enumerable:!0,get:function(){return o[t]},set:function(e){o[t]=e}})}));var s={contentSize:ee({},this.contentSize),clientSize:ee({},this.clientSize),borderSize:ee({},this.borderSize),offsetSize:ee({},this.offsetSize)};Object.keys(s).forEach((function(t){Object.keys(n[t]).forEach((function(e){Object.defineProperty(n[t],e,{configurable:!0,enumerable:!0,get:function(){return s[t][e]},set:function(i){s[t][e]=i}})}))})),this.computedStyle=this.style}var e=t.prototype;return e.add=function(t){t.parent=this,this.children[t.id]=t},e.getChildren=function(){var t=this;return Object.keys(this.children).map((function(e){return t.children[e]}))},e.prev=function(t){void 0===t&&(t=this);var e=t.parent.getChildren();return e[e.findIndex((function(e){return e.id==t.id}))-1]},e.querySelector=function(t){var e=this.getChildren();return"string"!=typeof t?null:e.find((function(e){var i=e.id,a=e.attributes;return i==t||a&&a.uid==t}))||this.parent&&this.parent.querySelector&&this.parent.querySelector(t)||null},e.getLineRect=function(t,e){var i=e?e.lines:this.parent&&this.parent.lines;return i&&i.find((function(e){return e.ids.includes(t)}))||{width:0,height:0}},e.setPosition=function(t,e){var i={left:Dt,top:"height",right:Dt,bottom:"height"};Object.keys(i).forEach((function(a){var n=a==Mt?"left":"top";[Mt,Bt].includes(a)&&void 0!==t.style[a]&&!Xt(t.originStyle[n])?t.style[n]=e[i[a]]-t.offsetSize[i[a]]-Qt(t.style[a],e[i[a]]):t.style[a]=Qt(t.style[a],e[i[a]])}))},e.getAttributes=function(t){var e=t.attributes,i=void 0===e?{}:e,a=t.uid,n=t.url,o=t.src,s=t.replace,r=t.text;return a&&(i.uid=a),(n||o)&&(i.src=i.src||n||o),s&&(i.replace=s),r&&(i.text=r),i},e.getOffsetSize=function(t,e,i){void 0===i&&(i=Wt[3]);var a=e||{},n=a.margin,o=(n=void 0===n?{}:n).marginLeft,s=void 0===o?0:o,r=n.marginTop,l=void 0===r?0:r,c=n.marginRight,d=void 0===c?0:c,h=n.marginBottom,u=void 0===h?0:h,p=a.padding,f=(p=void 0===p?{}:p).paddingLeft,m=void 0===f?0:f,g=p.paddingTop,b=void 0===g?0:g,y=p.paddingRight,v=void 0===y?0:y,x=p.paddingBottom,w=void 0===x?0:x,_=a.border,k=(_=void 0===_?{}:_).borderWidth,I=void 0===k?0:k,S=a.borderTop,C=(S=void 0===S?{}:S).borderTopWidth,F=void 0===C?I:C,$=a.borderBottom,P=($=void 0===$?{}:$).borderBottomWidth,z=void 0===P?I:P,D=a.borderRight,T=(D=void 0===D?{}:D).borderRightWidth,M=void 0===T?I:T,B=a.borderLeft,W=(B=void 0===B?{}:B).borderLeftWidth,O=void 0===W?I:W,j=s<0&&d<0?Math.abs(s+d):0,L=l<0&&u<0?Math.abs(l+u):0,A=s>=0&&d<0,R=l>=0&&u<0;return i==Wt[0]&&(this[i].left=t.left+s+m+O+(A?2*-d:0),this[i].top=t.top+l+b+F+(R?2*-u:0),this[i].width=t.width+(this[i].widthAdd?0:j),this[i].height=t.height+(this[i].heightAdd?0:L),this[i].widthAdd=j,this[i].heightAdd=L),i==Wt[1]&&(this[i].left=t.left+s+O+(A<0?-d:0),this[i].top=t.top+l+F+(R?-u:0),this[i].width=t.width+m+v,this[i].height=t.height+b+w),i==Wt[2]&&(this[i].left=t.left+s+O/2+(A<0?-d:0),this[i].top=t.top+l+F/2+(R?-u:0),this[i].width=t.width+m+v+O/2+M/2,this[i].height=t.height+b+w+z/2+F/2),i==Wt[3]&&(this[i].left=t.left+(A<0?-d:0),this[i].top=t.top+(R?-u:0),this[i].width=t.width+m+v+O+M+s+d,this[i].height=t.height+b+w+z+F+u+l),this[i]},e.layoutBoxUpdate=function(t,e,i,a){var n=this;if(void 0===i&&(i=-1),"border-box"==e.boxSizing){var o=e||{},s=o.border,r=(s=void 0===s?{}:s).borderWidth,l=void 0===r?0:r,c=o.borderTop,d=(c=void 0===c?{}:c).borderTopWidth,h=void 0===d?l:d,u=o.borderBottom,p=(u=void 0===u?{}:u).borderBottomWidth,f=void 0===p?l:p,m=o.borderRight,g=(m=void 0===m?{}:m).borderRightWidth,b=void 0===g?l:g,y=o.borderLeft,v=(y=void 0===y?{}:y).borderLeftWidth,x=void 0===v?l:v,w=o.padding,_=(w=void 0===w?{}:w).paddingTop,k=void 0===_?0:_,I=w.paddingRight,S=void 0===I?0:I,C=w.paddingBottom,F=void 0===C?0:C,$=w.paddingLeft,P=void 0===$?0:$;i||(t.width-=P+S+b+x),1!==i||a||(t.height-=k+F+h+f)}this.layoutBox&&(Wt.forEach((function(i){return n.layoutBox[i]=n.getOffsetSize(t,e,i)})),this.layoutBox=Object.assign({},this.layoutBox,this.layoutBox.borderSize))},e.getBoxPosition=function(){var t=this.computedStyle,e=this.fixedLine,i=this.lines,a=t.left,n=void 0===a?0:a,o=t.top,s=void 0===o?0:o,r=t.padding||{},l=r.paddingBottom,c=void 0===l?0:l,d=r.paddingRight,h=void 0===d?0:d,u=ee({},this.contentSize,{left:n,top:s}),p=this.contentSize.top-this.offsetSize.top,f=this.contentSize.left-this.offsetSize.left;if(this.root.fixedLine&&!this.root.isDone){this.root.isDone=!0;for(var m,g=ne(this.root.fixedLine.elements);!(m=g()).done;){var b=m.value;b.setPosition(b,this.root.offsetSize),b.getBoxPosition()}}if(e)for(var y,v=ne(e.elements);!(y=v()).done;){var x=y.value;x.setPosition(x,u),x.style.left+=n+f+h,x.style.top+=s+p+c,x.getBoxPosition()}if(i)for(var w,_=ne(i);!(w=_()).done;)w.value.layout(u.top+p,u.left+f);return this.layoutBoxUpdate(u,t),this.layoutBox},e.getBoxState=function(t,e){return this.isBlock(t)||this.isBlock(e)},e.isBlock=function(t){return void 0===t&&(t=this),t&&"block"==t.style.display},e.isFlex=function(t){return void 0===t&&(t=this),t&&"flex"==t.style.display},e.isInFlow=function(){return!(this.isAbsolute||this.isFixed)},e.inFlexBox=function(t){return void 0===t&&(t=this),!!t.isInFlow()&&!!t.parent&&(!(!t.parent||"flex"!==t.parent.style.display)||void 0)},e.isInline=function(t){return void 0===t&&(t=this),t&&"inline-block"==t.style.display},e.contrastSize=function(t,e,i){var a=t;return i&&(a=Math.min(a,i)),e&&(a=Math.max(a,e)),a},e.measureText=function(t,e){var i=this.ctx.measureText(t),a=i.width,n=i.actualBoundingBoxAscent,o=i.actualBoundingBoxDescent;return{ascent:n,descent:o,width:a,fontHeight:n+o||.7*e+1}},e.getParentSize=function(t,e){if(void 0===t&&(t=this),void 0===e&&(e=!1),t&&t.parent){if(t.parent.contentSize.width)return t.parent.contentSize;if(e)return this.getParentSize(t.parent,e)}return null},e.getBoxWidthHeight=function(){var t=this,e=this.name,i=this.computedStyle,a=this.attributes,n=this.parent,o=void 0===n?{}:n,s=this.ctx,r=this.getChildren(),l=i.left,c=void 0===l?0:l,d=i.top,h=void 0===d?0:d,u=i.bottom,p=i.right,f=i.width,m=void 0===f?0:f,g=i.minWidth,b=i.maxWidth,y=i.minHeight,v=i.maxHeight,x=i.height,w=void 0===x?0:x,_=i.fontSize,k=i.fontWeight,I=i.fontFamily,S=i.fontStyle,C=i.position;i.textIndent;var F=i.lineClamp,$=i.lineHeight,P=i.padding,z=void 0===P?{}:P,D=i.margin,T=void 0===D?{}:D,M=i.border,B=(M=void 0===M?{}:M).borderWidth,W=void 0===B?0:B,O=i.borderRight,j=(O=void 0===O?{}:O).borderRightWidth,L=void 0===j?W:j,A=i.borderLeft,R=(A=void 0===A?{}:A).borderLeftWidth,E=void 0===R?W:R,V=o.contentSize&&o.contentSize.width,H=o.contentSize&&o.contentSize.height;if(re(m)&&V&&(m=Qt(m,V)),re(m)&&!V&&(m=null),re(w)&&H&&(w=Qt(w,H)),re(w)&&!H&&(w=null),re(g)&&V&&(g=Qt(g,V)),re(b)&&V&&(b=Qt(b,V)),re(y)&&H&&(y=Qt(y,H)),re(v)&&H&&(v=Qt(v,H)),i.padding&&V)for(var U in i.padding)Object.hasOwnProperty.call(z,U)&&(z[U]=Qt(z[U],V));var N=z.paddingRight,q=void 0===N?0:N,Y=z.paddingLeft,J=void 0===Y?0:Y;if(i.margin&&[T.marginLeft,T.marginRight].includes("auto"))if(m){var G=V&&V-m-q-J-E-L||0;T.marginLeft==T.marginRight?T.marginLeft=T.marginRight=G/2:se(T.marginLeft)?T.marginLeft=G:T.marginRight=G}else T.marginLeft=T.marginRight=0;var X=T.marginRight,Q=void 0===X?0:X,Z=T.marginLeft,K={width:m,height:w,left:0,top:0},tt=J+q+E+L+(void 0===Z?0:Z)+Q;if(this.offsetWidth=tt,e==xe&&!this.attributes.widths){var et=a.text||"";s.save(),s.setFonts({fontFamily:I,fontSize:_,fontWeight:k,fontStyle:S}),et.length,"\n"==et&&(et="",this.isBr=!0),(""+et).split("\n").map((function(e){var i=Array.from(e).map((function(e){var i=""+(/^[\u4e00-\u9fa5]+$/.test(e)?"cn":e)+I+_+k+S,a=Se.get(i);if(a)return{width:a,text:e};var n=t.measureText(e,_).width;return Se.set(i,n),{width:n,text:e}})),a=t.measureText(e,_),n=a.fontHeight,o=a.ascent,s=a.descent;t.attributes.fontHeight=n,t.attributes.ascent=o,t.attributes.descent=s,t.attributes.widths||(t.attributes.widths=[]),t.attributes.widths.push({widths:i,total:i.reduce((function(t,e){return t+e.width}),0)})})),s.restore()}if("image"==e&&null==m){var it=a.width,at=a.height;K.width=this.contrastSize(Math.round(it*w/at)||0,g,b),this.layoutBoxUpdate(K,i,0)}if(e==xe&&null==m){var nt=this.attributes.widths,ot=Math.max.apply(Math,nt.map((function(t){return t.total})));o&&V>0&&(ot>V||this.isBlock(this))&&!this.isAbsolute&&!this.isFixed&&(ot=V),K.width=this.contrastSize(ot,g,b),this.layoutBoxUpdate(K,i,0)}if(e==xe&&(o.style.flex||!this.attributes.lines)){var st=this.attributes.widths.length;this.attributes.widths.forEach((function(t){return t.widths.reduce((function(t,e,i){return t+e.width>K.width?(st++,e.width):t+e.width}),0)})),st=F&&st>F?F:st,this.attributes.lines=st}if("image"==e&&null==w){var rt=a.width,lt=a.height;a.text,K.height=this.contrastSize(Qt(K.width*lt/rt)||0,y,v),this.layoutBoxUpdate(K,i,1)}e==xe&&null==w&&($=Qt($,_),K.height=this.contrastSize(Qt(this.attributes.lines*$),y,v),this.layoutBoxUpdate(K,i,1,!0)),!m&&o&&o.children&&V&&(!this.isFlex(o)||o.isFlexCalc)&&([we,xe].includes(e)&&this.isFlex()||e==we&&this.isBlock(this)&&this.isInFlow())&&(K.width=this.contrastSize(V-(o.isFlexCalc?0:tt),g,b),this.layoutBoxUpdate(K,i)),m&&!re(m)&&(K.width=this.contrastSize(m,g,b),this.layoutBoxUpdate(K,i,0)),w&&!re(w)&&(K.height=this.contrastSize(K.height,y,v),this.layoutBoxUpdate(K,i,1));var ct=0;if(r.length){var dt=null,ht=!1;r.forEach((function(e,a){e.getBoxWidthHeight();var n=r[a+1];if(n&&n.isInFlow()&&(e.next=n),e.isInFlow()&&!e.inFlexBox()){var o=t.getBoxState(dt,e);if(e.isBr)return ht=!0;t.line&&t.line.canIEnter(e)&&!o&&!ht?t.line.add(e):(ht=!1,(new be).bind(e)),dt=e}else e.inFlexBox()?t.line&&(t.line.canIEnter(e)||"nowrap"==i.flexWrap)?t.line.add(e):(new ve).bind(e):e.isFixed?t.root.fixedLine?t.root.fixedLine.fixedAdd(e):(new be).fixedBind(e):t.fixedLine?t.fixedLine.fixedAdd(e):(new be).fixedBind(e,1)})),this.lines&&(ct=this.lines.reduce((function(t,e){return t+e.height}),0))}var ut=0,pt=0;if(!m&&(this.isAbsolute||this.isFixed)&&V){var ft=C==_e?V:this.root.width,mt=ft-(re(c)?Qt(c,ft):c)-(re(p)?Qt(p,ft):p);ut=i.left?mt:this.lineMaxWidth}if(!w&&(null!=h?h:this.isAbsolute||this.isFixed&&H)){var gt=C==_e?H:this.root.height,bt=gt-(re(h)?Qt(h,gt):h)-(re(u)?Qt(u,gt):u);pt=i.top?bt:0}if(m&&!re(m)||K.width||(K.width=ut||this.contrastSize((this.isBlock(this)&&!this.isInFlow()?V||o.lineMaxWidth:this.lineMaxWidth)||this.lineMaxWidth,g,b),this.layoutBoxUpdate(K,i,0)),w||!ct&&!pt||(K.height=pt||this.contrastSize(ct,y,v),this.layoutBoxUpdate(K,i)),i.borderRadius&&this.borderSize&&this.borderSize.width)for(var yt in i.borderRadius)Object.hasOwnProperty.call(i.borderRadius,yt)&&(i.borderRadius[yt]=Qt(i.borderRadius[yt],this.borderSize.width));return this.layoutBox},e.layout=function(){return this.getBoxWidthHeight(),this.root.offsetSize=this.offsetSize,this.root.contentSize=this.contentSize,this.getBoxPosition(),this.offsetSize},t}(),Fe=function(){var t,e,i,a,n,o,s=[0,11,15,19,23,27,31,16,18,20,22,24,26,28,20,22,24,24,26,28,28,22,24,24,26,26,28,28,24,24,26,26,26,28,28,24,26,26,26,28,28],r=[3220,1468,2713,1235,3062,1890,2119,1549,2344,2936,1117,2583,1330,2470,1667,2249,2028,3780,481,4011,142,3098,831,3445,592,2517,1776,2234,1951,2827,1070,2660,1345,3177],l=[30660,29427,32170,30877,26159,25368,27713,26998,21522,20773,24188,23371,17913,16590,20375,19104,13663,12392,16177,14854,9396,8579,11994,11245,5769,5054,7399,6608,1890,597,3340,2107],c=[1,0,19,7,1,0,16,10,1,0,13,13,1,0,9,17,1,0,34,10,1,0,28,16,1,0,22,22,1,0,16,28,1,0,55,15,1,0,44,26,2,0,17,18,2,0,13,22,1,0,80,20,2,0,32,18,2,0,24,26,4,0,9,16,1,0,108,26,2,0,43,24,2,2,15,18,2,2,11,22,2,0,68,18,4,0,27,16,4,0,19,24,4,0,15,28,2,0,78,20,4,0,31,18,2,4,14,18,4,1,13,26,2,0,97,24,2,2,38,22,4,2,18,22,4,2,14,26,2,0,116,30,3,2,36,22,4,4,16,20,4,4,12,24,2,2,68,18,4,1,43,26,6,2,19,24,6,2,15,28,4,0,81,20,1,4,50,30,4,4,22,28,3,8,12,24,2,2,92,24,6,2,36,22,4,6,20,26,7,4,14,28,4,0,107,26,8,1,37,22,8,4,20,24,12,4,11,22,3,1,115,30,4,5,40,24,11,5,16,20,11,5,12,24,5,1,87,22,5,5,41,24,5,7,24,30,11,7,12,24,5,1,98,24,7,3,45,28,15,2,19,24,3,13,15,30,1,5,107,28,10,1,46,28,1,15,22,28,2,17,14,28,5,1,120,30,9,4,43,26,17,1,22,28,2,19,14,28,3,4,113,28,3,11,44,26,17,4,21,26,9,16,13,26,3,5,107,28,3,13,41,26,15,5,24,30,15,10,15,28,4,4,116,28,17,0,42,26,17,6,22,28,19,6,16,30,2,7,111,28,17,0,46,28,7,16,24,30,34,0,13,24,4,5,121,30,4,14,47,28,11,14,24,30,16,14,15,30,6,4,117,30,6,14,45,28,11,16,24,30,30,2,16,30,8,4,106,26,8,13,47,28,7,22,24,30,22,13,15,30,10,2,114,28,19,4,46,28,28,6,22,28,33,4,16,30,8,4,122,30,22,3,45,28,8,26,23,30,12,28,15,30,3,10,117,30,3,23,45,28,4,31,24,30,11,31,15,30,7,7,116,30,21,7,45,28,1,37,23,30,19,26,15,30,5,10,115,30,19,10,47,28,15,25,24,30,23,25,15,30,13,3,115,30,2,29,46,28,42,1,24,30,23,28,15,30,17,0,115,30,10,23,46,28,10,35,24,30,19,35,15,30,17,1,115,30,14,21,46,28,29,19,24,30,11,46,15,30,13,6,115,30,14,23,46,28,44,7,24,30,59,1,16,30,12,7,121,30,12,26,47,28,39,14,24,30,22,41,15,30,6,14,121,30,6,34,47,28,46,10,24,30,2,64,15,30,17,4,122,30,29,14,46,28,49,10,24,30,24,46,15,30,4,18,122,30,13,32,46,28,48,14,24,30,42,32,15,30,20,4,117,30,40,7,47,28,43,22,24,30,10,67,15,30,19,6,118,30,18,31,47,28,34,34,24,30,20,61,15,30],d=[255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175],h=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,0],u=[],p=[],f=[],m=[],g=[],b=2;function y(t,e){var i;t>e&&(i=t,t=e,e=i),i=e,i*=e,i+=e,i>>=1,m[i+=t]=1}function v(t,i){var a;for(f[t+e*i]=1,a=-2;a<2;a++)f[t+a+e*(i-2)]=1,f[t-2+e*(i+a+1)]=1,f[t+2+e*(i+a)]=1,f[t+a+1+e*(i+2)]=1;for(a=0;a<2;a++)y(t-1,i+a),y(t+1,i-a),y(t-a,i-1),y(t+a,i+1)}function x(t){for(;t>=255;)t=((t-=255)>>8)+(255&t);return t}var w=[];function _(t,e,i,a){var n,o,s;for(n=0;n<a;n++)u[i+n]=0;for(n=0;n<e;n++){if(255!=(s=d[u[t+n]^u[i]]))for(o=1;o<a;o++)u[i+o-1]=u[i+o]^h[x(s+w[a-o])];else for(o=i;o<i+a;o++)u[o]=u[o+1];u[i+a-1]=255==s?0:h[x(s+w[0])]}}function k(t,e){var i;return t>e&&(i=t,t=e,e=i),i=e,i+=e*e,i>>=1,m[i+=t]}function I(t){var i,a,n,o;switch(t){case 0:for(a=0;a<e;a++)for(i=0;i<e;i++)i+a&1||k(i,a)||(f[i+a*e]^=1);break;case 1:for(a=0;a<e;a++)for(i=0;i<e;i++)1&a||k(i,a)||(f[i+a*e]^=1);break;case 2:for(a=0;a<e;a++)for(n=0,i=0;i<e;i++,n++)3==n&&(n=0),n||k(i,a)||(f[i+a*e]^=1);break;case 3:for(o=0,a=0;a<e;a++,o++)for(3==o&&(o=0),n=o,i=0;i<e;i++,n++)3==n&&(n=0),n||k(i,a)||(f[i+a*e]^=1);break;case 4:for(a=0;a<e;a++)for(n=0,o=a>>1&1,i=0;i<e;i++,n++)3==n&&(n=0,o=!o),o||k(i,a)||(f[i+a*e]^=1);break;case 5:for(o=0,a=0;a<e;a++,o++)for(3==o&&(o=0),n=0,i=0;i<e;i++,n++)3==n&&(n=0),(i&a&1)+!(!n|!o)||k(i,a)||(f[i+a*e]^=1);break;case 6:for(o=0,a=0;a<e;a++,o++)for(3==o&&(o=0),n=0,i=0;i<e;i++,n++)3==n&&(n=0),(i&a&1)+(n&&n==o)&1||k(i,a)||(f[i+a*e]^=1);break;case 7:for(o=0,a=0;a<e;a++,o++)for(3==o&&(o=0),n=0,i=0;i<e;i++,n++)3==n&&(n=0),(n&&n==o)+(i+a&1)&1||k(i,a)||(f[i+a*e]^=1)}}function S(t){var e,i=0;for(e=0;e<=t;e++)g[e]>=5&&(i+=3+g[e]-5);for(e=3;e<t-1;e+=2)g[e-2]==g[e+2]&&g[e+2]==g[e-1]&&g[e-1]==g[e+1]&&3*g[e-1]==g[e]&&(0==g[e-3]||e+3>t||3*g[e-3]>=4*g[e]||3*g[e+3]>=4*g[e])&&(i+=40);return i}function C(){var t,i,a,n,o,s=0,r=0;for(i=0;i<e-1;i++)for(t=0;t<e-1;t++)(f[t+e*i]&&f[t+1+e*i]&&f[t+e*(i+1)]&&f[t+1+e*(i+1)]||!(f[t+e*i]||f[t+1+e*i]||f[t+e*(i+1)]||f[t+1+e*(i+1)]))&&(s+=3);for(i=0;i<e;i++){for(g[0]=0,a=n=t=0;t<e;t++)(o=f[t+e*i])==n?g[a]++:g[++a]=1,r+=(n=o)?1:-1;s+=S(a)}r<0&&(r=-r);var l=r,c=0;for(l+=l<<2,l<<=1;l>e*e;)l-=e*e,c++;for(s+=10*c,t=0;t<e;t++){for(g[0]=0,a=n=i=0;i<e;i++)(o=f[t+e*i])==n?g[a]++:g[++a]=1,n=o;s+=S(a)}return s}var F=null;return{api:{get ecclevel(){return b},set ecclevel(t){b=t},get size(){return _size},set size(t){_size=t},get canvas(){return F},set canvas(t){F=t},getFrame:function(g){return function(g){var S,F,$,P,z,D,T,M;P=g.length,t=0;do{if(t++,$=4*(b-1)+16*(t-1),i=c[$++],a=c[$++],n=c[$++],o=c[$],P<=($=n*(i+a)+a-3+(t<=9)))break}while(t<40);for(e=17+4*t,z=n+(n+o)*(i+a)+a,P=0;P<z;P++)p[P]=0;for(u=g.slice(0),P=0;P<e*e;P++)f[P]=0;for(P=0;P<(e*(e+1)+1)/2;P++)m[P]=0;for(P=0;P<3;P++){for($=0,F=0,1==P&&($=e-7),2==P&&(F=e-7),f[F+3+e*($+3)]=1,S=0;S<6;S++)f[F+S+e*$]=1,f[F+e*($+S+1)]=1,f[F+6+e*($+S)]=1,f[F+S+1+e*($+6)]=1;for(S=1;S<5;S++)y(F+S,$+1),y(F+1,$+S+1),y(F+5,$+S),y(F+S+1,$+5);for(S=2;S<4;S++)f[F+S+e*($+2)]=1,f[F+2+e*($+S+1)]=1,f[F+4+e*($+S)]=1,f[F+S+1+e*($+4)]=1}if(t>1)for(P=s[t],F=e-7;;){for(S=e-7;S>P-3&&(v(S,F),!(S<P));)S-=P;if(F<=P+9)break;v(6,F-=P),v(F,6)}for(f[8+e*(e-8)]=1,F=0;F<7;F++)y(7,F),y(e-8,F),y(7,F+e-7);for(S=0;S<8;S++)y(S,7),y(S+e-8,7),y(S,e-8);for(S=0;S<9;S++)y(S,8);for(S=0;S<8;S++)y(S+e-8,8),y(8,S);for(F=0;F<7;F++)y(8,F+e-7);for(S=0;S<e-14;S++)1&S?(y(8+S,6),y(6,8+S)):(f[8+S+6*e]=1,f[6+e*(8+S)]=1);if(t>6)for(P=r[t-7],$=17,S=0;S<6;S++)for(F=0;F<3;F++,$--)1&($>11?t>>$-12:P>>$)?(f[5-S+e*(2-F+e-11)]=1,f[2-F+e-11+e*(5-S)]=1):(y(5-S,2-F+e-11),y(2-F+e-11,5-S));for(F=0;F<e;F++)for(S=0;S<=F;S++)f[S+e*F]&&y(S,F);for(z=u.length,D=0;D<z;D++)p[D]=u.charCodeAt(D);if(u=p.slice(0),z>=(S=n*(i+a)+a)-2&&(z=S-2,t>9&&z--),D=z,t>9){for(u[D+2]=0,u[D+3]=0;D--;)P=u[D],u[D+3]|=255&P<<4,u[D+2]=P>>4;u[2]|=255&z<<4,u[1]=z>>4,u[0]=64|z>>12}else{for(u[D+1]=0,u[D+2]=0;D--;)P=u[D],u[D+2]|=255&P<<4,u[D+1]=P>>4;u[1]|=255&z<<4,u[0]=64|z>>4}for(D=z+3-(t<10);D<S;)u[D++]=236,u[D++]=17;for(w[0]=1,D=0;D<o;D++){for(w[D+1]=1,T=D;T>0;T--)w[T]=w[T]?w[T-1]^h[x(d[w[T]]+D)]:w[T-1];w[0]=h[x(d[w[0]]+D)]}for(D=0;D<=o;D++)w[D]=d[w[D]];for($=S,F=0,D=0;D<i;D++)_(F,n,$,o),F+=n,$+=o;for(D=0;D<a;D++)_(F,n+1,$,o),F+=n+1,$+=o;for(F=0,D=0;D<n;D++){for(T=0;T<i;T++)p[F++]=u[D+T*n];for(T=0;T<a;T++)p[F++]=u[i*n+D+T*(n+1)]}for(T=0;T<a;T++)p[F++]=u[i*n+D+T*(n+1)];for(D=0;D<o;D++)for(T=0;T<i+a;T++)p[F++]=u[S+D+T*o];for(u=p,S=F=e-1,$=z=1,M=(n+o)*(i+a)+a,D=0;D<M;D++)for(P=u[D],T=0;T<8;T++,P<<=1){128&P&&(f[S+e*F]=1);do{z?S--:(S++,$?0!=F?F--:($=!$,6==(S-=2)&&(S--,F=9)):F!=e-1?F++:($=!$,6==(S-=2)&&(S--,F-=8))),z=!z}while(k(S,F))}for(u=f.slice(0),P=0,F=3e4,$=0;$<8&&(I($),(S=C())<F&&(F=S,P=$),7!=P);$++)f=u.slice(0);for(P!=$&&I(P),F=l[P+(b-1<<3)],$=0;$<8;$++,F>>=1)1&F&&(f[e-1-$+8*e]=1,$<6?f[8+e*$]=1:f[8+e*($+1)]=1);for($=0;$<7;$++,F>>=1)1&F&&(f[8+e*(e-7+$)]=1,$?f[6-$+8*e]=1:f[7+8*e]=1);return f}(g)},utf16to8:function(t){var e,i,a,n;for(e="",a=t.length,i=0;i<a;i++)(n=t.charCodeAt(i))>=1&&n<=127?e+=t.charAt(i):n>2047?(e+=String.fromCharCode(224|n>>12&15),e+=String.fromCharCode(128|n>>6&63),e+=String.fromCharCode(128|n>>0&63)):(e+=String.fromCharCode(192|n>>6&31),e+=String.fromCharCode(128|n>>0&63));return e},draw:function(t,i,a,n,o){i.drawView(a,n);var s=i.ctx,r=a.contentSize,l=r.width,c=r.height,d=r.left,h=r.top;n.borderRadius,n.backgroundColor;var u=n.color,p=void 0===u?"#000000":u;if(n.border,a.contentSize.left,a.borderSize.left,a.contentSize.top,a.borderSize.top,b=o||b,s){s.save(),i.setOpacity(n),i.setTransform(a,n);var f=Math.min(l,c);t=this.utf16to8(t);var m=this.getFrame(t),g=f/e;s.setFillStyle(p);for(var y=0;y<e;y++)for(var v=0;v<e;v++)m[v*e+y]&&s.fillRect(d+g*y,h+g*v,g,g);s.restore(),i.setBorder(a,n)}else console.warn("No canvas provided to draw QR code in!")}}}}(),$e=Rt,Pe=At,ze=Et,De=Lt,Te=Ot.TOP,Me=Ot.MIDDLE,Be=Ot.BOTTOM,We=jt.LEFT,Oe=jt.CENTER,je=jt.RIGHT,Le=function(){function t(t){var e,i=this;this.v="1.9.5.1",this.id=null,this.pixelRatio=1,this.width=0,this.height=0,this.sleep=1e3/30,this.count=0,this.isRate=!1,this.isDraw=!0,this.isCache=!0,this.fixed="",this.useCORS=!1,this.performance=!1,this.imageBus=[],this.createImage=function(t,e){return new Promise((function(a,n){var o=null;window||i.canvas.createImage?(o=i.canvas&&i.canvas.createImage?i.canvas.createImage():new Image,e&&o.setAttribute("crossOrigin","Anonymous"),o.src=t,o.onload=function(){a({width:o.naturalWidth||o.width,height:o.naturalHeight||o.height,path:o,src:this.src})},o.onerror=function(t){n(t)}):n({fail:"getImageInfo fail",src:t})}))},this.options=t,Object.assign(this,t),this.ctx=((e=t.context).setFonts=function(t){var i=t.fontFamily,a=void 0===i?"sans-serif":i,n=t.fontSize,o=void 0===n?14:n,s=t.fontWeight,r=void 0===s?"normal":s,l=t.fontStyle,c=void 0===l?"normal":l;Yt==zt.MP_TOUTIAO&&(r="bold"==r?"bold":"",c="italic"==c?"italic":""),e.font=c+" "+r+" "+Math.round(o)+"px "+a},e.draw&&e.setFillStyle?e:Object.assign(e,{setStrokeStyle:function(t){e.strokeStyle=t},setLineWidth:function(t){e.lineWidth=t},setLineCap:function(t){e.lineCap=t},setFillStyle:function(t){e.fillStyle=t},setFontSize:function(t){e.font=String(t)+"px sans-serif"},setGlobalAlpha:function(t){e.globalAlpha=t},setLineJoin:function(t){e.lineJoin=t},setTextAlign:function(t){e.textAlign=t},setMiterLimit:function(t){e.miterLimit=t},setShadow:function(t,i,a,n){e.shadowOffsetX=t,e.shadowOffsetY=i,e.shadowBlur=a,e.shadowColor=n},setTextBaseline:function(t){e.textBaseline=t},createCircularGradient:function(){},draw:function(){}})),this.progress=0,this.root={width:t.width,height:t.height,fontSizeRate:1,fixedLine:null},this.size=this.root;var a=0;Object.defineProperty(this,"progress",{configurable:!0,set:function(t){a=t,i.lifecycle("onProgress",t/i.count)},get:function(){return a||0}})}return t.prototype.lifecycle=function(t,e){this.options.listen&&this.options.listen[t]&&this.options.listen[t](e)},t.prototype.setContext=function(t){t&&(this.ctx=t)},t.prototype.init=function(){if(this.canvas.height||zt.WEB==Yt){this.ctx.setTransform(1,0,0,1,0,0);var t=this.size.height*this.pixelRatio,e=this.size.width*this.pixelRatio;this.canvas.height=t,this.canvas.width=e,this.ctx.scale(this.pixelRatio,this.pixelRatio)}},t.prototype.clear=function(){this.ctx.clearRect(0,0,this.size.width,this.size.height)},t.prototype.clipPath=function(t,e,i,a,n,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);var r=this.ctx;if(/polygon/.test(n)){var l=n.match(/-?\d+(rpx|px|%)?\s+-?\d+(rpx|px|%)?/g)||[];r.beginPath(),l.map((function(n){var o=n.split(" "),s=o[0],r=o[1];return[Qt(s,i)+t,Qt(r,a)+e]})).forEach((function(t,e){0==e?r.moveTo(t[0],t[1]):r.lineTo(t[0],t[1])})),r.closePath(),s&&r.stroke(),o&&r.fill()}},t.prototype.roundRect=function(t,e,i,a,n,o,s){if(void 0===o&&(o=!1),void 0===s&&(s=!1),!(n<0)){var r=this.ctx;if(r.beginPath(),n){var l=n||{},c=l.borderTopLeftRadius,d=void 0===c?n||0:c,h=l.borderTopRightRadius,u=void 0===h?n||0:h,p=l.borderBottomRightRadius,f=void 0===p?n||0:p,m=l.borderBottomLeftRadius,g=void 0===m?n||0:m;r.arc(t+i-f,e+a-f,f,0,.5*Math.PI),r.lineTo(t+g,e+a),r.arc(t+g,e+a-g,g,.5*Math.PI,Math.PI),r.lineTo(t,e+d),r.arc(t+d,e+d,d,Math.PI,1.5*Math.PI),r.lineTo(t+i-u,e),r.arc(t+i-u,e+u,u,1.5*Math.PI,2*Math.PI),r.lineTo(t+i,e+a-f)}else r.rect(t,e,i,a);r.closePath(),s&&r.stroke(),o&&r.fill()}},t.prototype.setTransform=function(t,e){var i=e.transform,a=e.transformOrigin,n=this.ctx,o=i||{},s=o.scaleX,r=void 0===s?1:s,l=o.scaleY,c=void 0===l?1:l,d=o.translateX,h=void 0===d?0:d,u=o.translateY,p=void 0===u?0:u,f=o.rotate,m=void 0===f?0:f,g=o.skewX,b=void 0===g?0:g,y=o.skewY,v=void 0===y?0:y,x=t.left,w=t.top,_=t.width,k=t.height;h=Qt(h,_)||0,p=Qt(p,k)||0;var I=Qt("0%",1),S=Qt("50%",1),C=Qt("100%",1),F={top:I,center:S,bottom:C},$={left:I,center:S,right:C};if(a=a.split(" ").filter((function(t,e){return e<2})).reduce((function(t,e){if(/\d+/.test(e)){var i=Qt(e,1)/(/px|rpx$/.test(e)?Xt(t.x)?k:_:1);return Xt(t.x)?Object.assign(t,{y:i}):Object.assign(t,{x:i})}return Xt($[e])&&!Xt(t.x)?Object.assign(t,{x:$[e]}):Object.assign(t,{y:F[e]||.5})}),{}),(h||p)&&n.translate(h,p),(r||c)&&n.scale(r,c),m){var P=x+_*a.x,z=w+k*a.y;n.translate(P,z),n.rotate(m*Math.PI/180),n.translate(-P,-z)}(b||v)&&n.transform(1,Math.tan(v*Math.PI/180),Math.tan(b*Math.PI/180),1,0,0)},t.prototype.setBackground=function(t,e,i,a,n){var o=this.ctx;t&&"transparent"!=t?function(t){return!(!t||!t.startsWith("linear")&&!t.startsWith("radial"))}(t)?function(t,e,i,a,n,o){t.startsWith("linear")?function(t,e,i,a,n,o){for(var s=function(t,e,i,a,n){void 0===a&&(a=0),void 0===n&&(n=0);var o=t.match(/([-]?\d{1,3})deg/),s=o&&o[1]?parseFloat(o[1]):0;if(s>=360&&(s-=360),s<0&&(s+=360),0===(s=Math.round(s)))return{x0:Math.round(e/2)+a,y0:i+n,x1:Math.round(e/2)+a,y1:n};if(180===s)return{x0:Math.round(e/2)+a,y0:n,x1:Math.round(e/2)+a,y1:i+n};if(90===s)return{x0:a,y0:Math.round(i/2)+n,x1:e+a,y1:Math.round(i/2)+n};if(270===s)return{x0:e+a,y0:Math.round(i/2)+n,x1:a,y1:Math.round(i/2)+n};var r=Math.round(180*Math.asin(e/Math.sqrt(Math.pow(e,2)+Math.pow(i,2)))/Math.PI);if(s===r)return{x0:a,y0:i+n,x1:e+a,y1:n};if(s===180-r)return{x0:a,y0:n,x1:e+a,y1:i+n};if(s===180+r)return{x0:e+a,y0:n,x1:a,y1:i+n};if(s===360-r)return{x0:e+a,y0:i+n,x1:a,y1:n};var l,c=0,d=0,h=0,u=0;if(s<r||s>180-r&&s<180||s>180&&s<180+r||s>360-r){var p=s*Math.PI/180,f=s<r||s>360-r?i/2:-i/2,m=Math.tan(p)*f,g=s<r||s>180-r&&s<180?e/2-m:-e/2-m;c=-(h=m+(l=Math.pow(Math.sin(p),2)*g)),d=-(u=f+l/Math.tan(p))}return(s>r&&s<90||s>90&&s<90+r||s>180+r&&s<270||s>270&&s<360-r)&&(p=(90-s)*Math.PI/180,m=s>r&&s<90||s>90&&s<90+r?e/2:-e/2,f=Math.tan(p)*m,g=s>r&&s<90||s>270&&s<360-r?i/2-f:-i/2-f,c=-(h=m+(l=Math.pow(Math.sin(p),2)*g)/Math.tan(p)),d=-(u=f+l)),{x0:c=Math.round(c+e/2)+a,y0:d=Math.round(i/2-d)+n,x1:h=Math.round(h+e/2)+a,y1:u=Math.round(i/2-u)+n}}(n,t,e,i,a),r=s.x0,l=s.y0,c=s.x1,d=s.y1,h=o.createLinearGradient(r,l,c,d),u=n.match(/linear-gradient\((.+)\)/)[1],p=Kt(u.substring(u.indexOf(",")+1)),f=0;f<p.colors.length;f++)h.addColorStop(p.percents[f],p.colors[f]);o.setFillStyle(h)}(e,i,a,n,t,o):t.startsWith("radial")&&function(t,e,i,a,n,o){for(var s=Kt(n.match(/radial-gradient\((.+)\)/)[1]),r=Math.round(t/2)+i,l=Math.round(e/2)+a,c=o.createRadialGradient(r,l,0,r,l,Math.max(t,e)/2),d=0;d<s.colors.length;d++)c.addColorStop(s.percents[d],s.colors[d]);o.setFillStyle(c)}(e,i,a,n,t,o)}(t,e,i,a,n,o):o.setFillStyle(t):[zt.MP_TOUTIAO,zt.MP_BAIDU].includes(Yt)?o.setFillStyle("rgba(0,0,0,0)"):o.setFillStyle("transparent")},t.prototype.setShadow=function(t){var e=t.boxShadow,i=void 0===e?[]:e,a=this.ctx;if(i.length){var n=i[0],o=i[1],s=i[2],r=i[3];a.setShadow(n,o,s,r)}},t.prototype.setBorder=function(t,e){var i=this.ctx,a=t.width,n=t.height,o=t.left,s=t.top,r=e.border,l=e.borderBottom,c=e.borderTop,d=e.borderRight,h=e.borderLeft,u=e.borderRadius,p=e.lineCap,f=r||{},m=f.borderWidth,g=void 0===m?0:m,b=f.borderStyle,y=f.borderColor,v=l||{},x=v.borderBottomWidth,w=void 0===x?g:x,_=v.borderBottomStyle,k=void 0===_?b:_,I=v.borderBottomColor,S=void 0===I?y:I,C=c||{},F=C.borderTopWidth,$=void 0===F?g:F,P=C.borderTopStyle,z=void 0===P?b:P,D=C.borderTopColor,T=void 0===D?y:D,M=d||{},B=M.borderRightWidth,W=void 0===B?g:B,O=M.borderRightStyle,j=void 0===O?b:O,L=M.borderRightColor,A=void 0===L?y:L,R=h||{},E=R.borderLeftWidth,V=void 0===E?g:E,H=R.borderLeftStyle,U=void 0===H?b:H,N=R.borderLeftColor,q=void 0===N?y:N,Y=u||{},J=Y.borderTopLeftRadius,G=void 0===J?u||0:J,X=Y.borderTopRightRadius,Q=void 0===X?u||0:X,Z=Y.borderBottomRightRadius,K=void 0===Z?u||0:Z,tt=Y.borderBottomLeftRadius,et=void 0===tt?u||0:tt;if(l||h||c||d||r){var it=function(t,e,a){"dashed"==e?/mp/.test(Yt)?i.setLineDash([Math.ceil(4*t/3),Math.ceil(4*t/3)]):i.setLineDash([Math.ceil(6*t),Math.ceil(6*t)]):"dotted"==e&&i.setLineDash([t,t]),i.setStrokeStyle(a)},at=function(t,e,a,n,o,s,r,l,c,d,h,u,f,m,g){i.save(),i.setLineCap(g?"square":p),i.setLineWidth(u),it(u,f,m),i.beginPath(),i.arc(t,e,r,Math.PI*c,Math.PI*d),i.lineTo(a,n),i.arc(o,s,l,Math.PI*d,Math.PI*h),i.stroke(),i.restore()};if(i.save(),r&&!l&&!h&&!c&&!d)return i.setLineWidth(g),it(g,b,y),this.roundRect(o,s,a,n,u,!1,!!y),void i.restore();w&&at(o+a-K,s+n-K,o+et,s+n,o+et,s+n-et,K,et,.25,.5,.75,w,k,S,V&&W),V&&at(o+et,s+n-et,o,s+G,o+G,s+G,et,G,.75,1,1.25,V,U,q,$&&w),$&&at(o+G,s+G,o+a-Q,s,o+a-Q,s+Q,G,Q,1.25,1.5,1.75,$,z,T,V&&W),W&&at(o+a-Q,s+Q,o+a,s+n-K,o+a-K,s+n-K,Q,K,1.75,2,.25,W,j,A,$&&w)}},t.prototype.setOpacity=function(t){var e=t.opacity,i=void 0===e?1:e;this.ctx.setGlobalAlpha(i)},t.prototype.drawPattern=function(t,e,i){return $t(this,void 0,void 0,(function(){var a=this;return Pt(this,(function(n){return[2,new Promise((function(n,o){a.drawView(e,i,!0,!1,!0);var s=a,r=s.ctx;s.canvas;var l,c,d=e.width,h=e.height,u=e.left,p=e.top,f=i||{},m=f.borderRadius,g=void 0===m?0:m,b=f.backgroundImage,y=f.backgroundRepeat,v=void 0===y?"repeat":y;b&&(l=t,c=r.createPattern(l.src,v),r.setFillStyle(c),a.roundRect(u,p,d,h,g,!0,!1),a.setBorder(e,i),n())}))]}))}))},t.prototype.drawView=function(t,e,i,a,n){void 0===i&&(i=!0),void 0===a&&(a=!0),void 0===n&&(n=!0);var o=this.ctx,s=t.width,r=t.height,l=t.left,c=t.top,d=e||{},h=d.borderRadius,u=void 0===h?0:h,p=d.backgroundColor,f=void 0===p?"transparent":p,m=d.overflow;e.opacity&&this.setOpacity(e),this.setTransform(t,e),n&&(o.save(),this.setShadow(e)),i&&this.setBackground(f,s,r,l,c),e.clipPath?this.clipPath(l,c,s,r,e.clipPath,i,!1):this.roundRect(l,c,s,r,u,i,!1),n&&o.restore(),a&&this.setBorder(t,e),"hidden"==m&&o.clip()},t.prototype.drawImage=function(t,e,i,a){return void 0===e&&(e={}),void 0===i&&(i={}),void 0===a&&(a=!0),$t(this,void 0,void 0,(function(){var n=this;return Pt(this,(function(o){switch(o.label){case 0:return[4,new Promise((function(o,s){return $t(n,void 0,void 0,(function(){var n,s,r,l,c,d,h,u,p,f,m,g,b,y,v,x,w,_,k,I,S=this;return Pt(this,(function(C){return n=this.ctx,s=i.borderRadius,r=void 0===s?0:s,l=i.backgroundColor,c=void 0===l?"transparent":l,d=i.objectFit,h=void 0===d?"fill":d,u=i.backgroundSize,p=void 0===u?"fill":u,f=i.objectPosition,m=i.backgroundPosition,g=i.boxShadow,i.backgroundImage&&(h=p,f=m),g&&this.drawView(e,Object.assign(i,{backgroundColor:c||g&&(c||"#ffffff")}),!0,!1,!0),b=e.width,y=e.height,v=e.left,x=e.top,n.save(),w=e.contentSize.left-e.borderSize.left,_=e.contentSize.top-e.borderSize.top,a||(this.setOpacity(i),this.setTransform(e,i),this.setBackground(c,b,y,v,x),this.roundRect(v,x,b,y,r,!!(r||!g&&c),!1)),v+=w,x+=_,n.clip(),k=function(t){if("fill"!==h){var i=function(t,e,i){var a=t.objectFit,n=t.objectPosition,o=e.width/e.height,s=i.width/i.height,r=1,l="contain",c="cover";a==l&&o>=s||a==c&&o<s?r=e.height/i.height:(a==l&&o<s||a==c&&o>=s)&&(r=e.width/i.width);var d=i.width*r,h=i.height*r,u=n||[],p=u[0],f=u[1],m=Xt(p)?Qt(p,e.width):(e.width-d)*(Zt(p)?Qt(p,1):{left:0,center:.5,right:1}[p||"center"]),g=Xt(f)?Qt(f,e.height):(e.height-h)*(Zt(f)?Qt(f,1):{top:0,center:.5,bottom:1}[f||"center"]),b=function(t,e){return[(t-m)/r,(e-g)/r]},y=b(0,0),v=y[0],x=y[1],w=b(e.width,e.height),_=w[0],k=w[1],I=Math.max,S=Math.min;return{sx:I(v,0),sy:I(x,0),sw:S(_-v,i.width),sh:S(k-x,i.height),dx:I(m,0),dy:I(g,0),dw:S(d,e.width),dh:S(h,e.height)}}({objectFit:h,objectPosition:f},e.contentSize,t),a=i.sx,o=i.sy,s=i.sh,r=i.sw,l=i.dx,c=i.dy,d=i.dh,u=i.dw;Yt==zt.MP_BAIDU?n.drawImage(t.src,l+v,c+x,u,d,a,o,r,s):n.drawImage(t.src,a,o,r,s,l+v,c+x,u,d)}else n.drawImage(t.src,v,x,b,y)},I=function(){n.restore(),S.drawView(e,i,!1,!0,!1),o(1)},k(t),I(),[2]}))}))}))];case 1:return o.sent(),[2]}}))}))},t.prototype.drawText=function(t,e,i,a){var n=this,o=this.ctx,s=e.borderSize,r=e.contentSize,l=e.left,c=e.top,d=r.width,h=r.height,u=r.left-s.left||0,p=r.top-s.top||0,f=i.color,m=i.lineHeight,g=i.fontSize,b=i.fontWeight,y=i.fontFamily,v=i.fontStyle,x=i.textIndent,w=void 0===x?0:x,_=i.textAlign,k=i.textStroke,I=i.verticalAlign,S=void 0===I?Me:I,C=i.backgroundColor,F=i.lineClamp,$=i.backgroundClip,P=i.textShadow,z=i.textDecoration;if(w=Xt(w)?w:0,this.drawView(e,i,$!=Pe),m=Qt(m,g),t){o.save(),l+=u,c+=p;var D=a.fontHeight,T=a.descent,M=void 0===T?0:T,B=a.ascent,W=M+(void 0===B?0:B);switch(o.setFonts({fontFamily:y,fontSize:g,fontWeight:b,fontStyle:v}),o.setTextBaseline(Me),o.setTextAlign(_),$?this.setBackground(C,d,h,l,c):o.setFillStyle(f),_){case We:break;case Oe:l+=.5*d;break;case je:l+=d}var O=a.lines*m,j=Math.ceil((h-O)/2);switch(j<0&&(j=0),S){case Te:break;case Me:c+=j;break;case Be:c+=2*j}var L=(m-D)/2,A=m/2,R=function(t){var e=o.measureText(t),i=e.actualBoundingBoxDescent,a=void 0===i?0:i,n=e.actualBoundingBoxAscent;return S==Te?{fix:W?void 0===n?0:n:A-L/2,lineY:W?0:L-L/2}:S==Me?{fix:W?A+a/4:A,lineY:W?0:L}:S==Be?{fix:W?m-a:A+L/2,lineY:W?2*L:L+L/2}:{fix:0,height:0,lineY:0}},E=function(t,e,i){var n=t;switch(_){case We:n+=i;break;case Oe:n=(t-=i/2)+i;break;case je:n=t,t-=i}if(z){o.setLineWidth(g/13),o.beginPath();var s=.1*a.fontHeight;/\bunderline\b/.test(z)&&(o.moveTo(t,e+a.fontHeight+s),o.lineTo(n,e+a.fontHeight+s)),/\boverline\b/.test(z)&&(o.moveTo(t,e-s),o.lineTo(n,e-s)),/\bline-through\b/.test(z)&&(o.moveTo(t,e+.5*a.fontHeight),o.lineTo(n,e+.5*a.fontHeight)),o.closePath(),o.setStrokeStyle(f),o.stroke()}},V=function(t,e,i){var a=function(){o.setLineWidth(k.width),o.setStrokeStyle(k.color),o.strokeText(t,e,i)},s="outset";k&&k.type!==s?(o.save(),n.setShadow({boxShadow:P}),o.fillText(t,e,i),o.restore(),a()):k&&k.type==s?(o.save(),n.setShadow({boxShadow:P}),a(),o.restore(),o.save(),o.fillText(t,e,i),o.restore()):(n.setShadow({boxShadow:P}),o.fillText(t,e,i))};if(!a.widths||1==a.widths.length&&a.widths[0].total+w<=r.width){var H=R(t),U=H.fix,N=void 0===U?0:U,q=H.lineY;return V(t,l+w,c+N),E(l+w,c+q,a&&a.widths&&a.widths[0].total||a.text),c+=m,o.restore(),void this.setBorder(e,i)}for(var Y=c,J=l,G="",X=0,Q=o.measureText("...").width,Z=a.widths,K=0;K<Z.length;K++){var tt=Z[K].widths,et=0;G="",c+=1==(X+=1)?0:m,1==X&&w&&(et=w,J=l+w);for(var it=0;it<tt.length;it++){1!==X&&w&&(J=l);var at=tt[it],nt=at.width,ot=at.text,st=(tt[it+1]||{}).width;if(G+=ot,(et+=nt)+(void 0===st?0:st)+(0==X?w:0)+(X==F?Q:0)>r.width){X>=F&&(G+="…"),X++,et=0;var rt=R(G);N=rt.fix,q=rt.lineY,V(G,J,c+N),E(J,c+q,et),c+=m,G=""}else if(it==tt.length-1){K!=Z.length-1&&X==F&&Q+et<r.width&&(G+="…");var lt=R(G);N=lt.fix,q=lt.lineY,V(G,J,c+N),E(J,c+q,et)}if(c>Y+h||X>F)break}}o.restore()}},t.prototype.source=function(t){return $t(this,void 0,void 0,(function(){var e,i,a,n,o=this;return Pt(this,(function(s){switch(s.label){case 0:if(this.node=null,e=+new Date,"{}"==JSON.stringify(t))return[2];if(!t.type)for(i in t.type=De,t.styles=t.styles||t.css||{},t)["views","children","type","css","styles"].includes(i)||(t.styles[i]=t[i],delete t[i]);return t.styles.boxSizing||(t.styles.boxSizing="border-box"),[4,this.create(t)];case 1:return(a=s.sent())?(n=a.layout()||{},this.size=n,this.node=a,this.onEffectFinished().then((function(t){return o.lifecycle("onEffectSuccess",t)})).catch((function(t){return o.lifecycle("onEffectFail",t)})),this.performance&&console.log("布局用时："+(+new Date-e)+"ms"),[2,this.size]):[2,console.warn("no node")]}}))}))},t.prototype.getImageInfo=function(t){return this.imageBus[t]||(this.imageBus[t]=this.createImage(t,this.useCORS)),this.imageBus[t]},t.prototype.create=function(t,e){return $t(this,void 0,void 0,(function(){function i(t,e,a){void 0===e&&(e={}),void 0===a&&(a=!0);var n=[];return t.forEach((function(t){var o,s=t.styles,r=void 0===s?{}:s,l=t.children,c=void 0===l?[]:l,d=t.text,h=void 0===d?"":d,u=t.type,p=void 0===u?"":u;o=Ft(a?Ft({},e):{},r);var f={},m={},g={};if(Object.keys(o).map((function(t){if(t.includes("padding")||t.includes("margin")){var e=function(t,e){var i,a,n,o,s=[o=(n=t).match(/([a-z]+)/)[1],pe(n.split(o)[1])],r=s[0],l=s[1],c=e.split(" ");if(l)return(i={})[r+l]=e,i;if(c.length&&!l){var d=c[0],h=c[1],u=c[2],p=c[3];return(a={})[r+Tt[0]]=d,a[r+Tt[1]]=h||d,a[r+Tt[2]]=u||d,a[r+Tt[3]]=p||h||d,a}}(t,o[t]);Object.keys(e).map((function(t){t.includes("Left")?m[t]=e[t]:t.includes("Right")?g[t]=e[t]:f[t]=e[t]}))}})),o.textIndent&&(m.textIndent=o.textIndent,delete e.textIndent),""!==h){var b=Array.from(h);b.forEach((function(t,e){var i=Object.assign({},o,f);0===e?Object.assign(i,m):e==b.length-1&&Object.assign(i,g),delete i.padding,delete i.margin,n.push({type:"text",text:t,styles:i})}))}if(p==$e||p==ze)n.push(t);else if("block"===r.display&&c.length>0){var y=i(c,o,!1);t.children=y,t.flattened=!0,n.push(t)}else c.length>0&&(y=i(c,o,a),n=n.concat(y))})),n}var a,n,o,s,r,l,c,d,h,u,p,f,m,g,b,y,v,x,w,_,k;return Pt(this,(function(I){switch(I.label){case 0:if(!t)return[2];if(t.styles||(t.styles=t.css||{}),a=t.type,n=a==$e,o=[Pe,ze].includes(a),s="textBox"==a,r=t.styles||{},l=r.backgroundImage,c=r.display,n&&!t.src&&!t.url)return[2];if("none"==c)return[2];if(o||s){if(d=t.children,!t.text&&(!d||d&&!d.length))return[2];d&&d.length&&!t.flattened&&(h=i(t.children),t.type="view",t.children=h)}if(!(n||t.type==De&&l))return[3,4];u=n?t.src:"",p=/url\((.+)\)/.exec(l),l&&p&&p[1]&&(u=p[1]||""),I.label=1;case 1:return I.trys.push([1,3,,4]),[4,this.getImageInfo(u)];case 2:return f=I.sent(),m=f.width,g=f.height,!(b=f.path)&&n?[2]:(b&&(t.attributes=Object.assign(t.attributes||{},{width:m,height:g,path:b,src:b,naturalSrc:u})),[3,4]);case 3:return y=I.sent(),t.type!=De?[2]:(this.lifecycle("onEffectFail",Ft(Ft({},y),{src:u})),[3,4]);case 4:if(this.count+=1,v=new Ce(t,e,this.root,this.ctx),!(x=t.views||t.children))return[3,8];w=0,I.label=5;case 5:return w<x.length?(_=x[w],[4,this.create(_,v)]):[3,8];case 6:(k=I.sent())&&v.add(k),I.label=7;case 7:return w++,[3,5];case 8:return[2,v]}}))}))},t.prototype.drawNode=function(t,e){return void 0===e&&(e=!1),$t(this,void 0,void 0,(function(){var i,a,n,o,s,r,l,c,d,h,u,p,f,m,g,b,y,v,x,w,_,k,I;return Pt(this,(function(S){switch(S.label){case 0:return i=t.layoutBox,a=t.computedStyle,n=t.attributes,o=t.name,s=t.children,r=t.fixedLine,l=t.attributes,c=l.src,d=l.text,h=a.position,u=a.backgroundImage,p=a.backgroundRepeat,["fixed"].includes(h)&&!e?[2]:(this.ctx.save(),o!==De?[3,7]:c&&u?p?[4,this.drawPattern(n,i,a)]:[3,2]:[3,5]);case 1:return S.sent(),[3,4];case 2:return[4,this.drawImage(n,i,a,!1)];case 3:S.sent(),S.label=4;case 4:return[3,6];case 5:this.drawView(i,a),S.label=6;case 6:return[3,10];case 7:return o===$e&&c?[4,this.drawImage(n,i,a,!1)]:[3,9];case 8:return S.sent(),[3,10];case 9:o===Pe?this.drawText(d,i,a,n):o===ze&&Fe.api&&Fe.api.draw(d,this,i,a),S.label=10;case 10:if(this.progress+=1,m=(f=r||{}).beforeElements,g=f.afterElements,!m)return[3,14];b=0,y=m,S.label=11;case 11:return b<y.length?(I=y[b],[4,this.drawNode(I)]):[3,14];case 12:S.sent(),S.label=13;case 13:return b++,[3,11];case 14:if(!s)return[3,18];v=Object.values?Object.values(s):Object.keys(s).map((function(t){return s[t]})),x=0,w=v,S.label=15;case 15:return x<w.length?"absolute"===(I=w[x]).computedStyle.position?[3,17]:[4,this.drawNode(I)]:[3,18];case 16:S.sent(),S.label=17;case 17:return x++,[3,15];case 18:if(!g)return[3,22];_=0,k=g,S.label=19;case 19:return _<k.length?(I=k[_],[4,this.drawNode(I)]):[3,22];case 20:S.sent(),S.label=21;case 21:return _++,[3,19];case 22:return this.ctx.restore(),[2]}}))}))},t.prototype.render=function(t){var e=this;return void 0===t&&(t=30),new Promise((function(i,a){return $t(e,void 0,void 0,(function(){var e,n,o,s,r,l,c,d,h,u;return Pt(this,(function(p){switch(p.label){case 0:return e=+new Date,this.init(),[4,(f=t,void 0===f&&(f=0),new Promise((function(t){return setTimeout(t,f)})))];case 1:p.sent(),p.label=2;case 2:if(p.trys.push([2,14,,15]),!this.node)return[3,12];if(n=this.root.fixedLine||{},o=n.beforeElements,s=n.afterElements,!o)return[3,6];r=0,l=o,p.label=3;case 3:return r<l.length?(h=l[r],[4,this.drawNode(h,!0)]):[3,6];case 4:p.sent(),p.label=5;case 5:return r++,[3,3];case 6:return[4,this.drawNode(this.node)];case 7:if(p.sent(),!s)return[3,11];c=0,d=s,p.label=8;case 8:return c<d.length?(h=d[c],[4,this.drawNode(h,!0)]):[3,11];case 9:p.sent(),p.label=10;case 10:return c++,[3,8];case 11:return i(this.node),[3,13];case 12:this.lifecycle("onEffectFail","node is empty"),p.label=13;case 13:return[3,15];case 14:return u=p.sent(),this.lifecycle("onEffectFail",u),a(u),[3,15];case 15:return this.performance&&console.log("渲染用时："+(+new Date-e-30)+"ms"),[2]}var f}))}))}))},t.prototype.onEffectFinished=function(){var t=this,e=Object.keys(this.imageBus).map((function(e){return t.imageBus[e]}));return Promise.all(e)},t.prototype.destroy=function(){this.node=[]},t.prototype.save=function(t){try{var e=t||{},i=e.fileType,a=void 0===i?"png":i,n=e.quality,o=void 0===n?1:n;return this.canvas.toDataURL("image/"+a,o)}catch(s){return this.lifecycle("onEffectFail","image cross domain"),s}},t}();zt.WEB==Yt&&(window.Painter=Le);const Ae=U({name:"lime-painter",mixins:[bt,ht("painter"),{}],data:()=>({use2dCanvas:!1,canvasHeight:150,canvasWidth:null,parentWidth:0,inited:!1,progress:0,firstRender:0,done:!1}),computed:{styles(){return`${this.size}${this.customStyle||""};`+(this.hidden&&"position: fixed; left: 1500rpx;")},canvasId(){return`l-painter${this._&&this._.uid||this._uid}`},size(){if(this.boardWidth&&this.boardHeight)return`width:${this.boardWidth}px; height: ${this.boardHeight}px;`},dpr(){return this.pixelRatio||$().pixelRatio},boardWidth(){const{width:t=0}=this.elements&&this.elements.css||this.elements||this,e=It(t||this.width);return e||Math.max(e,It(this.canvasWidth))},boardHeight(){const{height:t=0}=this.elements&&this.elements.css||this.elements||this,e=It(t||this.height);return e||Math.max(e,It(this.canvasHeight))},hasBoard(){return this.board&&Object.keys(this.board).length},elements(){return this.hasBoard?this.board:JSON.parse(JSON.stringify(this.el))}},created(){this.use2dCanvas="2d"===this.type&&!1},async mounted(){await vt(30),await this.getParentWeith(),this.$nextTick((()=>{setTimeout((()=>{this.$watch("elements",this.watchRender,{deep:!0,immediate:!0})}),30)}))},unmounted(){this.done=!1,this.inited=!1,this.firstRender=0,this.progress=0,this.painter=null,clearTimeout(this.rendertimer)},methods:{async watchRender(t,e){t&&t.views&&(this.firstRender?this.firstRender:t.views.length)&&Object.keys(t).length&&JSON.stringify(t)!=JSON.stringify(e)&&(this.firstRender=1,this.progress=0,this.done=!1,clearTimeout(this.rendertimer),this.rendertimer=setTimeout((()=>{this.render(t)}),this.beforeDelay))},async setFilePath(t,e){let i=t;const{pathType:a=this.pathType}=e||this;var n;return"base64"!=a||yt(t)?"url"==a&&yt(t)&&(i=await(n=t,new Promise(((t,e)=>{let i=n.split(",")[0].split(":")[1].split(";")[0],a=atob(n.split(",")[1]),o=new ArrayBuffer(a.length),s=new Uint8Array(o);for(let n=0;n<a.length;n++)s[n]=a.charCodeAt(n);t(URL.createObjectURL(new Blob([s],{type:i})))})))):i=await St(t),e&&e.isEmit&&this.$emit("success",i),i},async getSize(t){const{width:e}=t.css||t,{height:i}=t.css||t;this.size||(e||i?(this.canvasWidth=e||this.canvasWidth,this.canvasHeight=i||this.canvasHeight,await vt(30)):await this.getParentWeith())},canvasToTempFilePathSync(t){this.stopWatch&&this.stopWatch(),this.stopWatch=this.$watch("done",(e=>{e&&(this.canvasToTempFilePath(t),this.stopWatch&&this.stopWatch())}),{immediate:!0})},getParentWeith(){return new Promise((t=>{M().in(this).select(".lime-painter").boundingClientRect().exec((e=>{const{width:i,height:a}=e[0]||{};this.parentWidth=Math.ceil(i||0),this.canvasWidth=this.parentWidth||300,this.canvasHeight=a||this.canvasHeight||150,t(e[0])}))}))},async render(t={}){if(!Object.keys(t).length)return console.error("空对象");this.progress=0,this.done=!1,await this.getSize(t);const e=await this.getContext();let{use2dCanvas:i,boardWidth:a,boardHeight:n,canvas:o,afterDelay:s}=this;if(i&&!o)return Promise.reject(new Error("canvas 没创建"));if(this.boundary={top:0,left:0,width:a,height:n},this.painter=null,!this.painter){const{width:i}=t.css||t;t.css,!i&&this.parentWidth&&Object.assign(t,{width:this.parentWidth});const s={context:e,canvas:o,width:a,height:n,pixelRatio:this.dpr,useCORS:this.useCORS,createImage:Ct.bind(this),performance:this.performance,listen:{onProgress:t=>{this.progress=t,this.$emit("progress",t)},onEffectFail:t=>{this.$emit("faill",t)}}};this.painter=new Le(s)}const{width:r,height:l}=await this.painter.source(JSON.parse(JSON.stringify(t)));return this.boundary.height=this.canvasHeight=l,this.boundary.width=this.canvasWidth=r,await vt(this.sleep),await this.painter.render(),await new Promise((t=>this.$nextTick(t))),i||await this.canvasDraw(),s&&i&&await vt(s),this.$emit("done"),this.done=!0,this.isCanvasToTempFilePath&&this.canvasToTempFilePath().then((t=>{this.$emit("success",t.tempFilePath)})).catch((t=>{this.$emit("fail",new Error(JSON.stringify(t)))})),Promise.resolve({ctx:e,draw:this.painter,node:this.node})},canvasDraw(t=!1){return new Promise(((e,i)=>this.ctx.draw(t,(()=>setTimeout((()=>e()),this.afterDelay)))))},async getContext(){if(!this.canvasWidth)return this.$emit("fail","painter no size"),console.error("[lime-painter]: 给画板或父级设置尺寸"),Promise.reject();if(this.ctx&&this.inited)return Promise.resolve(this.ctx);const{type:t,use2dCanvas:e,dpr:i,boardWidth:a,boardHeight:n}=this,o=()=>new Promise((t=>{M().in(this).select(`#${this.canvasId}`).boundingClientRect().exec((e=>{if(e){const i=W(this.canvasId,this);if(this.inited||(this.inited=!0,this.use2dCanvas=!1,this.canvas=e),!i.measureText){let t=function(t){let e=0;for(let i=0;i<t.length;i++)t.charCodeAt(i)>0&&t.charCodeAt(i)<128?e++:e+=2;return e};i.measureText=e=>{let a=i.state&&i.state.fontSize||12;const n=i.__font;return n&&12==a&&(a=parseInt(n.split(" ")[3],10)),a/=2,{width:t(e)*a}}}this.ctx=i,t(this.ctx)}else console.error("[lime-painter] no node")}))}));return e?new Promise((e=>{M().in(this).select(`#${this.canvasId}`).node().exec((i=>{let{node:a}=i&&i[0]||{};if(a){const i=a.getContext(t);this.inited||(this.inited=!0,this.use2dCanvas=!0,this.canvas=a),this.ctx=i,e(this.ctx)}else console.error("[lime-painter]: no size")}))})):o()},canvasToTempFilePath(t={}){return new Promise((async(e,i)=>{const{use2dCanvas:a,canvasId:n,dpr:o,fileType:s,quality:r}=this;this.boundary;const l=Object.assign({canvasId:n,id:n,fileType:s,quality:r},t,{success:async i=>{try{const a=await this.setFilePath(i.tempFilePath||i,t),n=Object.assign(i,{tempFilePath:a});t.success&&t.success(n),e(n)}catch(a){this.$emit("fail",a)}}});if(a){l.canvas=this.canvas;try{const i=this.canvas.toDataURL(`image/${t.fileType||s}`.replace(/pg/,"peg"),t.quality||r);if(/data:,/.test(i))B(l,this);else{const a=await this.setFilePath(i,t);t.success&&t.success({tempFilePath:a}),e({tempFilePath:a})}}catch(c){t.fail&&t.fail(c),i(c)}}else B(l,this)}))}}},[["render",function(t,e,i,a,n,l){const d=O,h=_;return o(),s(h,{class:"lime-painter",ref:"limepainter"},{default:r((()=>[l.canvasId&&l.size?(o(),s(h,{key:0,style:c(l.styles)},{default:r((()=>[n.use2dCanvas?(o(),s(d,{key:0,class:"lime-painter__canvas",id:l.canvasId,type:"2d",style:c(l.size)},null,8,["id","style"])):(o(),s(d,{key:1,class:"lime-painter__canvas","canvas-id":l.canvasId,style:c(l.size),id:l.canvasId,width:l.boardWidth*l.dpr,height:l.boardHeight*l.dpr,hidpi:t.hidpi},null,8,["canvas-id","style","id","width","height","hidpi"]))])),_:1},8,["style"])):u("",!0),F(t.$slots,"default",{},void 0,!0)])),_:3},512)}],["__scopeId","data-v-b590c84e"]]);var Re,Ee;const Ve=x();const He=U({data:()=>({imgVersion:Ve.globalData.imgVersion,masterDomain:Ve.globalData.masterDomain,userInfo:Ve.globalData.userInfo,userError:Ve.globalData.userError,webMini:Ve.globalData.webMini,webdyMini:Ve.globalData.webdyMini,imgPath:`${Ve.globalData.imgPath}/tieba`,imgStaticPath:`${Ve.globalData.imgStaticPath}/poster`,appConfig:{},wh:Ve.globalData.navTop,moldConfig:Ve.globalData.moduleConfig.tieba||{},detail:{louzu:""},sponsorList:[],zanList:[],zanPageInfo:{},commentList:[],totalComment:0,mold:"tieba",page:1,pageSize:5,pageId:0,shareLink:"",activeIndex_1:0,activeIndex_2:0,tabTop:0,tabDom:[],dotleft:0,pubMycomment:"",recallItem:{id:"",name:"",text:"",recallb:!1,index:-1,item:{},textMy:""},commentDis:-1,posterImg:"",postCode:"",postWx:"",warningb:!1,info:"",complainb:!1,complainInfo:{},loadImage:{},complainList:["垃圾广告","色情淫秽","政治反动","钓鱼诈骗","网络敲诈","内容侵权","其他"],ajaxb:!1,loadComment:!0,shareb:!1,shareconb:!1,copySuccessb:!1,qrb:!1,qrconb:!1,wxshareb:!1,safarib:!1,sponsorb:!1,recallb:!1,postShow:!1,postExhib:!1,privateb:!1,platForm:Ve.globalData.platForm,appBoolean:!1,Android:!1,pages:{},biasTop:0,shareItem:{web:[{id:1,title:"生成海报",src:`${Ve.globalData.imgPath}/article/poster.png?v=${Ve.globalData.imgVersion}`},{id:2,title:"微信好友",src:`${Ve.globalData.imgPath}/article/wechat.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:3,title:"朋友圈",src:`${Ve.globalData.imgPath}/article/friends.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:4,title:"微博",src:`${Ve.globalData.imgPath}/article/weibo.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:5,title:"QQ好友",src:`${Ve.globalData.imgPath}/article/QQ.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:6,title:"QQ空间",src:`${Ve.globalData.imgPath}/article/QQspace.png?v=${Ve.globalData.imgVersion}`,fn:""}],"mp-weixin":[{id:1,title:"生成海报",src:`${Ve.globalData.imgPath}/article/poster.png?v=${Ve.globalData.imgVersion}`},{id:2,title:"微信好友",src:`${Ve.globalData.imgPath}/article/wechat.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:7,title:"复制链接",src:`${Ve.globalData.imgPath}/article/link.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:10,title:"浏览记录",src:`${Ve.globalData.imgPath}/article/history.png?v=${Ve.globalData.imgVersion}`,fn:""}],"mp-toutiao":[{id:7,title:"复制链接",src:`${Ve.globalData.imgPath}/article/link.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:10,title:"浏览记录",src:`${Ve.globalData.imgPath}/article/history.png?v=${Ve.globalData.imgVersion}`,fn:""}]},shareOperate:[{id:7,title:"复制链接",src:`${Ve.globalData.imgPath}/article/link.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:8,title:"当面扫码",src:`${Ve.globalData.imgPath}/article/2Dcode.png?v=${Ve.globalData.imgVersion}`,fn:""},{id:10,title:"浏览记录",src:`${Ve.globalData.imgPath}/article/history.png?v=${Ve.globalData.imgVersion}`,fn:""}],loadAdv:{mold:"tieba",page:"detail",config:[{title:"贴吧移动端信息流广告",page:"index"},{title:"贴吧移动端详情页内容广告",page:"detail",count:1}]},wxIos:!1,appContent:!1}),onLoad(t){Re=this,Ve.globalData.imgVersion?Re.imgVersion=Ve.globalData.imgVersion:Ve.watchG("imgVersion",(function(t){Re.imgVersion=t})),Ve.watchG("userInfo",(function(t){Re.userInfo=t})),-1==Ve.globalData.wxprivate?Ve.watchG("wxprivate",(function(e){Re.wxprivate=e,e?Re.privateb=!0:Re.onload(t)})):Ve.globalData.wxprivate?Re.privateb=!0:Re.onload(t)},methods:{async onload(t){Ve.watchG("appConfig",(function(t){Re.appConfig=t}));let e=Ve.globalData.userid?"&fromShare="+Ve.globalData.userid:"";switch(Re.platForm){case"web":let i=function(t){window.setupWebViewJavascriptBridge((function(e){e.callHandler("appShare",{platform:t,title:Re.detail.title,url:Re.shareLink,imageUrl:Re.detail.imgGroup[0]||"",summary:Re.detail.content},(function(t){JSON.parse(t)}))}))},a=function(){navigator.share?(Re.shareFn(0),s?Re.safarib=!0:navigator.share({url:Re.shareLink,title:Re.detail.title,text:Re.detail.title})):R({data:`${Re.detail.title} ${Re.shareLink}`,success:t=>{Re.copySuccessb=!0}}),Re.shareconb=!1};Re.appBoolean=window.appBoolean;let n=window.params.get("from");Re.appContent=Boolean("app"==n)&&Re.appBoolean,Re.shareLink=`${window.location.href}${e}`,Re.appBoolean&&window.setupWebViewJavascriptBridge((function(t){t.callHandler("setDragRefresh",{value:"off"},(function(){}))}));let o=navigator.userAgent.toLowerCase(),s=-1!==o.indexOf("safari")&&-1===o.indexOf("browser")&&-1===o.indexOf("android");for(let t=0;t<Re.shareItem.web.length;t++){switch(Re.shareItem.web[t].id){case 1:Re.shareItem.web[t].fn=function(){Re.createPosterFn(0),Re.shareFn(0)};break;case 2:Re.shareItem.web[t].fn=function(){Re.appBoolean?i("weixin"):Ve.globalData.webWeixin?(Re.wxshareb=!0,Re.shareFn(0)):a()};break;case 3:Re.shareItem.web[t].fn=function(){Re.appBoolean?i("timeline"):Ve.globalData.webWeixin?(Re.wxshareb=!0,Re.shareFn(0)):a()};break;case 4:Re.shareItem.web[t].fn=function(){Re.appBoolean?i("weibo"):Re.linkTo(`https://service.weibo.com/share/share.php?url=${encodeURIComponent(Re.shareLink)}`),Re.shareFn(0)};break;case 5:Re.shareItem.web[t].fn=function(){Re.appBoolean?i("qq"):Ve.globalData.webWeixin?(Re.wxshareb=!0,Re.shareFn(0)):a()};break;case 6:Re.shareItem.web[t].fn=function(){Re.appBoolean?i("qzone"):Re.linkTo(`https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=${encodeURIComponent(Re.shareLink)}`),Re.shareFn(0)}}}for(let t=0;t<Re.shareOperate.length;t++){let e=Re.shareOperate[t].id;switch(Re.shareOperate[t],e){case 7:Re.shareOperate[t].fn=Re.copyShareFn;break;case 8:Re.shareOperate[t].fn=function(){Re.qrCodeFn(1)};break;case 10:Re.shareOperate[t].fn=function(){Re.linkTo(`${Ve.globalData.appConfig.cfg_user_index}/history?module=tieba`)}}}break;case"mp-weixin":Re.wxIos="ios"==$().platform,Re.biasTop=Ve.globalData.biasTop_88,Re.tabTop=Re.wh+Re.biasTop+P(88),Re.shareLink=`${Re.masterDomain}/tieba/detail?id=${t.id}${e}`;for(let t=0;t<Re.shareItem["mp-weixin"].length;t++){let e=Re.shareItem["mp-weixin"][t].id;switch(Re.shareItem["mp-weixin"][t],e){case 1:Re.shareItem["mp-weixin"][t].fn=function(){Re.createPosterFn(0),Re.shareFn(0)};break;case 7:Re.shareItem["mp-weixin"][t].fn=Re.copyShareFn;break;case 10:Re.shareItem["mp-weixin"][t].fn=function(){Re.linkTo(`${Ve.globalData.appConfig.cfg_user_index}/history?module=tieba`)}}}break;case"mp-toutiao":Re.shareLink=`${Re.masterDomain}/tieba/detail?id=${t.id}${e}`;for(let t=0;t<Re.shareItem["mp-toutiao"].length;t++){let e=Re.shareItem["mp-toutiao"][t].id;switch(Re.shareItem["mp-toutiao"][t],e){case 7:Re.shareItem["mp-toutiao"][t].fn=Re.copyShareFn;break;case 10:Re.shareItem["mp-toutiao"][t].fn=function(){Re.linkTo(`${Ve.globalData.appConfig.cfg_user_index}/history?module=tieba`)}}}}Re.pages=Ve.pageFn(Y),"{}"==JSON.stringify(Re.moldConfig)&&await Re.configData(),Re.pageId=t.id,Re.complainInfo={service:"member",template:"complain",module:"tieba",dopost:"detail",aid:t.id},await Re.detailData(),Re.sponsorData(),Re.zanData(),Re.commentData(!1),Ve.getdomFn(Re,".tr-item",(t=>{Re.tabDom=t}))},async detailData(){let t={service:"tieba",action:"detail",id:Re.pageId},e=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:t});if(100==e.data.state){Re.detail=e.data.info,Re.$nextTick((t=>{j({scrollTop:0,duration:0})})),Re.detail.content.includes(".php?")&&(Re.detail.content=Re.detail.content.replace(/"[/]include[/]attachment.php[?]f=/g,`"${Re.masterDomain}/include/attachment.php?f=`));let t=Re.detail.click;Re.detail.click=t>1e4?Math.floor(t/1e3)/10+"万":t,Re.detail.posterArr=Re.posterProcess(Re.detail.content),Re.detail.pubdate=Re.timestampToTime(Re.detail.pubdate),L({title:Re.detail.title}),console.log(`imgUrl:${Re.detail.imgGroup[0]||Re.moldConfig.sharePic}`,Re.detail.imgGroup[0],Re.moldConfig.sharePic),Ve.wxShareFn({title:Re.detail.title,link:Re.shareLink,imgUrl:Re.detail.imgGroup[0]||Re.moldConfig.sharePic,description:Re.moldConfig.description}),Re.appBoolean&&!Android&&window.setupWebViewJavascriptBridge((function(t){let e={apptitle:"",share:1,report:1,shareContent:{platform:"all",title:`${Re.detail.title}`,url:`${location.href}&fromShare=${Ve.globalData.userid}`,imageUrl:Re.detail.imgGroup[0]||Re.moldConfig.sharePic,summary:`${Re.detail.content}`}};t.callHandler("initAppConfig",{value:e},(function(t){})),t.callHandler("getAppInfo",{},(function(t){}))}))}else Re.info="信息不存在或已经删除~",setTimeout((t=>{"web"==Re.platForm?location.href=`${Re.masterDomain}${window.pathname}${Re.pages.index}`:A({url:"/pages/packages/tieba/index/index"})}),3e3);Re.commentDis=0},linkTo(t){Ve.linkTo(t,!1,!1)},warnFn(t=2e3){Re.warningb=!0,clearTimeout(Ee),Ee=setTimeout((t=>{Re.warningb=!1}),t)},backFn(){Ve.backFn()},emitConfig(t,e){Re[e]=t},async listFn(t,e=!1){Re.ajaxb=!0;let i=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:t});100==i.data.state?(e?Re.commentList=Re.commentList.concat(i.data.info.list):(Re.commentList=[...i.data.info.list],Re.totalComment=i.data.info.pageInfo.totalCount),Re.loadComment=Boolean(i.data.info.list.length>=Re.pageSize)):Re.loadComment=!1,Re.ajaxb=!1},async configData(){let t={service:Re.mold,action:"config"},e=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:t});100==e.data.state&&(Re.moldConfig=e.data.info,Ve.globalData.moduleConfig.tieba=e.data.info)},async sponsorData(){let t={service:"tieba",action:"rewardList",aid:Re.pageId},e=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:t});100==e.data.state&&(Re.sponsorList=e.data.info.list.splice(0,6))},async zanData(){let t={service:"member",action:"upList",type:0,tid:Re.pageId,page:1,pageSize:10,temp:"detail",module:"tieba"},e=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:t});if(100==e.data.state){Re.zanList=e.data.info.list,Re.zanPageInfo=e.data.info.pageInfo;let t=Re.zanPageInfo.totalCount;Re.zanPageInfo.totalCount=t>1e4?Math.floor(t/1e3)/10+"万":t}},async commentData(t,e){t?++Re.page:Re.page=1;let i={service:"member",action:"getComment",type:"tieba-detail",son:1,uid:1==Re.activeIndex_1?Re.detail.uid:"",orderby:0==Re.activeIndex_2?"hot":1==Re.activeIndex_2?1:"",aid:Re.pageId,page:Re.page,pageSize:Re.pageSize};Re.listFn(i,t)},async operateFn(t){let e,i;if(!Ve.globalData.userid)return Ve.tologin(`${Re.pages.detail}?id=${Re.pageId}`),!1;switch(t){case 0:e={service:"member",action:"followMember",id:Re.detail.uid},i=t=>{Re.detail.isfollow=!Re.detail.isfollow};break;case 1:e={service:"member",action:"collect",id:Re.pageId,module:"tieba",temp:"detail",type:1==Re.detail.collect?"del":"add"},i=t=>{Re.detail.collect=!Re.detail.collect};break;case 2:e={service:"member",action:"getZan",module:"tieba",temp:"detail",title:Re.detail.title,id:Re.pageId,uid:Ve.globalData.userid},i=t=>{Re.detail.zan=!Re.detail.zan}}let a=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:e});100==a.data.state?i():Re.info=a.data.info},shareFn(t){1==t?(Re.shareb=!0,setTimeout((t=>{Re.shareconb=!0}),0)):(this.copySuccessb=!1,Re.shareconb=!1,setTimeout((t=>{Re.shareb=!1}),200))},qrCodeFn(t){0==t?(Re.qrconb=!1,setTimeout((t=>{Re.qrb=!1}),220)):(Re.qrb=!0,setTimeout((t=>{Re.qrconb=!0}),0))},copyShareFn(){Re.shareFn(0),R({data:Re.shareLink,fail:t=>{Re.info="复制失败！"}})},tabFn(t,e){if("activeIndex_2"==t){let t=Re.tabDom;Re.dotleft+=t[e].left-t[Re.activeIndex_2].left}Re.commentList=[],Re[t]=e,Re.commentData(!1,!0)},async commentFn(t,e){let i,a;if(!Ve.globalData.userid)return Ve.tologin(`${Re.pages.detail}?id=${Re.pageId}`),!1;"replay"==t?(i={service:"member",action:"replyComment",check:1,id:Re.recallItem.id,content:e||Re.recallItem.text},a="回复"):(i={service:"member",action:"sendComment",check:1,type:"tieba-detail",aid:Re.pageId,content:Re.pubMycomment},a="评论");let n=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:i});Re.info=`${a}${100==n.data.state?"成功，等待审核":"失败"}`,"replay"==t?(Re.recallItem.text="",Re.recallItem.textMy="",Re.recallb=!1):Re.pubMycomment=""},async commentZanFn(t,e){if(!Ve.globalData.userid)return Ve.tologin(`${Re.pages.detail}?id=${Re.pageId}`),!1;let i="replay"==e?Re.commentList[Re.recallItem.index].lower.list[t]:Re.commentList[t],a={service:"member",action:"dingComment",id:i.id,type:1==i.zan_has?"del":"add"},n=await Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:a});100==n.data.state?(i.zan_has=!i.zan_has,i.zan_has?++i.zan:--i.zan):Re.info=n.data.info},recallPopFn(t){t>=0?(Re.recallItem.index=t,Re.recallItem.item=Re.commentList[t],setTimeout((t=>{Re.recallItem.recallb=!0}),0)):(Re.recallItem.recallb=!1,setTimeout((t=>{Re.recallItem.index=-1}),200))},scrollCommentFn(){let t=Re.commentDis;0==t?Ve.getdomFn(Re,".a-user,.commentArea",(t=>{Re.commentDis=t[1].top-t[0].top,j({scrollTop:Re.commentDis,duration:100})})):-1!=t&&j({scrollTop:t,duration:100})},posterProcess:t=>Ve.posterProcess(t),savePosterFn(){Re.appBoolean&&(a({title:"海报压缩中"}),Ve.compressImg(Re.posterImg,(t=>{n(),E("huoniao_poster",t),window.setupWebViewJavascriptBridge((function(t){t.callHandler("saveImage",{value:"huoniao_poster"},(function(){}))}))})))},createPosterFn(t,e){if(Re.posterImg&&1!=t)Re.postShow=!0;else if(0==t){a({title:"海报生成中"}),Re.postShow=!0,Re.ajaxb=!0;let t={service:"siteConfig",action:"getWeixinQrPost",module:"tieba",type:"detail",aid:Re.detail.id,title:Re.detail.title,description:Re.detail.content,imgUrl:Re.detail.imgGroup[0]||Re.moldConfig.sharePic,link:Re.shareLink};Re.$ajax.post({url:Ve.encodeUrl("include/ajax.php?"),data:t}).then((t=>{100==t.data.state?t.data.info.includes("https")?Re.postWx=t.data.info:t.data.info.includes("http")?Re.postCode=t.data.info:Re.postCode=Re.shareLink:Re.postCode=Re.shareLink,Re.ajaxb=!1}))}else Re.ajaxb||(n(),Re.postExhib=!0,Re.posterImg=e)},timestampToTime(t){const e=Ve.dateFormatter(t);return e.year+"."+(e.month+".")+(e.day+" ")+(e.hour+":")+e.minute},sponsorSuccess:t=>(Re.sponsorData(),Re.detail.rewardcount++,1),sponsorFn(){let t=Re.detail.uid;Re.userInfo.userid==t?Re.info="自己无法赞赏自己哦！":Re.sponsorb=!0}},watch:{info(t,e){""!=t&&(Re.warnFn(),setTimeout((t=>{Re.info=""}),2200))}},onPullDownRefresh(){Ve.reloadFn()},onShareAppMessage:t=>({title:Re.detail.title,desc:Re.moldConfig.description}),onShareTimeline:()=>({title:Re.detail.title,imageUrl:Re.detail.imgGroup[0]||Re.moldConfig.sharePic})},[["render",function(t,e,i,a,n,y){const v=N(I("mp-html"),J),x=k,F=_,$=N(I("webTop"),G),P=w,z=S,D=C,T=H,M=N(I("sponsor"),ot),B=N(I("complain"),ct),W=N(I("popWarn"),q),O=N(I("l-painter-image"),pt),j=N(I("l-painter-text"),ft),L=N(I("l-painter-view"),mt),A=N(I("l-painter-qrcode"),gt),R=N(I("l-painter"),Ae),E=N(I("private_tip"),X);return o(),s(F,null,{default:r((()=>[n.appContent?(o(),s(F,{key:0},{default:r((()=>[l(v,{content:n.detail.content,adv:n.loadAdv,selectable:!0,class:"a-text"},null,8,["content","adv"]),l(x,{class:"appBlank"},{default:r((()=>[d(" ")])),_:1})])),_:1})):(o(),s(F,{key:1,class:"Shell",style:c(`padding-top:${n.tabTop}px`)},{default:r((()=>["web"!=n.platForm||n.webMini||n.appBoolean||n.webdyMini?"mp-weixin"==n.platForm?(o(),s(F,{key:1,class:"navTop center",style:c(`padding-top:calc(${n.wh+n.biasTop}px);`)},{default:r((()=>[l(F,{class:"n-back",onClick:y.backFn},{default:r((()=>[l(P,{src:`${n.masterDomain}/static/images/header_back.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1},8,["onClick"]),l(x,null,{default:r((()=>[d(h("帖子正文"))])),_:1})])),_:1},8,["style"])):u("",!0):(o(),s($,{key:0,title:"帖子正文",class:"webTop",module:n.mold,needPoster:!0,index:!1,onPoster:e[0]||(e[0]=t=>y.createPosterFn(0))},null,8,["module"])),l(F,{style:{"background-color":"white"}},{default:r((()=>[l(F,{class:"a-user"},{default:r((()=>[l(P,{src:n.detail.louzu.photo||n.userError,mode:"aspectFill",class:b(["au-picture",{loadingImg:!n.loadImage[n.detail.louzu.photo]}]),onLoad:e[1]||(e[1]=t=>n.loadImage[n.detail.louzu.photo]=!0),onError:e[2]||(e[2]=t=>n.detail.louzu.photo=n.userError)},null,8,["src","class"]),l(F,{class:"au-info"},{default:r((()=>[l(F,{class:"aui-info"},{default:r((()=>[l(F,{class:"title"},{default:r((()=>[d(h(n.detail.louzu.nickname),1)])),_:1}),l(F,{class:"details"},{default:r((()=>[l(F,{class:"time"},{default:r((()=>[d(h(n.detail.pubdate)+h(n.detail.iphome&&` · ${n.detail.iphome}`||""),1)])),_:1})])),_:1})])),_:1}),n.detail.uid!=n.userInfo.userid?(o(),p(f,{key:0},[0==n.detail.isfollow?(o(),s(F,{key:0,class:"aui-btn",onClick:e[3]||(e[3]=t=>y.operateFn(0))},{default:r((()=>[l(P,{src:`${n.imgPath}/addWhite.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d("关注")])),_:1})])),_:1})):(o(),s(F,{key:1,class:"aui-has",onClick:e[4]||(e[4]=t=>y.operateFn(0))},{default:r((()=>[d("已关注")])),_:1}))],64)):u("",!0)])),_:1})])),_:1}),l(F,{class:"articleText"},{default:r((()=>[l(F,{class:"a-title"},{default:r((()=>[d(h(n.detail.title),1)])),_:1}),l(v,{content:n.detail.content,adv:n.loadAdv,selectable:!0,class:"a-text"},null,8,["content","adv"]),l(F,{class:"cutLine"},{default:r((()=>[d("End")])),_:1})])),_:1}),l(F,{class:"operate"},{default:r((()=>[l(F,{class:"o-btn",onClick:e[5]||(e[5]=t=>y.operateFn(1))},{default:r((()=>[l(P,{src:`${n.imgPath}/${n.detail.collect?"heartOrange":"heartBlack"}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d("收藏")])),_:1})])),_:1}),l(F,{class:"o-btn",onClick:e[6]||(e[6]=t=>y.shareFn(1))},{default:r((()=>[l(P,{src:`${n.imgPath}/shareBlack.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d("分享")])),_:1})])),_:1}),l(F,{class:"o-btn",onClick:e[7]||(e[7]=t=>y.operateFn(2))},{default:r((()=>[l(P,{src:`${n.imgPath}/zan${1==n.detail.zan?2:4}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d("点赞")])),_:1})])),_:1})])),_:1}),0==n.moldConfig.rewardSwitch&&0==n.appConfig.cfg_iosVirtualPaymentState?(o(),s(F,{key:0,class:"a-sponsor"},{default:r((()=>[l(F,{class:"as-btn",onClick:y.sponsorFn},{default:r((()=>[l(P,{src:`${n.imgPath}/diamondWhite.png?v=${n.imgVersion}`,mode:"aspectFit",class:"icon"},null,8,["src"]),l(x,null,{default:r((()=>[d("赞赏")])),_:1})])),_:1},8,["onClick"]),l(F,{class:"as-people"},{default:r((()=>[n.sponsorList.length>0?(o(),s(F,{key:0,class:"list"},{default:r((()=>[(o(!0),p(f,null,m(n.sponsorList,((t,e)=>(o(),s(F,{class:"item",key:e,style:c(`z-index:${e};margin-left:-${0==e?0:20}rpx`)},{default:r((()=>[l(P,{src:t.photo||n.userError,class:b([{loadingImg:!n.loadImage[t.photo]}]),onLoad:e=>n.loadImage[t.photo]=!0,mode:"aspectFill",onError:e=>t.photo=n.userError},null,8,["src","class","onLoad","onError"])])),_:2},1032,["style"])))),128))])),_:1})):u("",!0),l(F,{class:"text"},{default:r((()=>[d(h(0==n.sponsorList.length?"觉得内容不错就支持一下吧":`${n.sponsorList[0].username}${1==n.sponsorList.length?"":`等${n.detail.rewardcount}人`}已赞赏支持`),1)])),_:1})])),_:1})])),_:1})):u("",!0),l(F,{class:"complaint"},{default:r((()=>[l(F,{class:"c-text"},{default:r((()=>[d("免责声明：本平台仅供信息发布交流之途，如遇虚假诈骗等违法信息，请立即举报")])),_:1}),l(F,{class:"c-btn",onClick:e[8]||(e[8]=t=>{n.complainb=!0})},{default:r((()=>[l(P,{src:`${n.imgPath}/ledRed.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d("举报")])),_:1})])),_:1})])),_:1}),l(F,{class:"detailInfo"},{default:r((()=>[l(F,{class:"d-zan"},{default:r((()=>[n.zanPageInfo.totalCount?(o(),s(F,{key:0},{default:r((()=>[d(h(n.zanPageInfo.totalCount)+"点赞",1)])),_:1})):u("",!0),(o(!0),p(f,null,m(n.zanList,((t,e)=>(o(),s(P,{src:t.photo||n.userError,class:b([{loadingImg:!n.loadImage[t.photo]}]),onLoad:e=>n.loadImage[t.photo]=!0,mode:"aspectFit",key:e},null,8,["src","class","onLoad"])))),128))])),_:1}),l(F,{class:"d-browser"},{default:r((()=>[d(h(n.detail.click)+"浏览",1)])),_:1})])),_:1})])),_:1}),l(F,{class:"commentArea"},{default:r((()=>[l(F,{class:"tab"},{default:r((()=>[l(F,{class:"t-left"},{default:r((()=>[l(x,{class:b(0==n.activeIndex_1&&"active"),onClick:e[9]||(e[9]=t=>y.tabFn("activeIndex_1",0))},{default:r((()=>[d("全部回复")])),_:1},8,["class"]),l(x,{class:b(1==n.activeIndex_1&&"active"),onClick:e[10]||(e[10]=t=>y.tabFn("activeIndex_1",1))},{default:r((()=>[d("只看楼主")])),_:1},8,["class"])])),_:1}),l(F,{class:"t-right"},{default:r((()=>[l(F,{class:b(["tr-item",{active:0==n.activeIndex_2}]),onClick:e[11]||(e[11]=t=>y.tabFn("activeIndex_2",0))},{default:r((()=>[d("热门 ")])),_:1},8,["class"]),l(F,{class:b(["tr-item",{active:1==n.activeIndex_2}]),onClick:e[12]||(e[12]=t=>y.tabFn("activeIndex_2",1))},{default:r((()=>[d("正序 ")])),_:1},8,["class"]),l(F,{class:b(["tr-item",{active:2==n.activeIndex_2}]),onClick:e[13]||(e[13]=t=>y.tabFn("activeIndex_2",2))},{default:r((()=>[d("倒序 ")])),_:1},8,["class"]),l(F,{class:"tr-dot",style:c(`left:${n.dotleft}px`)},null,8,["style"])])),_:1})])),_:1}),n.commentList.length>0?(o(),s(F,{key:0,class:"c-comment"},{default:r((()=>[(o(!0),p(f,null,m(n.commentList,((t,e)=>(o(),s(F,{class:"item",key:e,style:c(e!=n.commentList.length-1||n.loadComment?"":"border:0"),onClick:e=>{n.recallb=!0,n.recallItem.id=t.id,n.recallItem.name=t.user.nickname}},{default:r((()=>[l(P,{src:t.user.photo||n.userError,mode:"aspectFill",class:b(["cc-photo",{loadingImg:!n.loadImage[t.user.photo]}]),onLoad:e=>n.loadImage[t.user.photo]=!0,onError:e=>t.user.photo=n.userError},null,8,["src","class","onLoad","onError"]),l(F,{class:"cc-name"},{default:r((()=>[l(F,{class:"user"},{default:r((()=>[l(x,{class:"name"},{default:r((()=>[d(h(t.user.nickname),1)])),_:2},1024),t.user.userid==n.detail.uid?(o(),s(F,{key:0,class:"label"},{default:r((()=>[d("楼主")])),_:1})):u("",!0)])),_:2},1024),l(F,{class:"zan",onClick:g((t=>y.commentZanFn(e)),["stop"])},{default:r((()=>[l(P,{src:`${n.imgPath}/zan${t.zan_has?3:1}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d(h(Number(t.zan)||""),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024),l(F,{class:"cc-content"},{default:r((()=>[l(v,{content:t.content,"container-style":"display:inline"},null,8,["content"])])),_:2},1024),t.lower.count>0?(o(),s(F,{key:0,class:"cc-more"},{default:r((()=>[(o(!0),p(f,null,m(t.lower.list.slice(0,3),((e,i)=>(o(),s(F,{key:i,style:{"padding-top":"22rpx"},onClick:g((t=>{n.recallb=!0,n.recallItem.id=e.id,n.recallItem.name=e.user.nickname}),["stop"])},{default:r((()=>[e.sid!=t.id&&e.reply_to_user.nickname?(o(),s(F,{key:1},{default:r((()=>[l(x,null,{default:r((()=>[l(x,{class:"name"},{default:r((()=>[d(h(e.user.nickname),1)])),_:2},1024),d(" 回复 "),l(x,{class:"name"},{default:r((()=>[d(h(e.reply_to_user.nickname),1)])),_:2},1024),d("： ")])),_:2},1024),l(F,{class:"text"},{default:r((()=>[l(v,{content:e.content,"container-style":"display:inline"},null,8,["content"])])),_:2},1024)])),_:2},1024)):(o(),s(F,{key:0},{default:r((()=>[l(x,{class:"name"},{default:r((()=>[d(h(e.user.nickname)+"： ",1)])),_:2},1024),l(F,{class:"text"},{default:r((()=>[l(v,{content:e.content,"container-style":"display:inline"},null,8,["content"])])),_:2},1024)])),_:2},1024))])),_:2},1032,["onClick"])))),128)),t.lower.count>3?(o(),s(F,{key:0,class:"checkAll",onClick:g((t=>y.recallPopFn(e)),["stop"])},{default:r((()=>[d(" 全部"+h(t.lower.count)+"条回复>",1)])),_:2},1032,["onClick"])):u("",!0)])),_:2},1024)):u("",!0),l(F,{class:"cc-time"},{default:r((()=>[l(x,null,{default:r((()=>[d(h(t.ftime)+" "+h(t.iphome),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128)),n.loadComment?(o(),s(F,{key:0,class:"loadComment",onClick:e[14]||(e[14]=t=>y.commentData(!0))},{default:r((()=>[d("加载更多留言")])),_:1})):u("",!0)])),_:1})):(o(),s(F,{key:1,class:"c-blank"},{default:r((()=>[l(P,{src:`${n.imgPath}/noData1.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d(h(1==n.activeIndex_1?"楼主太懒，快来戳TA~":"沙发就等你拿下啦！"),1)])),_:1})])),_:1}))])),_:1}),n.recallItem.index>-1?(o(),s(F,{key:2,class:"recall",onClick:e[23]||(e[23]=t=>y.recallPopFn())},{default:r((()=>[l(F,{class:"r-content",onClick:e[22]||(e[22]=g((()=>{}),["stop"])),style:c(`transform:translateY(${n.recallItem.recallb?"0%":"100%"})`)},{default:r((()=>[l(F,{class:"rc-title"},{default:r((()=>[d("回复")])),_:1}),l(F,{class:"item",style:{border:"0"},onClick:e[17]||(e[17]=t=>{n.recallb=!0,n.recallItem.name=n.recallItem.item.user.nickname,n.recallItem.id=n.recallItem.item.id})},{default:r((()=>[l(P,{src:n.recallItem.item.user.photo||n.userError,mode:"aspectFill",class:"rc-photo",onError:e[15]||(e[15]=t=>n.recallItem.item.user.photo=n.userError)},null,8,["src"]),l(F,{class:"rc-name"},{default:r((()=>[l(F,{class:"user"},{default:r((()=>[l(x,{class:"name"},{default:r((()=>[d(h(n.recallItem.item.user.nickname),1)])),_:1}),n.recallItem.item.user.userid==n.detail.uid?(o(),s(F,{key:0,class:"label"},{default:r((()=>[d("楼主")])),_:1})):u("",!0)])),_:1}),l(F,{class:"zan",onClick:e[16]||(e[16]=g((t=>y.commentZanFn(n.recallItem.index)),["stop"]))},{default:r((()=>[l(P,{src:`${n.imgPath}/zan${n.recallItem.item.zan_has?3:1}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d(h(Number(n.recallItem.item.zan)||""),1)])),_:1})])),_:1})])),_:1}),l(F,{class:"rc-content",style:{"max-height":"400rpx",overflow:"auto"}},{default:r((()=>[l(F,{style:{display:"inline","word-break":"break-all"}},{default:r((()=>[l(v,{content:n.recallItem.item.content,"container-style":"display:inline"},null,8,["content"])])),_:1})])),_:1}),l(F,{class:"rc-time"},{default:r((()=>[l(x,null,{default:r((()=>[d(h(n.recallItem.item.ftime)+" "+h(n.recallItem.item.iphome),1)])),_:1})])),_:1})])),_:1}),l(F,{class:"rc-my"},{default:r((()=>[l(P,{src:n.userInfo.photo||n.userError,mode:"aspectFit",onError:e[18]||(e[18]=t=>n.userInfo.photo=n.userError)},null,8,["src"]),l(z,{type:"text",placeholder:n.appConfig.cfg_commentPlaceholder,"placeholder-style":"color:#B3B3B3",modelValue:n.recallItem.textMy,"onUpdate:modelValue":e[19]||(e[19]=t=>n.recallItem.textMy=t),onConfirm:e[20]||(e[20]=t=>y.commentFn("replay",n.recallItem.textMy)),onFocus:e[21]||(e[21]=t=>n.recallItem.id=n.recallItem.item.id)},null,8,["placeholder","modelValue"])])),_:1}),l(F,{style:{"flex-grow":"1","padding-bottom":"env(safe-area-inset-bottom)","overflow-y":"auto"}},{default:r((()=>[l(F,{class:"rc-all"},{default:r((()=>[d("全部回复 · "+h(n.recallItem.item.lower.list.length),1)])),_:1}),(o(!0),p(f,null,m(n.recallItem.item.lower.list,((t,e)=>(o(),s(F,{class:"item",key:e,style:c(e==n.recallItem.item.lower.list?"border:0":""),onClick:e=>{n.recallb=!0,n.recallItem.name=t.user.nickname,n.recallItem.id=t.id}},{default:r((()=>[l(P,{src:t.user.photo||n.userError,mode:"aspectFill",class:"rc-photo",onError:e=>t.user.photo=n.userError},null,8,["src","onError"]),l(F,{class:"rc-name"},{default:r((()=>[l(F,{class:"user"},{default:r((()=>[l(x,{class:"name"},{default:r((()=>[d(h(t.user.nickname),1)])),_:2},1024),t.user.userid==n.detail.uid?(o(),s(F,{key:0,class:"label"},{default:r((()=>[d("楼主")])),_:1})):u("",!0)])),_:2},1024),l(F,{class:"zan",onClick:g((t=>y.commentZanFn(e,"replay")),["stop"])},{default:r((()=>[l(P,{src:`${n.imgPath}/zan${t.zan_has?3:1}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d(h(Number(t.zan)||""),1)])),_:2},1024)])),_:2},1032,["onClick"])])),_:2},1024),l(F,{class:"rc-content"},{default:r((()=>[n.recallItem.item.id!=t.sid&&t.reply_to_user.nickname?(o(),p(f,{key:0},[d(" 回复"),l(x,null,{default:r((()=>[d(h(t.reply_to_user.nickname),1)])),_:2},1024),d("： ")],64)):u("",!0),l(F,{style:{display:"inline","word-break":"break-all"}},{default:r((()=>[l(v,{content:t.content,"container-style":"display:inline"},null,8,["content"])])),_:2},1024)])),_:2},1024),l(F,{class:"rc-time"},{default:r((()=>[l(x,null,{default:r((()=>[d(h(t.ftime)+" "+h(t.iphome),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style","onClick"])))),128))])),_:1})])),_:1},8,["style"])])),_:1})):u("",!0),n.recallb?(o(),s(F,{key:3,class:"recallPop",onClick:e[28]||(e[28]=t=>n.recallb=!1)},{default:r((()=>[l(F,{class:"rp-content",onClick:e[27]||(e[27]=g((()=>{}),["stop"]))},{default:r((()=>[l(D,{rows:"5",placeholder:`回复@${n.recallItem.name}`,"placeholder-style":"color:#B3B3B3;","adjust-position":!0,"always-embed":!0,focus:!0,"cursor-spacing":50,modelValue:n.recallItem.text,"onUpdate:modelValue":e[24]||(e[24]=t=>n.recallItem.text=t),onConfirm:e[25]||(e[25]=t=>y.commentFn("replay"))},null,8,["placeholder","modelValue"]),l(F,{class:"sendMess",onClick:e[26]||(e[26]=t=>y.commentFn("replay"))},{default:r((()=>[d("发送")])),_:1})])),_:1})])),_:1})):u("",!0),l(F,{class:"fixBottom"},{default:r((()=>[l(z,{type:"text",placeholder:n.appConfig.cfg_commentPlaceholder,modelValue:n.pubMycomment,"onUpdate:modelValue":e[29]||(e[29]=t=>n.pubMycomment=t),onConfirm:e[30]||(e[30]=t=>y.commentFn()),"always-embed":!0,"adjust-position":!0,"cursor-spacing":n.wxIos?50:10},null,8,["placeholder","modelValue","cursor-spacing"]),l(F,{onClick:y.scrollCommentFn},{default:r((()=>[l(P,{src:`${n.imgPath}/chatBold.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"]),n.totalComment?(o(),s(x,{key:0},{default:r((()=>[d(h(n.totalComment>99?"99+":n.totalComment),1)])),_:1})):u("",!0)])),_:1},8,["onClick"]),l(F,{onClick:e[31]||(e[31]=t=>y.operateFn(2))},{default:r((()=>[l(P,{src:`${n.imgPath}/zan${n.detail.zan?2:4}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1}),l(F,{onClick:e[32]||(e[32]=t=>y.operateFn(1))},{default:r((()=>[l(P,{src:`${n.imgPath}/${n.detail.collect?"heartOrange":"heartBlack"}.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1})])),_:1}),n.shareb?(o(),s(F,{key:4,class:"sharePop",onClick:e[36]||(e[36]=t=>y.shareFn(0))},{default:r((()=>[l(F,{class:"s-content",style:c(`transform:translateY(${n.shareconb?"0%":"100%"})`),onClick:e[33]||(e[33]=g((()=>{}),["stop"]))},{default:r((()=>[l(F,{class:"sc-title"},{default:r((()=>[d("更多")])),_:1}),n.webdyMini?u("",!0):(o(),s(F,{key:0,class:"sc-way"},{default:r((()=>[(o(!0),p(f,null,m(n.shareItem[n.platForm],((t,e)=>(o(),s(T,{key:e,class:"item",onClick:t.fn,"open-type":"mp-weixin"==n.platForm&&2==t.id&&"share"},{default:r((()=>[l(F,null,{default:r((()=>[l(P,{src:t.src,mode:"aspectFit"},null,8,["src"])])),_:2},1024),l(x,null,{default:r((()=>[d(h(t.title),1)])),_:2},1024)])),_:2},1032,["onClick","open-type"])))),128))])),_:1})),"web"==n.platForm?(o(),s(F,{key:1,class:"sc-operate"},{default:r((()=>[(o(!0),p(f,null,m(n.shareOperate,((t,e)=>(o(),s(F,{key:e,class:"item",onClick:t.fn},{default:r((()=>[l(F,null,{default:r((()=>[l(P,{src:t.src,mode:"aspectFit"},null,8,["src"])])),_:2},1024),l(x,null,{default:r((()=>[d(h(t.title),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})):u("",!0)])),_:1},8,["style"]),n.copySuccessb?(o(),s(F,{key:0,class:"c-warn",onClick:e[35]||(e[35]=g((()=>{}),["stop"]))},{default:r((()=>[l(F,{class:"title"},{default:r((()=>[d("已复制链接")])),_:1}),l(F,{class:"tip"},{default:r((()=>[d("快去粘贴给好友吧")])),_:1}),l(F,{class:"btn",onClick:e[34]||(e[34]=t=>y.shareFn(0))},{default:r((()=>[d("我知道了")])),_:1})])),_:1})):u("",!0)])),_:1})):u("",!0),n.qrb?(o(),s(F,{key:5,class:"qrCode",onClick:e[39]||(e[39]=t=>y.qrCodeFn(0))},{default:r((()=>[l(F,{class:"q-content",style:c(`transform:translateY(${n.qrconb?"0%":"100%"})`),onClick:e[38]||(e[38]=g((()=>{}),["stop"]))},{default:r((()=>[l(F,{class:"qc-img"},{default:r((()=>[l(P,{src:`${n.masterDomain}/include/qrcode.php?data=${n.shareLink}`,mode:"aspectFit"},null,8,["src"]),l(x,null,{default:r((()=>[d("让朋友扫一扫访问当前网页")])),_:1})])),_:1}),l(F,{class:"qc-btn",onClick:e[37]||(e[37]=g((t=>y.qrCodeFn(0)),["stop"]))},{default:r((()=>[d("取消")])),_:1})])),_:1},8,["style"])])),_:1})):u("",!0),n.wxshareb?(o(),s(F,{key:6,class:"wxShare",onClick:e[40]||(e[40]=t=>n.wxshareb=!1)},{default:r((()=>[l(P,{src:`${n.masterDomain}/static/images/HN_Public_sharezhi.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1})):u("",!0),n.safarib?(o(),s(F,{key:7,class:"safari",onClick:e[41]||(e[41]=t=>n.safarib=!1)},{default:r((()=>[l(P,{src:`${n.masterDomain}/static/images/safariShare.png?v=${n.imgVersion}`,mode:"aspectFit"},null,8,["src"])])),_:1})):u("",!0),l(M,{service:"tieba",aid:n.detail.id,sponsorMax:Number(n.moldConfig.rewardLimit),popb:n.sponsorb,sponsorMoney:n.moldConfig.rewardOption,successFn:y.sponsorSuccess,onCloseFn:e[42]||(e[42]=t=>n.sponsorb=!1)},null,8,["aid","sponsorMax","popb","sponsorMoney","successFn"]),l(B,{showPop:n.complainb,infoDetail:n.complainInfo,onHideFn:e[43]||(e[43]=t=>n.complainb=!1),complainList:n.complainList},null,8,["showPop","infoDetail","complainList"]),l(W,{info:n.info,warningb:n.warningb},null,8,["info","warningb"]),n.postShow?(o(),s(F,{key:8},{default:r((()=>[l(R,{isCanvasToTempFilePath:"",onSuccess:e[44]||(e[44]=t=>y.createPosterFn(1,t)),hidden:""},{default:r((()=>[V("template",null,[l(L,{css:"background:white;width:100%;"},{default:r((()=>[l(O,{src:`${n.imgStaticPath}/tieba_bg.png`,css:"width:100%;height:282rpx;position:absolute;top:0rpx;left:0rpx;z-index:-1"},null,8,["src"]),l(L,{css:"padding:100rpx 36rpx 0rpx;position:relative"},{default:r((()=>[l(L,{css:"padding:0rpx 10rpx;"},{default:r((()=>[l(j,{text:n.appConfig.share?n.appConfig.share.title:"",css:"font-weight:bold;color:white;font-size:38rpx;"},null,8,["text"])])),_:1}),l(L,{css:"margin-top:24rpx;"},{default:r((()=>[l(j,{text:n.appConfig.share?n.appConfig.share.description:"",css:"font-weight:500;color:white;font-size:24rpx;opacity:0.8"},null,8,["text"])])),_:1}),l(L,{css:"margin-top:100rpx;"},{default:r((()=>[l(j,{text:n.detail.title,css:"color:#212121;font-weight:bold;font-size:48rpx;display:block;"},null,8,["text"]),l(L,{css:"display:flex;margin-top:24rpx"},{default:r((()=>[l(O,{src:n.detail.louzu.photo||n.userError,css:"width:50rpx;height:50rpx;border-radius:50%;display:block;margin-right:20rpx"},null,8,["src"]),l(j,{text:n.detail.louzu.nickname,css:"font-size:26rpx;color:#A0A0A0;padding-top:10rpx;"},null,8,["text"])])),_:1}),l(L,{css:"max-height:1200rpx;overflow:hidden;line-height:50rpx;position:relative"},{default:r((()=>[(o(!0),p(f,null,m(n.detail.posterArr,((t,e)=>(o(),p(f,{key:e},["text"==t.type?(o(),s(L,{key:0,css:"margin-top:30rpx;"},{default:r((()=>[l(j,{text:t.value,css:"font-weight:500;color:#212121;font-size:32rpx;"},null,8,["text"])])),_:2},1024)):"image"==t.type?(o(),s(O,{key:1,src:t.value,css:"width:100%;margin-top:30rpx;border-radius:6rpx"},null,8,["src"])):"video"==t.type?(o(),s(O,{key:2,src:t.poster,css:"width:100%;margin-top:30rpx"},null,8,["src"])):(o(),s(L,{key:3,css:"width:100%"}))],64)))),128)),l(O,{src:`${n.imgStaticPath}/tranBg.png`,css:"width:100%;position:absolute;bottom:0"},null,8,["src"])])),_:1}),l(j,{text:"更多热帖内容",css:"color:#212121;font-weight:bold;font-size:36rpx;display:block;margin-top:30rpx"})])),_:1})])),_:1}),l(L,{css:"height:352rpx;width:100%;position:relative;display:flex;\r\n\t\t\t\t\t\t\tflex-direction:column;align-items:center;"},{default:r((()=>[l(O,{src:`${n.imgStaticPath}/tieba_codebg.png`,css:"width:100%;height:100%;position:absolute;bottom:0rpx;left:0rpx;z-index:-1"},null,8,["src"]),l(L,{css:"width:140rpx;height:140rpx;background-color:white;border-radius:12rpx;margin-top:106rpx;\r\n\t\t\t\t\t\t\t\tdisplay:flex;align-items:center;justify-content:center"},{default:r((()=>[l(A,{text:n.postCode,css:"width:124rpx;height:124rpx;"},null,8,["text"])])),_:1}),l(L,{css:"color:#999999;font-size:26rpx;margin-top:34rpx"},{default:r((()=>[l(j,{text:"长按识别二维码看详情",css:"opacity:0.5"})])),_:1})])),_:1})])),_:1})])])),_:1}),l(F,{class:"poster",onClick:e[47]||(e[47]=t=>{n.postShow=!1})},{default:r((()=>[n.postExhib?(o(),s(F,{key:0,style:{position:"fixed","z-index":"3"}},{default:r((()=>[l(F,{class:"exhibitionPoster",onLongpress:y.savePosterFn,onClick:e[45]||(e[45]=g((()=>{}),["stop"]))},{default:r((()=>[l(P,{src:n.posterImg,mode:"widthFix",class:"e-poster","show-menu-by-longpress":!0},null,8,["src"])])),_:1},8,["onLongpress"]),l(F,{class:"e-close"},{default:r((()=>[l(P,{src:`${n.imgStaticPath}/haibaoClose.png`,mode:"aspectFit",onClick:e[46]||(e[46]=g((t=>{n.postShow=!1}),["stop"]))},null,8,["src"]),l(x,null,{default:r((()=>[d("长按保存图片，分享给好友")])),_:1})])),_:1})])),_:1})):u("",!0)])),_:1})])),_:1})):u("",!0),l(E,{privateShow:n.privateb},null,8,["privateShow"])])),_:1},8,["style"]))])),_:1})}],["__scopeId","data-v-7c3eee12"]]);export{He as default};
